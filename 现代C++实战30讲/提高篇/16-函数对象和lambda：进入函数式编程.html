<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>16-å‡½æ•°å¯¹è±¡å’Œlambdaï¼šè¿›å…¥å‡½æ•°å¼ç¼–ç¨‹</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <style>
        html {
            color: #333;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
            font-family: Helvetica Neue, PingFang SC, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif
        }

        html.borderbox *,
        html.borderbox :after,
        html.borderbox :before {
            box-sizing: border-box
        }

        article,
        aside,
        blockquote,
        body,
        button,
        code,
        dd,
        details,
        dl,
        dt,
        fieldset,
        figcaption,
        figure,
        footer,
        form,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        header,
        hr,
        input,
        legend,
        li,
        menu,
        nav,
        ol,
        p,
        pre,
        section,
        td,
        textarea,
        th,
        ul {
            margin: 0;
            padding: 0
        }

        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block
        }

        audio,
        canvas,
        video {
            display: inline-block
        }

        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, Helvetica, sans-serif
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        fieldset,
        img {
            border: 0
        }

        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0
            }
        }

        abbr,
        acronym {
            border-bottom: 1px dotted;
            font-variant: normal
        }

        abbr {
            cursor: help
        }

        del {
            text-decoration: line-through
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400
        }

        ol,
        ul {
            list-style: none
        }

        caption,
        th {
            text-align: left
        }

        q:after,
        q:before {
            content: ""
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative
        }

        :root sub,
        :root sup {
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        a {
            color: #1abc9c
        }

        a:hover {
            text-decoration: underline
        }

        .typo a {
            border-bottom: 1px solid #1abc9c
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555
        }

        .typo a:hover,
        a,
        ins {
            text-decoration: none
        }

        .typo-u,
        u {
            text-decoration: underline
        }

        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px
        }

        code,
        pre,
        pre tt {
            font-family: Courier, Courier New, monospace
        }

        pre {
            background: hsla(0, 0%, 97%, .7);
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch
        }

        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: .8em;
            height: 10px
        }

        .typo-small,
        figcaption,
        small {
            font-size: .9em;
            color: #888
        }

        b,
        strong {
            font-weight: 700;
            color: #000
        }

        [draggable] {
            cursor: move
        }

        .clearfix:after,
        .clearfix:before {
            content: "";
            display: table
        }

        .clearfix:after {
            clear: both
        }

        .clearfix {
            zoom: 1
        }

        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all
        }

        .textwrap-table {
            table-layout: fixed
        }

        .serif {
            font-family: Palatino, Optima, Georgia, serif
        }

        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-ol,
        .typo-p,
        .typo-pre,
        .typo-table,
        .typo-ul,
        .typo dl,
        .typo form,
        .typo hr,
        .typo ol,
        .typo p,
        .typo pre,
        .typo table,
        .typo ul,
        blockquote {
            margin-bottom: 1rem
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Helvetica Neue, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            color: #000;
            line-height: 1.35
        }

        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6,
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6 {
            margin-top: 1.2em;
            margin-bottom: .6em;
            line-height: 1.35
        }

        .typo-h1,
        .typo h1 {
            font-size: 2em
        }

        .typo-h2,
        .typo h2 {
            font-size: 1.8em
        }

        .typo-h3,
        .typo h3 {
            font-size: 1.6em
        }

        .typo-h4,
        .typo h4 {
            font-size: 1.4em
        }

        .typo-h5,
        .typo-h6,
        .typo h5,
        .typo h6 {
            font-size: 1.2em
        }

        .typo-ul,
        .typo ul {
            margin-left: 1.3em;
            list-style: disc
        }

        .typo-ol,
        .typo ol {
            list-style: decimal;
            margin-left: 1.9em
        }

        .typo-ol ol,
        .typo-ol ul,
        .typo-ul ol,
        .typo-ul ul,
        .typo li ol,
        .typo li ul {
            margin-bottom: .8em;
            margin-left: 2em
        }

        .typo-ol ul,
        .typo-ul ul,
        .typo li ul {
            list-style: circle
        }

        .typo-table td,
        .typo-table th,
        .typo table caption,
        .typo table td,
        .typo table th {
            border: 1px solid #ddd;
            padding: .5em 1em;
            color: #666
        }

        .typo-table th,
        .typo table th {
            background: #fbfbfb
        }

        .typo-table thead th,
        .typo table thead th {
            background: hsla(0, 0%, 95%, .7)
        }

        .typo table caption {
            border-bottom: none
        }

        .typo-input,
        .typo-textarea {
            -webkit-appearance: none;
            border-radius: 0
        }

        .typo-em,
        .typo em,
        caption,
        legend {
            color: #000;
            font-weight: inherit
        }

        .typo-em {
            position: relative
        }

        .typo-em:after {
            position: absolute;
            top: .65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"
        }

        .typo img {
            max-width: 100%
        }

        .common-content {
            font-weight: 400;
            color: #353535;
            line-height: 1.75rem;
            white-space: normal;
            word-break: normal;
            font-size: 1rem
        }

        .common-content img {
            display: block;
            max-width: 100%;
            background-color: #eee
        }

        .common-content audio,
        .common-content video {
            width: 100%;
            background-color: #eee
        }

        .common-content center,
        .common-content font {
            margin-top: 1rem;
            display: inline-block
        }

        .common-content center {
            width: 100%
        }

        .common-content pre {
            margin-top: 1rem;
            padding-left: 0;
            padding-right: 0;
            position: relative;
            overflow: hidden
        }

        .common-content pre code {
            font-size: .8rem;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            width: 100%;
            box-sizing: border-box;
            padding-left: 1rem;
            padding-right: 1rem;
            overflow-x: auto
        }

        .common-content hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        .common-content b,
        .common-content h1,
        .common-content h2,
        .common-content h3,
        .common-content h4,
        .common-content h5,
        .common-content strong {
            font-weight: 700
        }

        .common-content h1,
        .common-content h2 {
            font-size: 1.125rem;
            margin-bottom: .45rem
        }

        .common-content h3,
        .common-content h4,
        .common-content h5 {
            font-size: 1rem;
            margin-bottom: .45rem
        }

        .common-content p {
            font-weight: 400;
            color: #353535;
            margin-top: .15rem
        }

        .common-content .orange {
            color: #ff5a05
        }

        .common-content .reference {
            font-size: 1rem;
            color: #888
        }

        .custom-rich-content h1 {
            margin-top: 0;
            font-weight: 400;
            font-size: 15.25px;
            border-bottom: 1px solid #eee;
            line-height: 2.8
        }

        .custom-rich-content li,
        .custom-rich-content p {
            font-size: 14px;
            color: #888;
            line-height: 1.6
        }

        table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        table.hljs-ln,
        table.hljs-ln tbody,
        table.hljs-ln td,
        table.hljs-ln tr {
            box-sizing: border-box
        }

        table.hljs-ln td {
            padding: 0;
            border: 0
        }

        table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            user-select: none
        }

        table.hljs-ln td.hljs-ln-code,
        table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            font-size: 12px;
            line-height: 20px;
            vertical-align: top
        }

        table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            color: #24292e;
            word-wrap: normal;
            white-space: pre
        }

        video::-webkit-media-controls {
            overflow: hidden !important
        }

        video::-webkit-media-controls-enclosure {
            width: calc(100% + 32px);
            margin-left: auto
        }

        ._29HP61GA_0 {
            max-width:800px;
            margin:0 auto;
            margin-bottom: 20px;
            font-weight: 400;
            color: #353535;
            line-height: 1.76;
            white-space: normal;
            word-break: normal;
            font-size: 17px;
            -webkit-transition: background-color .3s ease;
            transition: background-color .3s ease
        }

        ._29HP61GA_0 .MathJax_Display {
            overflow: auto
        }

        ._29HP61GA_0 .poster {
            position: fixed;
            left: -10000px;
            top: -10000px;
            overflow: hidden;
            padding: 1rem;
            background: #ececec
        }

        ._29HP61GA_0 .richcontent-pre-copy {
            font-size: 13px;
            color: #888;
            position: absolute;
            right: 1em;
            top: .5em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 .richcontent-pre-copy .iconfont {
            font-size: 12px;
            margin-right: .2em
        }

        ._29HP61GA_0 a {
            color: #fa8919;
            border-bottom: 1px solid #fa8919
        }

        ._29HP61GA_0 img {
            display: block;
            max-width: 100%;
            position: relative;
            left: 50%;
            -webkit-transform: translateX(-50%);
            transform: translateX(-50%);
            background-color: #eee;
            vertical-align: top;
            border-radius: 0
        }

        ._29HP61GA_0 audio,
        ._29HP61GA_0 video {
            width: 100%;
            background-color: #eee
        }

        ._29HP61GA_0 pre {
            margin-top: 16px;
            padding: 34px 0 0;
            margin-bottom: 30px;
            position: relative;
            border-radius: 6px;
            background: rgba(246, 247, 251, .749);
            border: 0
        }

        ._29HP61GA_0 pre code {
            font-size: 12px;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            margin-left: 16px;
            margin-right: 16px;
            overflow-x: scroll
        }

        ._29HP61GA_0 pre code:after {
            content: "";
            height: 30px;
            width: 100%;
            display: block
        }

        ._29HP61GA_0 hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        ._29HP61GA_0 h1,
        ._29HP61GA_0 h2,
        ._29HP61GA_0 h3,
        ._29HP61GA_0 h4,
        ._29HP61GA_0 h5 {
            margin-bottom: 20px;
            margin-top: 0;
            font-weight: 700
        }

        ._29HP61GA_0 b,
        ._29HP61GA_0 strong {
            font-weight: 700
        }

        ._29HP61GA_0 h1 {
            font-size: 21px
        }

        ._29HP61GA_0 h2 {
            font-size: 20px
        }

        ._29HP61GA_0 h3 {
            font-size: 19px
        }

        ._29HP61GA_0 h4 {
            font-size: 18px
        }

        ._29HP61GA_0 h5 {
            font-size: 17px
        }

        ._29HP61GA_0 center,
        ._29HP61GA_0 p {
            font-weight: 400;
            color: #353535;
            margin-top: 0;
            margin-bottom: 30px;
            word-break: break-word
        }

        ._29HP61GA_0 center {
            text-align: center
        }

        ._29HP61GA_0 blockquote {
            margin-top: 0;
            margin-bottom: 34px;
            border-left: 3px solid #e8e8e8;
            padding-left: 17px;
            color: #353535
        }

        ._29HP61GA_0 blockquote p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol,
        ._29HP61GA_0 ul {
            margin-bottom: 30px
        }

        ._29HP61GA_0 ol p,
        ._29HP61GA_0 ul p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol {
            list-style: decimal;
            margin-left: 20px
        }

        ._29HP61GA_0 ul li {
            padding-left: 17px;
            position: relative;
            margin-bottom: 10px
        }

        ._29HP61GA_0 ul li:after {
            content: "";
            height: 6px;
            width: 6px;
            border-radius: 50%;
            background: #353535;
            position: absolute;
            top: 10px;
            left: 0
        }

        ._29HP61GA_0 .orange {
            color: #fa8919
        }

        ._29HP61GA_0 .reference {
            color: #888
        }

        ._29HP61GA_0 .m-right {
            text-align: right
        }

        ._29HP61GA_0 .m-center {
            text-align: center;
            display: block
        }

        ._29HP61GA_0 .m-gray {
            color: #888
        }

        ._29HP61GA_0 .m-small {
            font-size: 15px
        }

        ._29HP61GA_0 table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        ._29HP61GA_0 table.hljs-ln,
        ._29HP61GA_0 table.hljs-ln tbody,
        ._29HP61GA_0 table.hljs-ln td,
        ._29HP61GA_0 table.hljs-ln tr {
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        ._29HP61GA_0 table.hljs-ln td {
            padding: 0;
            border: 0
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            font-size: 12px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code,
        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            line-height: 20px;
            vertical-align: top
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            font-size: 13px;
            color: #666;
            word-wrap: normal;
            white-space: pre
        }

    </style>
</head>
<body>
<div class="_29HP61GA_0">
<h1>16-å‡½æ•°å¯¹è±¡å’Œlambdaï¼šè¿›å…¥å‡½æ•°å¼ç¼–ç¨‹</h1>
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚</p><p>æœ¬è®²æˆ‘ä»¬å°†ä»‹ç»å‡½æ•°å¯¹è±¡ï¼Œå°¤å…¶æ˜¯åŒ¿åå‡½æ•°å¯¹è±¡â€”â€”lambda è¡¨è¾¾å¼ã€‚ä»Šå¤©çš„å†…å®¹è¯´éš¾ä¸éš¾ï¼Œä½†å¯èƒ½è·Ÿä½ çš„æ—¥å¸¸æ€ç»´æ–¹å¼æœ‰è¾ƒå¤§çš„åŒºåˆ«ï¼Œå»ºè®®ä½ ä¸€å®šè¦è¯•éªŒä¸€ä¸‹æ–‡ä¸­çš„ä»£ç ï¼ˆä½¿ç”¨ xeus-cling çš„åŒå­¦è¦æ³¨æ„ï¼šxeus-cling ä¼¼ä¹ä¸å¤ªå–œæ¬¢æœ‰ lambda çš„ä»£ç ğŸ˜“ï¼›é‡åˆ°æœ‰é—®é¢˜æ—¶ï¼Œè¿˜æ˜¯åªèƒ½å›åˆ°æ™®é€šçš„ç¼–è¯‘æ‰§è¡Œæ–¹å¼äº†ï¼‰ã€‚</p><h2>C++98 çš„å‡½æ•°å¯¹è±¡</h2><p>å‡½æ•°å¯¹è±¡ï¼ˆfunction objectï¼‰<span class="orange">[1]</span> è‡ª C++98 å¼€å§‹å°±å·²ç»è¢«æ ‡å‡†åŒ–äº†ã€‚ä»æ¦‚å¿µä¸Šæ¥è¯´ï¼Œå‡½æ•°å¯¹è±¡æ˜¯ä¸€ä¸ªå¯ä»¥è¢«å½“ä½œå‡½æ•°æ¥ç”¨çš„å¯¹è±¡ã€‚å®ƒæœ‰æ—¶ä¹Ÿä¼šè¢«å«åš functorï¼Œä½†è¿™ä¸ªæœ¯è¯­åœ¨èŒƒç•´è®ºé‡Œæœ‰ç€å®Œå…¨ä¸åŒçš„å«ä¹‰ï¼Œè¿˜æ˜¯ä¸ç”¨ä¸ºå¦™â€”â€”å¦åˆ™ç©å‡½æ•°å¼ç¼–ç¨‹çš„äººå¯èƒ½ä¼šæœç€ä½ å¤§çš±çœ‰å¤´çš„ã€‚</p><p>ä¸‹é¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„åŠ  <em>n</em> çš„å‡½æ•°å¯¹è±¡ç±»ï¼ˆæ ¹æ®ä¸€èˆ¬çš„æƒ¯ä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>struct</code> å…³é”®å­—è€Œä¸æ˜¯ <code>class</code> å…³é”®å­—ï¼‰ï¼š</p><pre><code class="language-c++">struct adder {
  adder(int n) : n_(n) {}
  int operator()(int x) const
  {
    return x + n_;
  }
private:
  int n_;
};
</code></pre><p>å®ƒçœ‹èµ·æ¥ç›¸å½“æ™®é€šï¼Œå”¯ä¸€æœ‰ç‚¹ç‰¹åˆ«çš„åœ°æ–¹å°±æ˜¯å®šä¹‰äº†ä¸€ä¸ª <code>operator()</code>ï¼Œè¿™ä¸ªè¿ç®—ç¬¦å…è®¸æˆ‘ä»¬åƒè°ƒç”¨å‡½æ•°ä¸€æ ·ä½¿ç”¨å°æ‹¬å·çš„è¯­æ³•ã€‚éšåï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå®é™…çš„å‡½æ•°å¯¹è±¡ï¼Œå¦‚ C++11 å½¢å¼çš„ï¼š</p><!-- [[[read_end]]] --><pre><code class="language-c++">auto add_2 = adder(2);
</code></pre><p>æˆ– C++98 å½¢å¼çš„ï¼š</p><pre><code class="language-c++">adder add_2(2);
</code></pre><p>å¾—åˆ°çš„ç»“æœ <code>add_2</code> å°±å¯ä»¥å½“ä½œä¸€ä¸ªå‡½æ•°æ¥ç”¨äº†ã€‚ä½ å¦‚æœå†™ä¸‹ <code>add_2(5)</code> çš„è¯ï¼Œå°±ä¼šå¾—åˆ°ç»“æœ 7ã€‚</p><p>C++98 é‡Œä¹Ÿå®šä¹‰äº†å°‘æ•°é«˜é˜¶å‡½æ•°ï¼šä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªå‡½æ•°å¯¹è±¡è¿‡å»ï¼Œç»“æœå¾—åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°å¯¹è±¡ã€‚æœ€å…¸å‹çš„ä¹Ÿè®¸æ˜¯ç›®å‰å·²ç»ä» C++17 æ ‡å‡†é‡Œç§»é™¤çš„ <code>bind1st</code> å’Œ <code>bind2nd</code> äº†ï¼ˆåœ¨ &lt;functional&gt; å¤´æ–‡ä»¶ä¸­æä¾›ï¼‰ï¼š</p><pre><code class="language-c++">auto add_2 = bind2nd(plus&lt;int&gt;(), 2);
</code></pre><p>è¿™æ ·äº§ç”Ÿçš„ <code>add_2</code> åŠŸèƒ½å’Œå‰é¢ç›¸åŒï¼Œæ˜¯æŠŠå‚æ•° <code>2</code> å½“ä½œç¬¬äºŒä¸ªå‚æ•°ç»‘å®šåˆ°å‡½æ•°å¯¹è±¡ <code>plus&lt;int&gt;</code>ï¼ˆå®ƒçš„ <code>operator()</code> éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼‰ä¸Šçš„ç»“æœã€‚å½“ç„¶ï¼Œ<code>auto</code> åœ¨ C++98 é‡Œæ˜¯æ²¡æœ‰çš„ï¼Œç»“æœè¦èµ‹ç»™ä¸€ä¸ªå˜é‡å°±æœ‰ç‚¹åˆ«æ‰­äº†ï¼Œå¾—å†™æˆï¼š</p><pre><code class="language-c++">binder2nd&lt;plus&lt;int&gt; &gt; add_2(
  plus&lt;int&gt;(), 2);
</code></pre><p>å› æ­¤ï¼Œåœ¨ C++98 é‡Œæˆ‘ä»¬é€šå¸¸ä¼šç›´æ¥ä½¿ç”¨ç»‘å®šçš„ç»“æœï¼š</p><pre><code class="language-c++">#include &lt;algorithm&gt;
#include &lt;functional&gt;
#include &lt;vector&gt;
using namespace std;

vector v{1, 2, 3, 4, 5};
transform(v.begin(), v.end(),
          v.begin(),
          bind2nd(plus&lt;int&gt;(), 2));
</code></pre><p>ä¸Šé¢çš„ä»£ç ä¼šå°†å®¹å™¨é‡Œçš„æ¯ä¸€é¡¹æ•°å€¼éƒ½åŠ ä¸Š 2ï¼ˆ<code>transform</code> å‡½æ•°æ¨¡æ¿åœ¨ &lt;algorithm&gt; å¤´æ–‡ä»¶ä¸­æä¾›ï¼‰ã€‚å¯ä»¥éªŒè¯ç»“æœï¼š</p><pre><code class="language-c++">v
</code></pre><blockquote>
<p><code>{ 3, 4, 5, 6, 7 }</code></p>
</blockquote><h3>å‡½æ•°çš„æŒ‡é’ˆå’Œå¼•ç”¨</h3><p>é™¤éä½ ç”¨ä¸€ä¸ªå¼•ç”¨æ¨¡æ¿å‚æ•°æ¥æ•æ‰å‡½æ•°ç±»å‹ï¼Œä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°çš„å‡½æ•°å®å‚ä¼šé€€åŒ–æˆä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ä¸ç®¡æ˜¯å‡½æ•°æŒ‡é’ˆè¿˜æ˜¯å‡½æ•°å¼•ç”¨ï¼Œä½ ä¹Ÿéƒ½å¯ä»¥å½“æˆå‡½æ•°å¯¹è±¡æ¥ç”¨ã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸‹é¢çš„å‡½æ•°å®šä¹‰ï¼š</p><pre><code class="language-c++">int add_2(int x)
{
  return x + 2;
};
</code></pre><p>å¦‚æœæˆ‘ä»¬æœ‰ä¸‹é¢çš„æ¨¡æ¿å£°æ˜ï¼š</p><pre><code class="language-c++">template &lt;typename T&gt;
auto test1(T fn)
{
    return fn(2);
}

template &lt;typename T&gt;
auto test2(T&amp; fn)
{
    return fn(2);
}

template &lt;typename T&gt;
auto test3(T* fn)
{
    return (*fn)(2);
}
</code></pre><p>å½“æˆ‘ä»¬æ‹¿ <code>add_2</code> å»è°ƒç”¨è¿™ä¸‰ä¸ªå‡½æ•°æ¨¡æ¿æ—¶ï¼Œ<code>fn</code> çš„ç±»å‹å°†åˆ†åˆ«è¢«æ¨å¯¼ä¸º <code>int (*)(int)</code>ã€<code>int (&amp;)(int)</code> å’Œ <code>int (*)(int)</code>ã€‚ä¸ç®¡æˆ‘ä»¬å¾—åˆ°çš„æ˜¯æŒ‡é’ˆè¿˜æ˜¯å¼•ç”¨ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç›´æ¥æ‹¿å®ƒå½“æ™®é€šçš„å‡½æ•°ç”¨ã€‚å½“ç„¶ï¼Œåœ¨å‡½æ•°æŒ‡é’ˆçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç›´æ¥å†™ <code>*value</code> ä¹Ÿå¯ä»¥ã€‚å› è€Œä¸Šé¢ä¸‰ä¸ªå‡½æ•°æ‹¿ <code>add_2</code> ä½œä¸ºå®å‚è°ƒç”¨çš„ç»“æœéƒ½æ˜¯ <code>4</code>ã€‚</p><p>å¾ˆå¤šæ¥æ”¶å‡½æ•°å¯¹è±¡çš„åœ°æ–¹ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å‡½æ•°çš„æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚ä½†åœ¨ä¸ªåˆ«æƒ…å†µä¸‹ï¼Œéœ€è¦é€šè¿‡å‡½æ•°å¯¹è±¡çš„ç±»å‹æ¥åŒºåˆ†å‡½æ•°å¯¹è±¡çš„æ—¶å€™ï¼Œå°±ä¸èƒ½ä½¿ç”¨å‡½æ•°æŒ‡é’ˆæˆ–å¼•ç”¨äº†â€”â€”åŸå‹ç›¸åŒçš„å‡½æ•°ï¼Œå®ƒä»¬çš„ç±»å‹ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p><h2>Lambda è¡¨è¾¾å¼</h2><p>Lambda è¡¨è¾¾å¼ <span class="orange">[2]</span> æ˜¯ä¸€ä¸ªæºè‡ªé˜¿éš†ä½Â·é‚±å¥‡ï¼ˆAlonzo Churchï¼‰â€”â€”è‰¾ä¼¦Â·å›¾çµï¼ˆAlan Turingï¼‰çš„è€å¸ˆâ€”â€”çš„æœ¯è¯­ã€‚é‚±å¥‡åˆ›ç«‹äº† Î» æ¼”ç®— <span class="orange">[3]</span>ï¼Œåæ¥è¢«è¯æ˜å’Œå›¾çµæœºæ˜¯ç­‰ä»·çš„ã€‚</p><p>æˆ‘ä»¬å…ˆä¸çœ‹æ•°å­¦ä¸Šçš„ Î» è¡¨è¾¾å¼ï¼Œçœ‹ä¸€ä¸‹ä¸Šä¸€èŠ‚ç»™å‡ºçš„ä»£ç åœ¨ä½¿ç”¨ lambda è¡¨è¾¾å¼æ—¶å¯ä»¥å¦‚ä½•ç®€åŒ–ã€‚</p><pre><code class="language-c++">auto add_2 = <a href="int x"></a> {
  return x + 2;
};
</code></pre><p>æ˜¾ç„¶ï¼Œå®šä¹‰ <code>add_2</code> ä¸å†éœ€è¦å®šä¹‰ä¸€ä¸ªé¢å¤–çš„ç±»å‹äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å†™å‡ºå®ƒçš„å®šä¹‰ã€‚ç†è§£å®ƒåªéœ€è¦æ³¨æ„ä¸‹é¢å‡ ç‚¹ï¼š</p><ul>
<li>Lambda è¡¨è¾¾å¼ä»¥ä¸€å¯¹ä¸­æ‹¬å·å¼€å§‹ï¼ˆä¸­æ‹¬å·ä¸­æ˜¯å¯ä»¥æœ‰å†…å®¹çš„ï¼›ç¨åæˆ‘ä»¬å†è¯´ï¼‰</li>
<li>è·Ÿå‡½æ•°å®šä¹‰ä¸€æ ·ï¼Œæˆ‘ä»¬æœ‰å‚æ•°åˆ—è¡¨</li>
<li>è·Ÿæ­£å¸¸çš„å‡½æ•°å®šä¹‰ä¸€æ ·ï¼Œæˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªå‡½æ•°ä½“ï¼Œé‡Œé¢ä¼šæœ‰ <code>return</code> è¯­å¥</li>
<li>Lambda è¡¨è¾¾å¼ä¸€èˆ¬ä¸éœ€è¦è¯´æ˜è¿”å›å€¼ï¼ˆç›¸å½“äº <code>auto</code>ï¼‰ï¼›æœ‰ç‰¹æ®Šæƒ…å†µéœ€è¦è¯´æ˜æ—¶ï¼Œåˆ™åº”ä½¿ç”¨ç®­å¤´è¯­æ³•çš„æ–¹å¼ï¼ˆå‚è§<a href="https://time.geekbang.org/column/article/176850">[ç¬¬ 8 è®²]</a>ï¼‰ï¼š<code>[]â€‹(int x) -&gt; int { â€¦ }</code></li>
<li>æ¯ä¸ª lambda è¡¨è¾¾å¼éƒ½æœ‰ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ç±»å‹ï¼Œè¦ç²¾ç¡®æ•æ‰ lambda è¡¨è¾¾å¼åˆ°ä¸€ä¸ªå˜é‡ä¸­ï¼Œåªèƒ½é€šè¿‡ <code>auto</code> å£°æ˜çš„æ–¹å¼</li>
</ul><p>å½“ç„¶ï¼Œæˆ‘ä»¬æƒ³è¦å®šä¹‰ä¸€ä¸ªé€šç”¨çš„ <code>adder</code> ä¹Ÿä¸éš¾ï¼š</p><pre><code class="language-c++">auto adder = <a href="int n"></a> {
  return [n]â€‹(int x) {
    return x + n;
  };
};
</code></pre><p>è¿™æ¬¡æˆ‘ä»¬ç›´æ¥è¿”å›äº†ä¸€ä¸ª lambda è¡¨è¾¾å¼ï¼Œå¹¶ä¸”ä¸­æ‹¬å·ä¸­å†™äº† <code>n</code> æ¥æ•è·å˜é‡ <code>n</code> çš„æ•°å€¼ã€‚è¿™ä¸ªå‡½æ•°çš„å®é™…æ•ˆæœå’Œå‰é¢çš„ <code>adder</code> å‡½æ•°å¯¹è±¡å®Œå…¨ä¸€è‡´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•è· <code>n</code> çš„æ•ˆæœç›¸å½“äºåœ¨ä¸€ä¸ªå‡½æ•°å¯¹è±¡ä¸­ç”¨æˆå‘˜å˜é‡å­˜å‚¨å…¶æ•°å€¼ã€‚</p><p>çº¯ç²¹ä¸ºäº†æ»¡è¶³ä½ å¯èƒ½æœ‰çš„å¥½å¥‡å¿ƒï¼Œä¸Šé¢çš„ <code>adder</code> ç›¸å½“äºè¿™æ ·ä¸€ä¸ª Î» è¡¨è¾¾å¼ï¼š</p><p>$$<br>
\mathrm{adder} = \lambda n.(\lambda x.(+ \ x \ n))<br>
$$</p><p>å¦‚æœä½ å»å­¦ Lisp æˆ– Scheme çš„è¯ï¼Œä½ å°±ä¼šå‘ç°è¿™äº›è¯­è¨€å’Œ Î» è¡¨è¾¾å¼å‡ ä¹æ˜¯ä¸€ä¸€æ˜ å°„äº†ã€‚åœ¨ C++ é‡Œï¼Œè¡¨è¾¾è™½ç„¶ç¨å¾®å•°å—¦ä¸€ç‚¹ï¼Œä½†ä¹Ÿæ¯”è¾ƒæ¥è¿‘äº†ã€‚ç”¨æˆ‘ä¸Šé¢çš„ <code>adder</code> ï¼Œå°±å¯ä»¥å¾—åˆ°ç±»ä¼¼äºå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€é‡Œçš„ currying <span class="orange">[4]</span> çš„æ•ˆæœâ€”â€”æŠŠä¸€ä¸ªæ“ä½œï¼ˆæ­¤å¤„æ˜¯åŠ æ³•ï¼‰åˆ†æˆå‡ æ­¥æ¥å®Œæˆã€‚æ²¡è§è¿‡å‡½æ•°å¼ç¼–ç¨‹çš„ï¼Œå¯èƒ½å¯¹ä¸‹é¢çš„è¡¨è¾¾å¼æ„Ÿåˆ°å¥‡æ€ªå§ï¼š</p><pre><code class="language-c++">auto seven = adder(2)(5);
</code></pre><p>ä¸è¿‡ï¼Œæœ€å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œå†™åŒ¿åå‡½æ•°å°±æ˜¯å¸Œæœ›ä¸éœ€è¦èµ·åå­—ã€‚ä»¥å‰é¢çš„æŠŠæ‰€æœ‰å®¹å™¨å…ƒç´ å€¼åŠ  2 çš„æ“ä½œä¸ºä¾‹ï¼Œä½¿ç”¨åŒ¿åå‡½æ•°å¯ä»¥å¾—åˆ°æ›´ç®€æ´å¯è¯»çš„ä»£ç ï¼š</p><pre><code class="language-c++">transform(v.begin(), v.end(),
          v.begin(),
          <a href="int x"></a> {
            return x + 2;
          });
</code></pre><p>åˆ°äº†å¯ä»¥ä½¿ç”¨ rangesï¼ˆå·²åœ¨ C++20 æ ‡å‡†åŒ–ï¼‰çš„æ—¶å€™ï¼Œä»£ç å¯ä»¥æ›´çŸ­ã€æ›´çµæ´»ã€‚è¿™ä¸ªæˆ‘ä»¬å°±ç•™åˆ°åé¢å†è¯´äº†ã€‚</p><p>ä¸€ä¸ª lambda è¡¨è¾¾å¼é™¤äº†æ²¡æœ‰åå­—ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹æ˜¯ä½ å¯ä»¥ç«‹å³è¿›è¡Œæ±‚å€¼ã€‚è¿™å°±ä½¿å¾—æˆ‘ä»¬å¯ä»¥æŠŠä¸€æ®µç‹¬ç«‹çš„ä»£ç å°è£…èµ·æ¥ï¼Œè¾¾åˆ°æ›´å¹²å‡€ã€è¡¨æ„çš„æ•ˆæœã€‚</p><p>å…ˆçœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><pre><code class="language-c++"><a href="int x"></a> { return x * x; }(3)
</code></pre><p>è¿™ä¸ªè¡¨è¾¾å¼çš„ç»“æœæ˜¯ 3 çš„å¹³æ–¹ 9ã€‚å³ä½¿è¿™ä¸ªçœ‹ä¼¼æ— èŠçš„ä¾‹å­ï¼Œéƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºå®ƒå…å»äº†æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª constexpr å‡½æ•°çš„å¿…è¦ã€‚åªè¦èƒ½æ»¡è¶³ constexpr å‡½æ•°çš„æ¡ä»¶ï¼Œä¸€ä¸ª lambda è¡¨è¾¾å¼é»˜è®¤å°±æ˜¯ constexpr å‡½æ•°ã€‚</p><p>å¦å¤–ä¸€ç§ç”¨é€”æ˜¯è§£å†³å¤šé‡åˆå§‹åŒ–è·¯å¾„çš„é—®é¢˜ã€‚å‡è®¾ä½ æœ‰è¿™æ ·çš„ä»£ç ï¼š</p><pre><code class="language-c++">Obj obj;
switch (init_mode) {
case init_mode1:
  obj = Obj(â€¦);
  break;
case init_mode2;
  obj = Obj(â€¦);
  break;
â€¦
}
</code></pre><p>è¿™æ ·çš„ä»£ç ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨äº†é»˜è®¤æ„é€ å‡½æ•°ã€å¸¦å‚æ•°çš„æ„é€ å‡½æ•°å’Œï¼ˆç§»åŠ¨ï¼‰èµ‹å€¼å‡½æ•°ï¼šæ—¢å¯èƒ½æœ‰æ€§èƒ½æŸå¤±ï¼Œä¹Ÿå¯¹ <code>Obj</code> æå‡ºäº†æœ‰é»˜è®¤æ„é€ å‡½æ•°çš„é¢å¤–è¦æ±‚ã€‚å¯¹äºè¿™æ ·çš„ä»£ç ï¼Œæœ‰ä¸€ç§é‡æ„æ„è§æ˜¯æŠŠè¿™æ ·çš„ä»£ç åˆ†ç¦»æˆç‹¬ç«‹çš„å‡½æ•°ã€‚ä¸è¿‡ï¼Œæœ‰æ—¶å€™æ›´ç›´æˆªäº†å½“çš„åšæ³•æ˜¯ç”¨ä¸€ä¸ª lambda è¡¨è¾¾å¼æ¥è¿›è¡Œæ”¹é€ ï¼Œæ—¢å¯ä»¥æå‡æ€§èƒ½ï¼ˆä¸éœ€è¦é»˜è®¤å‡½æ•°æˆ–æ‹·è´/ç§»åŠ¨ï¼‰ï¼Œåˆè®©åˆå§‹åŒ–éƒ¨åˆ†æ˜¾å¾—æ›´æ¸…æ™°ï¼š</p><pre><code class="language-c++">auto obj = [init_mode]â€‹() {
  switch (init_mode) {
  case init_mode1:
    return Obj(â€¦);
    break;
  case init_mode2:
    return Obj(â€¦);
    break;
  â€¦
  }
}();
</code></pre><h3>å˜é‡æ•è·</h3><p>ç°åœ¨æˆ‘ä»¬æ¥ç»†çœ‹ä¸€ä¸‹ lambda è¡¨è¾¾å¼ä¸­å˜é‡æ•è·çš„ç»†èŠ‚ã€‚</p><p>å˜é‡æ•è·çš„å¼€å¤´æ˜¯å¯é€‰çš„é»˜è®¤æ•è·ç¬¦ <code>=</code> æˆ– <code>&amp;</code>ï¼Œè¡¨ç¤ºä¼šè‡ªåŠ¨æŒ‰å€¼æˆ–æŒ‰å¼•ç”¨æ•è·ç”¨åˆ°çš„æœ¬åœ°å˜é‡ï¼Œç„¶ååé¢å¯ä»¥è·Ÿï¼ˆé€—å·åˆ†éš”ï¼‰ï¼š</p><ul>
<li>æœ¬åœ°å˜é‡åæ ‡æ˜å¯¹å…¶æŒ‰å€¼æ•è·ï¼ˆä¸èƒ½åœ¨é»˜è®¤æ•è·ç¬¦ <code>=</code> åå‡ºç°ï¼›å› å…¶å·²è‡ªåŠ¨æŒ‰å€¼æ•è·æ‰€æœ‰æœ¬åœ°å˜é‡ï¼‰</li>
<li><code>&amp;</code> åŠ æœ¬åœ°å˜é‡åæ ‡æ˜å¯¹å…¶æŒ‰å¼•ç”¨æ•è·ï¼ˆä¸èƒ½åœ¨é»˜è®¤æ•è·ç¬¦ <code>&amp;</code> åå‡ºç°ï¼›å› å…¶å·²è‡ªåŠ¨æŒ‰å¼•ç”¨æ•è·æ‰€æœ‰æœ¬åœ°å˜é‡ï¼‰</li>
<li><code>this</code> æ ‡æ˜æŒ‰å¼•ç”¨æ•è·å¤–å›´å¯¹è±¡ï¼ˆé’ˆå¯¹ lambda è¡¨è¾¾å¼å®šä¹‰å‡ºç°åœ¨ä¸€ä¸ªéé™æ€ç±»æˆå‘˜å†…çš„æƒ…å†µï¼‰ï¼›æ³¨æ„é»˜è®¤æ•è·ç¬¦ <code>=</code> å’Œ <code>&amp;</code> å·å¯ä»¥è‡ªåŠ¨æ•è· <code>this</code>ï¼ˆå¹¶ä¸”åœ¨ C++20 ä¹‹å‰ï¼Œåœ¨ <code>=</code> åå†™ <code>this</code> ä¼šå¯¼è‡´å‡ºé”™ï¼‰</li>
<li><code>*this</code> æ ‡æ˜æŒ‰å€¼æ•è·å¤–å›´å¯¹è±¡ï¼ˆé’ˆå¯¹ lambda è¡¨è¾¾å¼å®šä¹‰å‡ºç°åœ¨ä¸€ä¸ªéé™æ€ç±»æˆå‘˜å†…çš„æƒ…å†µï¼›C++17 æ–°å¢è¯­æ³•ï¼‰</li>
<li><code>å˜é‡å = è¡¨è¾¾å¼</code> æ ‡æ˜æŒ‰å€¼æ•è·è¡¨è¾¾å¼çš„ç»“æœï¼ˆå¯ç†è§£ä¸º <code>auto å˜é‡å = è¡¨è¾¾å¼</code>ï¼‰</li>
<li><code>&amp;å˜é‡å = è¡¨è¾¾å¼</code> æ ‡æ˜æŒ‰å¼•ç”¨æ•è·è¡¨è¾¾å¼çš„ç»“æœï¼ˆå¯ç†è§£ä¸º <code>auto&amp; å˜é‡å = è¡¨è¾¾å¼</code>ï¼‰</li>
</ul><p>ä»å·¥ç¨‹çš„è§’åº¦ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸æ¨èä½¿ç”¨é»˜è®¤æ•è·ç¬¦ã€‚æ›´ä¸€èˆ¬åŒ–çš„ä¸€æ¡å·¥ç¨‹åŸåˆ™æ˜¯ï¼š<strong>æ˜¾å¼çš„ä»£ç æ¯”éšå¼çš„ä»£ç æ›´å®¹æ˜“ç»´æŠ¤ã€‚</strong>å½“ç„¶ï¼Œåœ¨è¿™æ¡åŸåˆ™ä¸Šèµ°å¤šè¿œæ˜¯éœ€è¦æƒè¡¡çš„ï¼Œä½ ä¹Ÿä¸æ„¿æ„å†™å‡ºéå¸¸å•°å—¦çš„ä»£ç å§ï¼Ÿå¦åˆ™çš„è¯ï¼Œå¤§å®¶å°±å…¨éƒ¨å»å†™ C äº†ã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼ŒæŒ‰å€¼æ•è·æ˜¯æ¯”è¾ƒå®‰å…¨çš„åšæ³•ã€‚æŒ‰å¼•ç”¨æ•è·æ—¶åˆ™éœ€è¦æ›´å°å¿ƒäº›ï¼Œå¿…é¡»èƒ½å¤Ÿç¡®ä¿è¢«æ•è·çš„å˜é‡å’Œ lambda è¡¨è¾¾å¼çš„ç”Ÿå‘½æœŸè‡³å°‘ä¸€æ ·é•¿ï¼Œå¹¶åœ¨æœ‰ä¸‹é¢éœ€æ±‚ä¹‹ä¸€æ—¶æ‰ä½¿ç”¨ï¼š</p><ul>
<li>éœ€è¦åœ¨ lambda è¡¨è¾¾å¼ä¸­ä¿®æ”¹è¿™ä¸ªå˜é‡å¹¶è®©å¤–éƒ¨è§‚å¯Ÿåˆ°</li>
<li>éœ€è¦çœ‹åˆ°è¿™ä¸ªå˜é‡åœ¨å¤–éƒ¨è¢«ä¿®æ”¹çš„ç»“æœ</li>
<li>è¿™ä¸ªå˜é‡çš„å¤åˆ¶ä»£ä»·æ¯”è¾ƒé«˜</li>
</ul><p>å¦‚æœå¸Œæœ›ä»¥ç§»åŠ¨çš„æ–¹å¼æ¥æ•è·æŸä¸ªå˜é‡çš„è¯ï¼Œåˆ™åº”è€ƒè™‘ <code>å˜é‡å = è¡¨è¾¾å¼</code> çš„å½¢å¼ã€‚è¡¨è¾¾å¼å¯ä»¥è¿”å›ä¸€ä¸ª prvalue æˆ– xvalueï¼Œæ¯”å¦‚å¯ä»¥æ˜¯ <code>std::move(éœ€ç§»åŠ¨æ•è·çš„å˜é‡)</code>ã€‚</p><p>ä¸Šä¸€èŠ‚æˆ‘ä»¬å·²ç»è§è¿‡ç®€å•çš„æŒ‰å€¼æ•è·ã€‚ä¸‹é¢æ˜¯ä¸€äº›æ›´å¤šçš„æ¼”ç¤ºå˜é‡æ•è·çš„ä¾‹å­ã€‚</p><p>æŒ‰å¼•ç”¨æ•è·ï¼š</p><pre><code class="language-c++">vector&lt;int&gt; v1;
vector&lt;int&gt; v2;
â€¦
auto push_data = <a href="int n">&amp;</a> {
  // æˆ–ä½¿ç”¨ [&amp;v1, &amp;v2] æ•æ‰
  v1.push_back(n);
  v2.push_back(n)
};

push_data(2);
push_data(3);
</code></pre><p>è¿™ä¸ªä¾‹å­å¾ˆç®€å•ã€‚æˆ‘ä»¬æŒ‰å¼•ç”¨æ•è· <code>v1</code> å’Œ <code>v2</code>ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä¿®æ”¹å®ƒä»¬çš„å†…å®¹ã€‚</p><p>æŒ‰å€¼æ•è·å¤–å›´å¯¹è±¡ï¼š</p><pre><code class="language-c++">#include &lt;chrono&gt;
#include &lt;iostream&gt;
#include &lt;sstream&gt;
#include &lt;thread&gt;

using namespace std;

int get_count()
{
  static int count = 0;
  return ++count;
}

class task {
public:
  task(int data) : data_(data) {}
  auto lazy_launch()
  {
    return
      [*this, count = get_count()]â€‹()
      mutable {
        ostringstream oss;
        oss &lt;&lt; "Done work " &lt;&lt; data_
            &lt;&lt; " (No. " &lt;&lt; count
            &lt;&lt; ") in thread "
            &lt;&lt; this_thread::get_id()
            &lt;&lt; '\n';
        msg_ = oss.str();
        calculate();
      };
  }
  void calculate()
  {
    this_thread::sleep_for(100ms);
    cout &lt;&lt; msg_;
  }

private:
  int data_;
  string msg_;
};

int main()
{
  auto t = task{37};
  thread t1{t.lazy_launch()};
  thread t2{t.lazy_launch()};
  t1.join();
  t2.join();
}
</code></pre><p>è¿™ä¸ªä¾‹å­ç¨å¤æ‚ï¼Œæ¼”ç¤ºäº†å¥½å‡ ä¸ª lambda è¡¨è¾¾å¼çš„ç‰¹æ€§ï¼š</p><ul>
<li><code>mutable</code> æ ‡è®°ä½¿æ•è·çš„å†…å®¹å¯æ›´æ”¹ï¼ˆç¼ºçœä¸å¯æ›´æ”¹æ•è·çš„å€¼ï¼Œç›¸å½“äºå®šä¹‰äº† <code>operator()(â€¦) const</code>ï¼‰ï¼›</li>
<li><code>[*this]</code> æŒ‰å€¼æ•è·å¤–å›´å¯¹è±¡ï¼ˆ<code>task</code>ï¼‰ï¼›</li>
<li><code>[count = get_count()]</code> æ•è·è¡¨è¾¾å¼å¯ä»¥åœ¨ç”Ÿæˆ lambda è¡¨è¾¾å¼æ—¶è®¡ç®—å¹¶å­˜å‚¨ç­‰å·åè¡¨è¾¾å¼çš„ç»“æœã€‚</li>
</ul><p>è¿™æ ·ï¼Œå¤šä¸ªçº¿ç¨‹å¤åˆ¶äº†ä»»åŠ¡å¯¹è±¡ï¼Œå¯ä»¥ç‹¬ç«‹åœ°è¿›è¡Œè®¡ç®—ã€‚è¯·è‡ªè¡Œè¿è¡Œä¸€ä¸‹ä»£ç ï¼Œå¹¶æŠŠ <code>*this</code> æ”¹æˆ <code>this</code>ï¼Œçœ‹çœ‹è¾“å‡ºä¼šæœ‰ä»€ä¹ˆä¸åŒã€‚</p><h2>æ³›å‹ lambda è¡¨è¾¾å¼</h2><p>å‡½æ•°çš„è¿”å›å€¼å¯ä»¥ autoï¼Œä½†å‚æ•°è¿˜æ˜¯è¦ä¸€ä¸€å£°æ˜çš„ã€‚åœ¨ lambda è¡¨è¾¾å¼é‡Œåˆ™æ›´è¿›ä¸€æ­¥ï¼Œåœ¨å‚æ•°å£°æ˜æ—¶å°±å¯ä»¥ä½¿ç”¨ <code>auto</code>ï¼ˆåŒ…æ‹¬ <code>auto&amp;&amp;</code> ç­‰å½¢å¼ï¼‰ã€‚ä¸è¿‡ï¼Œå®ƒçš„åŠŸèƒ½ä¹Ÿä¸é‚£ä¹ˆç¥ç§˜ï¼Œå°±æ˜¯ç»™ä½ è‡ªåŠ¨å£°æ˜äº†æ¨¡æ¿è€Œå·²ã€‚æ¯•ç«Ÿï¼Œåœ¨ lambda è¡¨è¾¾å¼çš„å®šä¹‰è¿‡ç¨‹ä¸­æ˜¯æ²¡æ³•å†™ <code>template</code> å…³é”®å­—çš„ã€‚</p><p>è¿˜æ˜¯æ‹¿ä¾‹å­è¯´è¯ï¼š</p><pre><code class="language-c++">template &lt;typename T1,
          typename T2&gt;
auto sum(T1 x, T2 y)
{
  return x + y;
}
</code></pre><p>è·Ÿä¸Šé¢çš„å‡½æ•°ç­‰ä»·çš„ lambda è¡¨è¾¾å¼æ˜¯ï¼š</p><pre><code class="language-c++">auto sum = <a href="auto x, auto y"></a>
{
  return x + y;
}
</code></pre><p>æ˜¯ä¸æ˜¯åè€Œæ›´ç®€å•äº†ï¼ŸğŸ˜‚</p><p>ä½ å¯èƒ½è¦é—®ï¼Œè¿™ä¹ˆå†™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿé—®å¾—å¥½ã€‚ç®€å•æ¥è¯´ï¼Œç­”æ¡ˆæ˜¯å¯ç»„åˆæ€§ã€‚ä¸Šé¢è¿™ä¸ª <code>sum</code>ï¼Œå°±è·Ÿæ ‡å‡†åº“é‡Œçš„ <code>plus</code> æ¨¡æ¿ä¸€æ ·ï¼Œæ˜¯å¯ä»¥ä¼ é€’ç»™å…¶ä»–æ¥å—å‡½æ•°å¯¹è±¡çš„å‡½æ•°çš„ï¼Œè€Œ <code>+</code> æœ¬èº«åˆ™ä¸è¡Œã€‚ä¸‹é¢çš„ä¾‹å­è™½ç„¶ç•¥æœ‰ç‚¹æ— èŠï¼Œä¹Ÿå¯ä»¥æ¼”ç¤ºä¸€ä¸‹ï¼š</p><pre><code class="language-c++">#include &lt;array&gt;    // std::array
#include &lt;iostream&gt; // std::cout/endl
#include &lt;numeric&gt;  // std::accumulate

using namespace std;

int main()
{
  array a{1, 2, 3, 4, 5};
  auto s = accumulate(
    a.begin(), a.end(), 0,
    <a href="auto x, auto y"></a> {
      return x + y;
    });
  cout &lt;&lt; s &lt;&lt; endl;
}
</code></pre><p>è™½ç„¶å‡½æ•°åå­—å« <code>accumulate</code>â€”â€”ç´¯åŠ â€”â€”ä½†å®ƒçš„è¡Œä¸ºæ˜¯é€šè¿‡ç¬¬å››ä¸ªå‚æ•°å¯ä¿®æ”¹çš„ã€‚æˆ‘ä»¬æŠŠä¸Šé¢çš„åŠ å· <code>+</code> æ”¹æˆæ˜Ÿå· <code>*</code>ï¼Œä¸Šé¢çš„è®¡ç®—å°±ä»ä» 1 åŠ åˆ° 5 å˜æˆäº†ç®— 5 çš„é˜¶ä¹˜äº†ã€‚</p><h2>bind æ¨¡æ¿</h2><p>æˆ‘ä»¬ä¸Šé¢æåˆ°äº† <code>bind1st</code> å’Œ <code>bind2nd</code> ç›®å‰å·²ç»ä» C++ æ ‡å‡†é‡Œç§»é™¤ã€‚åŸå› å®é™…ä¸Šæœ‰ä¸¤ä¸ªï¼š</p><ul>
<li>å®ƒçš„åŠŸèƒ½å¯ä»¥è¢« lambda è¡¨è¾¾å¼æ›¿ä»£</li>
<li>æœ‰äº†ä¸€ä¸ªæ›´å¼ºå¤§çš„ <code>bind</code> æ¨¡æ¿ <span class="orange">[5]</span></li>
</ul><p>æ‹¿æˆ‘ä»¬ä¹‹å‰ç»™å‡ºçš„ä¾‹å­ï¼š</p><pre><code class="language-c++">transform(v.begin(), v.end(),
          v.begin(),
          bind2nd(plus&lt;int&gt;(), 2));
</code></pre><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å†™æˆï¼š</p><pre><code class="language-c++">using namespace std::
  placeholders;  // for _1, _2...
transform(v.begin(), v.end(),
          v.begin(),
          bind(plus&lt;&gt;(), _1, 2));
</code></pre><p>åŸå…ˆæˆ‘ä»¬åªèƒ½æŠŠä¸€ä¸ªç»™å®šçš„å‚æ•°ç»‘å®šåˆ°ç¬¬ä¸€ä¸ªå‚æ•°æˆ–ç¬¬äºŒä¸ªå‚æ•°ä¸Šï¼Œç°åœ¨åˆ™å¯ä»¥éå¸¸è‡ªç”±åœ°é€‚é…å„ç§æ›´å¤æ‚çš„æƒ…å†µï¼å½“ç„¶ï¼Œ<code>bind</code> çš„å‚æ•°æ•°é‡ï¼Œå¿…é¡»æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆå‡½æ•°å¯¹è±¡ï¼‰æ‰€éœ€çš„å‚æ•°æ•°é‡åŠ ä¸€ã€‚è€Œ <code>bind</code> çš„ç»“æœçš„å‚æ•°æ•°é‡åˆ™æ²¡æœ‰é™åˆ¶â€”â€”ä½ å¯ä»¥æ— èŠåœ°å†™å‡º <code>bind(plus&lt;&gt;(), _1, _3)(1, 2, 3)</code>ï¼Œè€Œç»“æœæ˜¯ 4ï¼ˆå®Œå…¨å¿½ç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼‰ã€‚</p><p>ä½ å¯èƒ½ä¼šé—®ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸æ˜¯å¯ä»¥è¢« lambda è¡¨è¾¾å¼æ›¿ä»£å‘¢ã€‚å›ç­”æ˜¯â€œæ˜¯â€ã€‚å¯¹ <code>bind</code> åªéœ€è¦ç¨å¾®äº†è§£ä¸€ä¸‹å°±å¥½â€”â€”åœ¨ C++14 ä¹‹åçš„å¹´ä»£é‡Œï¼Œå·²ç»æ²¡æœ‰ä»€ä¹ˆåœ°æ–¹å¿…é¡»è¦ä½¿ç”¨ <code>bind</code> äº†ã€‚</p><h2>function æ¨¡æ¿</h2><p>æ¯ä¸€ä¸ª lambda è¡¨è¾¾å¼éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„ç±»å‹ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨ <code>auto</code> æˆ–æ¨¡æ¿å‚æ•°æ¥æ¥æ”¶ç»“æœã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„é€šç”¨ç±»å‹æ¥æ¥æ”¶ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <code>function</code> æ¨¡æ¿ <span class="orange">[6]</span>ã€‚<code>function</code> æ¨¡æ¿çš„å‚æ•°å°±æ˜¯å‡½æ•°çš„ç±»å‹ï¼Œä¸€ä¸ªå‡½æ•°å¯¹è±¡æ”¾åˆ° <code>function</code> é‡Œä¹‹åï¼Œå¤–ç•Œå¯ä»¥è§‚å¯Ÿåˆ°çš„å°±åªå‰©ä¸‹å®ƒçš„å‚æ•°ã€è¿”å›å€¼ç±»å‹å’Œæ‰§è¡Œæ•ˆæœäº†ã€‚æ³¨æ„ <code>function</code> å¯¹è±¡çš„åˆ›å»ºè¿˜æ˜¯æ¯”è¾ƒè€—èµ„æºçš„ï¼Œæ‰€ä»¥è¯·ä½ åªåœ¨ç”¨ <code>auto</code> ç­‰æ–¹æ³•è§£å†³ä¸äº†é—®é¢˜çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªæ¨¡æ¿ã€‚</p><p>ä¸‹é¢æ˜¯ä¸ªç®€å•çš„ä¾‹å­ã€‚</p><pre><code class="language-c++">map&lt;string, function&lt;int(int, int)&gt;&gt;
  op_dict{
    {"+",
     <a href="int x, int y"></a> {
       return x + y;
     }},
    {"-",
     <a href="int x, int y"></a> {
       return x - y;
     }},
    {"*",
     <a href="int x, int y"></a> {
       return x * y;
     }},
    {"/",
     <a href="int x, int y"></a> {
       return x / y;
     }},
  };
</code></pre><p>è¿™å„¿ï¼Œç”±äºè¦æŠŠå‡½æ•°å¯¹è±¡å­˜åˆ°ä¸€ä¸ª <code>map</code> é‡Œï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ <code>function</code> æ¨¡æ¿ã€‚éšåï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ç±»ä¼¼äº <code>op_dict.at("+")(1, 6)</code> è¿™æ ·çš„æ–¹å¼æ¥ä½¿ç”¨ <code>function</code> å¯¹è±¡ã€‚è¿™ç§æ–¹å¼å¯¹è¡¨è¾¾å¼çš„è§£æå¤„ç†å¯èƒ½ä¼šæ¯”è¾ƒæœ‰ç”¨ã€‚</p><h2>å†…å®¹å°ç»“</h2><p>åœ¨è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†å‡½æ•°å¯¹è±¡å’Œ lambda è¡¨è¾¾å¼çš„åŸºæœ¬æ¦‚å¿µï¼Œå¹¶ç®€å•ä»‹ç»äº† <code>bind</code> æ¨¡æ¿å’Œ <code>function</code> æ¨¡æ¿ã€‚å®ƒä»¬åœ¨æ³›å‹ç¼–ç¨‹å’Œå‡½æ•°å¼ç¼–ç¨‹ä¸­éƒ½æ˜¯é‡è¦çš„åŸºç¡€ç»„æˆéƒ¨åˆ†ï¼Œä½ åº”è¯¥ç†Ÿç»ƒæŒæ¡ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>è¯·ï¼š</p><ol>
<li>å°è¯•ä¸€ä¸‹ï¼ŒæŠŠæ–‡ç« çš„ lambda è¡¨è¾¾å¼æ”¹é€ æˆå®Œå…¨ä¸ä½¿ç”¨ lambdaã€‚</li>
<li>ä½“ä¼šä¸€ä¸‹ï¼Œlambda è¡¨è¾¾å¼å¸¦æ¥äº†å“ªäº›è¡¨è¾¾ä¸Šçš„å¥½å¤„ã€‚</li>
</ol><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ã€‚</p><h2><span class="reference">å‚è€ƒèµ„æ–™</span></h2><p><span class="reference">[1] Wikipedia, â€œFunction objectâ€. <a href="https://en.wikipedia.org/wiki/Function_object">https://en.wikipedia.org/wiki/Function_object</a> </span></p><p><span class="reference">[1a] ç»´åŸºç™¾ç§‘, â€œå‡½æ•°å¯¹è±¡â€. <a href="https://zh.wikipedia.org/zh-cn/%E5%87%BD%E6%95%B0%E5%AF%B9%E8%B1%A1">https://zh.wikipedia.org/zh-cn/å‡½æ•°å¯¹è±¡</a> </span></p><p><span class="reference">[2] Wikipedia, â€œAnonymous functionâ€.<a href="https://en.wikipedia.org/wiki/Anonymous_function">https://en.wikipedia.org/wiki/Anonymous_function</a> </span></p><p><span class="reference">[2a] ç»´åŸºç™¾ç§‘, â€œåŒ¿åå‡½æ•°â€. <a href="https://zh.wikipedia.org/zh-cn/%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0">https://zh.wikipedia.org/zh-cn/åŒ¿åå‡½æ•°</a> </span></p><p><span class="reference">[3] Wikipedia, â€œLambda calculusâ€. <a href="https://en.wikipedia.org/wiki/Lambda_calculus">https://en.wikipedia.org/wiki/Lambda_calculus</a> </span></p><p><span class="reference">[3a] ç»´åŸºç™¾ç§‘, â€œÎ»æ¼”ç®—â€. <a href="https://zh.wikipedia.org/zh-cn/%CE%9B%E6%BC%94%E7%AE%97">https://zh.wikipedia.org/zh-cn/Î›æ¼”ç®—</a> </span></p><p><span class="reference">[4] Wikipedia, â€œCurryingâ€. <a href="https://en.wikipedia.org/wiki/Currying">https://en.wikipedia.org/wiki/Currying</a> </span></p><p><span class="reference">[4a] ç»´åŸºç™¾ç§‘, â€œæŸ¯é‡ŒåŒ–â€. <a href="https://zh.wikipedia.org/zh-cn/%E6%9F%AF%E9%87%8C%E5%8C%96">https://zh.wikipedia.org/zh-cn/æŸ¯é‡ŒåŒ–</a> </span></p><p><span class="reference">[5] cppreference.com, â€œstd::bindâ€. <a href="https://en.cppreference.com/w/cpp/utility/functional/bind">https://en.cppreference.com/w/cpp/utility/functional/bind</a> </span></p><p><span class="reference">[5a] cppreference.com, â€œstd::bindâ€. <a href="https://zh.cppreference.com/w/cpp/utility/functional/bind">https://zh.cppreference.com/w/cpp/utility/functional/bind</a> </span></p><p><span class="reference">[6] cppreference.com, â€œstd::functionâ€. <a href="https://en.cppreference.com/w/cpp/utility/functional/function">https://en.cppreference.com/w/cpp/utility/functional/function</a> </span></p><p><span class="reference">[6a] cppreference.com, â€œstd::functionâ€. <a href="https://zh.cppreference.com/w/cpp/utility/functional/function">https://zh.cppreference.com/w/cpp/utility/functional/function</a> </span></p><h2>ç²¾é€‰ç•™è¨€ï¼š</h2>
        <ul>
        
<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            æ€»ç»Ÿè€å”  2020-01-01 09:29:53
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            2020ç¬¬ä¸€è¯¾ï¼Œå´è€å¸ˆæ–°å¹´å¥½ [2èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2020-01-01 10:25:30</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">è°¢è°¢ğŸ™ã€‚åœ¨è¿™å„¿ä¹Ÿé¡ºç¥æ‰€æœ‰çš„åŒå­¦ä»¬æ–°å¹´å¥½ï¼ğŸ˜‡ğŸˆğŸŠ</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            æäº®äº®  2020-01-02 20:56:25
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            Microsoft Visual Studio Community 2019  ç‰ˆæœ¬ 16.4.2ï¼Œè¯­è¨€æ ‡å‡†ï¼šC++17 ä¾‹å­ç¼–è¯‘ä¸è¿‡ï¼Œæ°´å¹³åˆèœï¼Œä¸ä¼šæ”¹ã€‚ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2020-01-02 22:12:31</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">æ˜¯è¯´æœ‰çº¿ç¨‹çš„é‚£ä¸ªä¾‹å­å—ï¼Ÿæˆ‘åˆšåˆè¯•äº†ï¼Œæ²¡é—®é¢˜çš„ã€‚<br><br>ä½ æ˜¯ä¸æ˜¯æ²¡æœ‰è®¾å®šè¯­è¨€æ ‡å‡†ä¸º c++17ï¼Ÿä½†ä½ è¯„è®ºé‡Œåˆè¯´è®¾äº†â€¦â€¦ä¸è®¾æ˜¯ç¡®å®ä¸è¡Œçš„ã€‚<br><br>æˆ‘ç¼–è¯‘çš„å‘½ä»¤è¡Œæ˜¯ï¼š<br><br>cl &#47;EHsc &#47;std:c++17 test16.cpp<br><br>å¦‚æœä½ é‡åˆ°é”™è¯¯äº†ï¼Œåˆä¸è´´å‡ºé”™è¯¯ä¿¡æ¯ï¼Œåˆ«äººä¹Ÿæ²¡æ³•å¸®ä½ å•Šâ€¦â€¦</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            å»–ç†ŠçŒ«  2020-01-02 14:23:05
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è€å¸ˆæ–°å¹´å¿«ä¹ã€‚<br>lambdaè¡¨è¾¾å¼å¤§æ¦‚æ˜¯ç”Ÿæˆäº†ä¸€ä¸ªåŒ¿åçš„structå§ï¼Œå®ç°äº†operator(), æ•è·çš„è¯å¯¹åº”structä¸Šçš„å­—æ®µã€‚ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2020-01-02 19:01:04</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">æ–°å¹´å¿«ä¹ã€‚<br><br>å¯¹ï¼Œæ¦‚å¿µä¸Šå°±æ˜¯è¿™æ ·ã€‚</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            tt  2020-01-02 08:57:35
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            1ã€æ„Ÿè§‰lambdaè¡¨è¾¾å¼å°±æ˜¯C++ä¸­çš„é—­åŒ…ã€‚<br><br>2ã€lambdaè¡¨è¾¾å¼å¯ä»¥ç«‹å³è¿›è¡Œæ±‚èŒï¼Œè¿™ä¸€ç‚¹å’ŒJavaScripté‡Œçš„ç«‹å³æ‰§è¡Œå‡½æ•°ï¼ˆImdiately Invoked Function Expressionï¼ŒIIFEï¼‰ä¸€æ ·ã€‚åœ¨JavaScripté‡Œï¼Œå®ƒæ˜¯ç”¨æ¥è§£å†³ä½œç”¨åŸŸç¼ºé™·çš„ã€‚<br><br>æ„Ÿè§‰åœ¨åŠ¨æ€è¯­è¨€é‡Œè¢«ç”¨åˆ°æè‡´çš„é—­åŒ…ç­‰ç‰¹æ€§ï¼Œå› ä¸ºC++çš„å¼ºå¤§ã€å®Œå¤‡ï¼Œåœ¨C++é‡Œå¾ˆæ™®é€šã€‚<br><br>lambdaçš„å®šä¹‰å¯¹åº”ä¸€ä¸ªåŒ¿åå‡½æ•°å¯¹è±¡ï¼Œæ•è·å°±æ˜¯æ„é€ è¿™ä¸ªå¯¹è±¡æ—¶æŸç§æ–¹å¼çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œç”¨lambdaè¡¨è¾¾å¼éšè—äº†è¿™ä¸ªè¿‡ç¨‹ï¼Œåªä¿ç•™äº†è¿™ä¸ªæ„æ€ï¼Œæ›´ç›´è§‚å’Œå†™æ„ã€‚<br><br>è€å¸ˆï¼Œæˆ‘å¯¹åç¨‹å¾ˆæ„Ÿå…´è¶£ï¼ŒC++ä¼šæœ‰åç¨‹ä¹ˆï¼Ÿéšçº¦æ„Ÿè§‰æ•è·å˜é‡è¿™ä¸ªä¸œè¥¿æ˜¯ä¸æ˜¯å¯ä»¥ç”¨åœ¨å®ç°åç¨‹ä¸Šï¼Ÿ<br><br>æœ€åï¼Œç¥è€å¸ˆæ–°å¹´å¿«ä¹ï¼ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2020-01-02 19:00:36</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">å¯¹ï¼Œå°±æ˜¯é—­åŒ…ã€‚<br><br>Stackful åç¨‹è§ Boost.Coroutine2ã€‚Stackless åç¨‹å·²ç»è¿›å…¥ C++20ï¼Œç¬¬ 30 è®²è®¨è®ºã€‚ğŸ¤“<br><br>æ–°å¹´å¿«ä¹ï¼</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ç¦¾æ¡ƒ  2020-01-01 23:25:47
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            &quot;è¯·è‡ªè¡Œè¿è¡Œä¸€ä¸‹ä»£ç ï¼Œå¹¶æŠŠ *this æ”¹æˆ thisï¼Œçœ‹çœ‹è¾“å‡ºä¼šæœ‰ä»€ä¹ˆä¸åŒã€‚&quot;<br><br>int get_count()<br>{<br>    static int count = 0;<br>    return ++count;<br>}<br><br>class task {<br>public:<br>    task(int data) : data_(data) { cout &lt;&lt; __func__ &lt;&lt; &quot;|&quot; &lt;&lt; this &lt;&lt; endl; }<br>    auto lazy_launch()<br>    {<br>        return<br>            &#47;&#47; *this æ ‡æ˜æŒ‰å€¼æ•è·å¤–å›´å¯¹è±¡<br>            &#47;&#47; å˜é‡å = è¡¨è¾¾å¼ æ ‡æ˜æŒ‰å€¼æ•è·è¡¨è¾¾å¼çš„ç»“æœ<br>                [this, count = get_count()]()<br>                        mutable { &#47;&#47; mutable æ ‡è®°ä½¿æ•è·çš„å†…å®¹å¯æ›´æ”¹<br>                    cout &lt;&lt; __func__ &lt;&lt; &quot;|&quot; &lt;&lt; this &lt;&lt; endl;<br>                    ostringstream oss;<br>                    oss &lt;&lt; &quot;Done work &quot; &lt;&lt; data_<br>                        &lt;&lt; &quot; (No. &quot; &lt;&lt; count<br>                        &lt;&lt; &quot;) in thread &quot;<br>                        &lt;&lt; this_thread::get_id()<br>                        &lt;&lt; &#39;\n&#39;;<br>                    msg_ = oss.str();<br>                    calculate();<br>                };<br>    }<br>    void calculate()<br>    {<br>        this_thread::sleep_for(100ms);<br>        cout &lt;&lt; msg_;<br>    }<br><br>private:<br>    int data_;<br>    string msg_;<br>};<br><br>int main()<br>{<br>    auto t = task{37};<br>    thread t1{t.lazy_launch()};<br>    thread t2{t.lazy_launch()};<br>    t1.join();<br>    t2.join();<br>}<br><br> æ‰“å°è¾“å‡º<br>task|0x7ffe6f0e7120<br>operator()|0x7ffe6f0e7120<br>operator()|0x7ffe6f0e7120<br>Done work 37 (No. 2) in thread 140331800897280 <br>Done work 37 (No. 2) in thread 140331800897280<br><br>ä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆï¼Œ<br>#1 t1, t2è¿™ä¸¤ä¸ªthreadæœ‰åŒæ ·çš„thread id(140331800897280)ï¼Ÿ<br>#2 ä¸ºä»€ä¹ˆ countåœ¨ï¼Œ t1, t2è¿è¡Œæ—¶ï¼Œæ‰“å°å‡ºçš„éƒ½æ˜¯2(No. 2)ï¼Ÿ<br><br>å¤šè°¢ï¼ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2020-01-02 09:48:26</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">å°±æ˜¯è®©ä½ æƒ³ä¸€æƒ³çš„å‘€ã€‚æç¤ºï¼šæŒ‰å¼•ç”¨æ•è·çš„åæœã€‚</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ç½—ä¹¾æ—  2020-01-01 17:35:48
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            ç¼–è¯‘å™¨é‡åˆ°lambda è¡¨è¾¾å¼æ—¶ï¼Œäº§ç”Ÿä¸€ä¸ªåŒ¿åçš„å‡½æ•°å¯¹è±¡ï¼Œå„ç§æ•è·ç›¸å½“äºæŒ‰å€¼æˆ–è€…æŒ‰å¼•ç”¨è®¾ç½®ç»™åŒ¿åå¯¹è±¡çš„æˆå‘˜å­—æ®µã€‚<br>ä¸å¯¹çš„åœ°æ–¹ï¼Œæœ›è€å¸ˆæŒ‡æ­£ã€‚<br>å¯¹function&lt;int(int, int)&gt;è¿™è´§æ€ä¹ˆå®ç°çš„æ¯”è¾ƒå¥½å¥‡ï¼Œå¤§å¤šæ•°æ¨¡æ¿å‚æ•°éƒ½æ˜¯ç±»å‹ï¼Œåšçš„éƒ½æ˜¯æ˜¯ç±»å‹æ¨å¯¼ï¼Œè¿™è´§å±…ç„¶æ˜¯int(int, int) 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2020-01-02 09:43:47</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">lambdaè¡¨è¾¾å¼çš„ç†è§£æ²¡å•¥é—®é¢˜ã€‚<br><br>int(int, int) ä¹Ÿæ˜¯ä¸€ä¸ªç±»å‹ï¼šä¸€ä¸ªæ¥å—ä¸¤ä¸ªæ•´æ•°å‚æ•°ã€è¿”å›ä¸€ä¸ªæ•´æ•°çš„å‡½æ•°ã€‚function çš„ä¸»è¦å¤æ‚æ€§ï¼Œåº”è¯¥æ˜¯éœ€è¦å¤„ç†å‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€å‡½æ•°å¯¹è±¡ç­‰å„ç§æƒ…å†µã€‚å‡½æ•°å¯¹è±¡çš„å¤§å°ä¸ç¡®å®šï¼Œå› è€Œ function éœ€è¦åœ¨å †ä¸Šåˆ†é…å†…å­˜ã€‚operator() æˆ‘è®°å¾—ç›¸å½“äºä¸€ä¸ªè™šå‡½æ•°è°ƒç”¨çš„å¤æ‚åº¦ã€‚</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            hello world  2020-01-01 16:56:05
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è¯·é—®è€å¸ˆåç»­ä¼šè®²å…³äºç±»å¯¹è±¡åŠè™šå‡½æ•°è¡¨ç›¸å…³çŸ¥è¯†å—ï¼Œè¿™å—æ¯”è¾ƒè–„å¼± 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2020-01-01 18:08:57</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">ä¸ä¼šã€‚è°ˆè¿™ä¸ªçš„ä¹¦å’Œæ–‡ç« å¤Ÿå¤šäº†ã€‚</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            viper  2020-01-01 10:19:37
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è€å¸ˆï¼Œä¸ºä»€ä¹ˆä¸Šé¢ä¼šè¯´ç”¨add_2å»è°ƒç”¨é‚£ä¸‰æ¨¡ç‰ˆå‡½æ•°è¿”å›å€¼éƒ½æ˜¯2ï¼Œä¸è¯¥æ˜¯4å—ï¼Ÿ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2020-01-02 11:43:50</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">è°¢è°¢åé¦ˆã€‚å·²æ›´æ­£ã€‚</div>
</div>
            
    </div>
</li>
            </ul>
</div>
</body>
</html>