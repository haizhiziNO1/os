<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>18-åº”ç”¨å¯å˜æ¨¡æ¿å’Œtupleçš„ç¼–è¯‘æœŸæŠ€å·§</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <style>
        html {
            color: #333;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
            font-family: Helvetica Neue, PingFang SC, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif
        }

        html.borderbox *,
        html.borderbox :after,
        html.borderbox :before {
            box-sizing: border-box
        }

        article,
        aside,
        blockquote,
        body,
        button,
        code,
        dd,
        details,
        dl,
        dt,
        fieldset,
        figcaption,
        figure,
        footer,
        form,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        header,
        hr,
        input,
        legend,
        li,
        menu,
        nav,
        ol,
        p,
        pre,
        section,
        td,
        textarea,
        th,
        ul {
            margin: 0;
            padding: 0
        }

        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block
        }

        audio,
        canvas,
        video {
            display: inline-block
        }

        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, Helvetica, sans-serif
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        fieldset,
        img {
            border: 0
        }

        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0
            }
        }

        abbr,
        acronym {
            border-bottom: 1px dotted;
            font-variant: normal
        }

        abbr {
            cursor: help
        }

        del {
            text-decoration: line-through
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400
        }

        ol,
        ul {
            list-style: none
        }

        caption,
        th {
            text-align: left
        }

        q:after,
        q:before {
            content: ""
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative
        }

        :root sub,
        :root sup {
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        a {
            color: #1abc9c
        }

        a:hover {
            text-decoration: underline
        }

        .typo a {
            border-bottom: 1px solid #1abc9c
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555
        }

        .typo a:hover,
        a,
        ins {
            text-decoration: none
        }

        .typo-u,
        u {
            text-decoration: underline
        }

        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px
        }

        code,
        pre,
        pre tt {
            font-family: Courier, Courier New, monospace
        }

        pre {
            background: hsla(0, 0%, 97%, .7);
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch
        }

        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: .8em;
            height: 10px
        }

        .typo-small,
        figcaption,
        small {
            font-size: .9em;
            color: #888
        }

        b,
        strong {
            font-weight: 700;
            color: #000
        }

        [draggable] {
            cursor: move
        }

        .clearfix:after,
        .clearfix:before {
            content: "";
            display: table
        }

        .clearfix:after {
            clear: both
        }

        .clearfix {
            zoom: 1
        }

        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all
        }

        .textwrap-table {
            table-layout: fixed
        }

        .serif {
            font-family: Palatino, Optima, Georgia, serif
        }

        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-ol,
        .typo-p,
        .typo-pre,
        .typo-table,
        .typo-ul,
        .typo dl,
        .typo form,
        .typo hr,
        .typo ol,
        .typo p,
        .typo pre,
        .typo table,
        .typo ul,
        blockquote {
            margin-bottom: 1rem
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Helvetica Neue, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            color: #000;
            line-height: 1.35
        }

        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6,
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6 {
            margin-top: 1.2em;
            margin-bottom: .6em;
            line-height: 1.35
        }

        .typo-h1,
        .typo h1 {
            font-size: 2em
        }

        .typo-h2,
        .typo h2 {
            font-size: 1.8em
        }

        .typo-h3,
        .typo h3 {
            font-size: 1.6em
        }

        .typo-h4,
        .typo h4 {
            font-size: 1.4em
        }

        .typo-h5,
        .typo-h6,
        .typo h5,
        .typo h6 {
            font-size: 1.2em
        }

        .typo-ul,
        .typo ul {
            margin-left: 1.3em;
            list-style: disc
        }

        .typo-ol,
        .typo ol {
            list-style: decimal;
            margin-left: 1.9em
        }

        .typo-ol ol,
        .typo-ol ul,
        .typo-ul ol,
        .typo-ul ul,
        .typo li ol,
        .typo li ul {
            margin-bottom: .8em;
            margin-left: 2em
        }

        .typo-ol ul,
        .typo-ul ul,
        .typo li ul {
            list-style: circle
        }

        .typo-table td,
        .typo-table th,
        .typo table caption,
        .typo table td,
        .typo table th {
            border: 1px solid #ddd;
            padding: .5em 1em;
            color: #666
        }

        .typo-table th,
        .typo table th {
            background: #fbfbfb
        }

        .typo-table thead th,
        .typo table thead th {
            background: hsla(0, 0%, 95%, .7)
        }

        .typo table caption {
            border-bottom: none
        }

        .typo-input,
        .typo-textarea {
            -webkit-appearance: none;
            border-radius: 0
        }

        .typo-em,
        .typo em,
        caption,
        legend {
            color: #000;
            font-weight: inherit
        }

        .typo-em {
            position: relative
        }

        .typo-em:after {
            position: absolute;
            top: .65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"
        }

        .typo img {
            max-width: 100%
        }

        .common-content {
            font-weight: 400;
            color: #353535;
            line-height: 1.75rem;
            white-space: normal;
            word-break: normal;
            font-size: 1rem
        }

        .common-content img {
            display: block;
            max-width: 100%;
            background-color: #eee
        }

        .common-content audio,
        .common-content video {
            width: 100%;
            background-color: #eee
        }

        .common-content center,
        .common-content font {
            margin-top: 1rem;
            display: inline-block
        }

        .common-content center {
            width: 100%
        }

        .common-content pre {
            margin-top: 1rem;
            padding-left: 0;
            padding-right: 0;
            position: relative;
            overflow: hidden
        }

        .common-content pre code {
            font-size: .8rem;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            width: 100%;
            box-sizing: border-box;
            padding-left: 1rem;
            padding-right: 1rem;
            overflow-x: auto
        }

        .common-content hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        .common-content b,
        .common-content h1,
        .common-content h2,
        .common-content h3,
        .common-content h4,
        .common-content h5,
        .common-content strong {
            font-weight: 700
        }

        .common-content h1,
        .common-content h2 {
            font-size: 1.125rem;
            margin-bottom: .45rem
        }

        .common-content h3,
        .common-content h4,
        .common-content h5 {
            font-size: 1rem;
            margin-bottom: .45rem
        }

        .common-content p {
            font-weight: 400;
            color: #353535;
            margin-top: .15rem
        }

        .common-content .orange {
            color: #ff5a05
        }

        .common-content .reference {
            font-size: 1rem;
            color: #888
        }

        .custom-rich-content h1 {
            margin-top: 0;
            font-weight: 400;
            font-size: 15.25px;
            border-bottom: 1px solid #eee;
            line-height: 2.8
        }

        .custom-rich-content li,
        .custom-rich-content p {
            font-size: 14px;
            color: #888;
            line-height: 1.6
        }

        table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        table.hljs-ln,
        table.hljs-ln tbody,
        table.hljs-ln td,
        table.hljs-ln tr {
            box-sizing: border-box
        }

        table.hljs-ln td {
            padding: 0;
            border: 0
        }

        table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            user-select: none
        }

        table.hljs-ln td.hljs-ln-code,
        table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            font-size: 12px;
            line-height: 20px;
            vertical-align: top
        }

        table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            color: #24292e;
            word-wrap: normal;
            white-space: pre
        }

        video::-webkit-media-controls {
            overflow: hidden !important
        }

        video::-webkit-media-controls-enclosure {
            width: calc(100% + 32px);
            margin-left: auto
        }

        ._29HP61GA_0 {
            max-width:800px;
            margin:0 auto;
            margin-bottom: 20px;
            font-weight: 400;
            color: #353535;
            line-height: 1.76;
            white-space: normal;
            word-break: normal;
            font-size: 17px;
            -webkit-transition: background-color .3s ease;
            transition: background-color .3s ease
        }

        ._29HP61GA_0 .MathJax_Display {
            overflow: auto
        }

        ._29HP61GA_0 .poster {
            position: fixed;
            left: -10000px;
            top: -10000px;
            overflow: hidden;
            padding: 1rem;
            background: #ececec
        }

        ._29HP61GA_0 .richcontent-pre-copy {
            font-size: 13px;
            color: #888;
            position: absolute;
            right: 1em;
            top: .5em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 .richcontent-pre-copy .iconfont {
            font-size: 12px;
            margin-right: .2em
        }

        ._29HP61GA_0 a {
            color: #fa8919;
            border-bottom: 1px solid #fa8919
        }

        ._29HP61GA_0 img {
            display: block;
            max-width: 100%;
            position: relative;
            left: 50%;
            -webkit-transform: translateX(-50%);
            transform: translateX(-50%);
            background-color: #eee;
            vertical-align: top;
            border-radius: 0
        }

        ._29HP61GA_0 audio,
        ._29HP61GA_0 video {
            width: 100%;
            background-color: #eee
        }

        ._29HP61GA_0 pre {
            margin-top: 16px;
            padding: 34px 0 0;
            margin-bottom: 30px;
            position: relative;
            border-radius: 6px;
            background: rgba(246, 247, 251, .749);
            border: 0
        }

        ._29HP61GA_0 pre code {
            font-size: 12px;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            margin-left: 16px;
            margin-right: 16px;
            overflow-x: scroll
        }

        ._29HP61GA_0 pre code:after {
            content: "";
            height: 30px;
            width: 100%;
            display: block
        }

        ._29HP61GA_0 hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        ._29HP61GA_0 h1,
        ._29HP61GA_0 h2,
        ._29HP61GA_0 h3,
        ._29HP61GA_0 h4,
        ._29HP61GA_0 h5 {
            margin-bottom: 20px;
            margin-top: 0;
            font-weight: 700
        }

        ._29HP61GA_0 b,
        ._29HP61GA_0 strong {
            font-weight: 700
        }

        ._29HP61GA_0 h1 {
            font-size: 21px
        }

        ._29HP61GA_0 h2 {
            font-size: 20px
        }

        ._29HP61GA_0 h3 {
            font-size: 19px
        }

        ._29HP61GA_0 h4 {
            font-size: 18px
        }

        ._29HP61GA_0 h5 {
            font-size: 17px
        }

        ._29HP61GA_0 center,
        ._29HP61GA_0 p {
            font-weight: 400;
            color: #353535;
            margin-top: 0;
            margin-bottom: 30px;
            word-break: break-word
        }

        ._29HP61GA_0 center {
            text-align: center
        }

        ._29HP61GA_0 blockquote {
            margin-top: 0;
            margin-bottom: 34px;
            border-left: 3px solid #e8e8e8;
            padding-left: 17px;
            color: #353535
        }

        ._29HP61GA_0 blockquote p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol,
        ._29HP61GA_0 ul {
            margin-bottom: 30px
        }

        ._29HP61GA_0 ol p,
        ._29HP61GA_0 ul p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol {
            list-style: decimal;
            margin-left: 20px
        }

        ._29HP61GA_0 ul li {
            padding-left: 17px;
            position: relative;
            margin-bottom: 10px
        }

        ._29HP61GA_0 ul li:after {
            content: "";
            height: 6px;
            width: 6px;
            border-radius: 50%;
            background: #353535;
            position: absolute;
            top: 10px;
            left: 0
        }

        ._29HP61GA_0 .orange {
            color: #fa8919
        }

        ._29HP61GA_0 .reference {
            color: #888
        }

        ._29HP61GA_0 .m-right {
            text-align: right
        }

        ._29HP61GA_0 .m-center {
            text-align: center;
            display: block
        }

        ._29HP61GA_0 .m-gray {
            color: #888
        }

        ._29HP61GA_0 .m-small {
            font-size: 15px
        }

        ._29HP61GA_0 table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        ._29HP61GA_0 table.hljs-ln,
        ._29HP61GA_0 table.hljs-ln tbody,
        ._29HP61GA_0 table.hljs-ln td,
        ._29HP61GA_0 table.hljs-ln tr {
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        ._29HP61GA_0 table.hljs-ln td {
            padding: 0;
            border: 0
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            font-size: 12px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code,
        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            line-height: 20px;
            vertical-align: top
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            font-size: 13px;
            color: #666;
            word-wrap: normal;
            white-space: pre
        }

    </style>
</head>
<body>
<div class="_29HP61GA_0">
<h1>18-åº”ç”¨å¯å˜æ¨¡æ¿å’Œtupleçš„ç¼–è¯‘æœŸæŠ€å·§</h1>
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚</p><p>ä»Šå¤©æˆ‘ä»¬è®²ä¸€ä¸ªç‰¹æ®Šçš„ä¸“é¢˜ï¼Œå¦‚ä½•ä½¿ç”¨å¯å˜æ¨¡æ¿å’Œ tuple æ¥å®Œæˆä¸€äº›å¸¸è§çš„åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯ç¼–è¯‘æœŸè®¡ç®—ã€‚</p><h2>å¯å˜æ¨¡æ¿</h2><p>å¯å˜æ¨¡æ¿ <span class="orange">[1]</span> æ˜¯ C++11 å¼•å…¥çš„ä¸€é¡¹æ–°åŠŸèƒ½ï¼Œä½¿æˆ‘ä»¬å¯ä»¥åœ¨æ¨¡æ¿å‚æ•°é‡Œè¡¨è¾¾ä¸å®šä¸ªæ•°å’Œç±»å‹çš„å‚æ•°ã€‚ä»å®é™…çš„è§’åº¦ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ˜æ˜¾çš„ç”¨é€”ï¼š</p><ul>
<li>ç”¨äºåœ¨é€šç”¨å·¥å…·æ¨¡æ¿ä¸­è½¬å‘å‚æ•°åˆ°å¦å¤–ä¸€ä¸ªå‡½æ•°</li>
<li>ç”¨äºåœ¨é€’å½’çš„æ¨¡æ¿ä¸­è¡¨è¾¾é€šç”¨çš„æƒ…å†µï¼ˆå¦å¤–ä¼šæœ‰è‡³å°‘ä¸€ä¸ªæ¨¡æ¿ç‰¹åŒ–æ¥è¡¨è¾¾è¾¹ç•Œæƒ…å†µï¼‰</li>
</ul><p>æˆ‘ä»¬ä¸‹é¢å°±æ¥åˆ†å¼€è®¨è®ºä¸€ä¸‹ã€‚</p><h3>è½¬å‘ç”¨æ³•</h3><p>ä»¥æ ‡å‡†åº“é‡Œçš„ <code>make_unique</code> ä¸ºä¾‹ï¼Œå®ƒçš„å®šä¹‰å·®ä¸å¤šæ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p><pre><code class="language-c++">template &lt;typename T,
          typename... Args&gt;
inline unique_ptr&lt;T&gt;
make_unique(Args&amp;&amp;... args)
{
  return unique_ptr&lt;T&gt;(
    new T(forward&lt;Args&gt;(args)...));
}
</code></pre><p>è¿™æ ·ï¼Œå®ƒå°±å¯ä»¥æŠŠä¼ é€’ç»™è‡ªå·±çš„å…¨éƒ¨å‚æ•°è½¬å‘åˆ°æ¨¡æ¿å‚æ•°ç±»çš„æ„é€ å‡½æ•°ä¸Šå»ã€‚æ³¨æ„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨ <code>std::forward</code>ï¼Œç¡®ä¿å‚æ•°è½¬å‘æ—¶ä»ç„¶ä¿æŒæ­£ç¡®çš„å·¦å€¼æˆ–å³å€¼å¼•ç”¨ç±»å‹ã€‚</p><p>ç¨å¾®è§£é‡Šä¸€ä¸‹ä¸Šé¢ä¸‰å¤„å‡ºç°çš„ <code>...</code>ï¼š</p><ul>
<li><code>typename... Args</code> å£°æ˜äº†ä¸€ç³»åˆ—çš„ç±»å‹â€”â€”<code>class...</code> æˆ– <code>typename...</code> è¡¨ç¤ºåé¢çš„æ ‡è¯†ç¬¦ä»£è¡¨äº†ä¸€ç³»åˆ—çš„ç±»å‹ã€‚</li>
<li><code>Args&amp;&amp;... args</code> å£°æ˜äº†ä¸€ç³»åˆ—çš„å½¢å‚ <code>args</code>ï¼Œå…¶ç±»å‹æ˜¯ <code>Args&amp;&amp;</code>ã€‚</li>
<li><code>forward&lt;Args&gt;(args)...</code> ä¼šåœ¨ç¼–è¯‘æ—¶å®é™…é€é¡¹å±•å¼€ <code>Args</code> å’Œ <code>args</code> ï¼Œå‚æ•°æœ‰å¤šå°‘é¡¹ï¼Œå±•å¼€åå°±æ˜¯å¤šå°‘é¡¹ã€‚</li>
</ul><!-- [[[read_end]]] --><p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦åœ¨å †ä¸Šä¼ é€’ä¸€ä¸ª <code>vector&lt;int&gt;</code>ï¼Œå‡è®¾æˆ‘ä»¬å¸Œæœ›åˆå§‹æ„é€ çš„å¤§å°ä¸º 100ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ <code>1</code>ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š</p><pre><code class="language-c++">make_unique&lt;vector&lt;int&gt;&gt;(100, 1)
</code></pre><p>æ¨¡æ¿å®ä¾‹åŒ–ä¹‹åï¼Œä¼šå¾—åˆ°ç›¸å½“äºä¸‹é¢çš„ä»£ç ï¼š</p><pre><code class="language-c++">template &lt;&gt;
inline unique_ptr&lt;vector&lt;int&gt;&gt;
make_unique(int&amp;&amp; arg1, int&amp;&amp; arg2)
{
  return unique_ptr&lt;vector&lt;int&gt;&gt;(
    new vector&lt;int&gt;(
      forward&lt;int&gt;(arg1),
      forward&lt;int&gt;(arg2)));
}
</code></pre><p>å¦‚å‰æ‰€è¿°ï¼Œ<code>forward&lt;Args&gt;(args)...</code> ä¸ºæ¯ä¸€é¡¹å¯å˜æ¨¡æ¿å‚æ•°éƒ½ä»¥åŒæ ·çš„å½¢å¼å±•å¼€ã€‚é¡¹æ•°ä¹Ÿå…è®¸ä¸ºé›¶ï¼Œé‚£æ ·ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨æ„é€ å‡½æ•°æ—¶ä¹ŸåŒæ ·æ²¡æœ‰ä»»ä½•å‚æ•°ã€‚</p><h3>é€’å½’ç”¨æ³•</h3><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å¯å˜æ¨¡æ¿æ¥å®ç°ç¼–è¯‘æœŸé€’å½’ã€‚ä¸‹é¢å°±æ˜¯ä¸ªå°ä¾‹å­ï¼š</p><pre><code class="language-c++">template &lt;typename T&gt;
constexpr auto sum(T x)
{
  return x;
}

template &lt;typename T1, typename T2,
          typename... Targ&gt;
constexpr auto sum(T1 x, T2 y,
                   Targ... args)
{
  return sum(x + y, args...);
}
</code></pre><p>åœ¨ä¸Šé¢çš„å®šä¹‰é‡Œï¼Œå¦‚æœ <code>sum</code> å¾—åˆ°çš„å‚æ•°åªæœ‰ä¸€ä¸ªï¼Œä¼šèµ°åˆ°ä¸Šé¢é‚£ä¸ªé‡è½½ã€‚å¦‚æœæœ‰ä¸¤ä¸ªæˆ–æ›´å¤šå‚æ•°ï¼Œç¼–è¯‘å™¨å°±ä¼šé€‰æ‹©ä¸‹é¢é‚£ä¸ªé‡è½½ï¼Œæ‰§è¡Œä¸€æ¬¡åŠ æ³•ï¼Œéšåä½ çš„å‚æ•°æ•°é‡å°±å°‘äº†ä¸€ä¸ªï¼Œå› è€Œé€’å½’æ€»ä¼šç»ˆæ­¢åˆ°ä¸Šé¢é‚£ä¸ªé‡è½½ï¼Œç»“æŸè®¡ç®—ã€‚</p><p>è¦ä½¿ç”¨ä¸Šé¢è¿™ä¸ªæ¨¡æ¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºåƒä¸‹é¢è¿™æ ·çš„å‡½æ•°è°ƒç”¨ï¼š</p><pre><code class="language-c++">auto result = sum(1, 2, 3.5, x);
</code></pre><p>æ¨¡æ¿ä¼šè¿™æ ·ä¾æ¬¡å±•å¼€ï¼š</p><pre><code class="language-c++">sum(1 + 2, 3.5, x)
sum(3 + 3.5, x)
sum(6.5 + x)
6.5 + x
</code></pre><p>æ³¨æ„æˆ‘ä»¬éƒ½ä¸å¿…ä½¿ç”¨ç›¸åŒçš„æ•°æ®ç±»å‹ï¼šåªè¦è¿™äº›æ•°æ®ä¹‹é—´å¯ä»¥åº”ç”¨ <code>+</code>ï¼Œå®ƒä»¬çš„ç±»å‹æ— å…³ç´§è¦â€¦â€¦</p><p>å†çœ‹å¦ä¸€ä¸ªå¤æ‚äº›çš„ä¾‹å­ï¼Œå‡½æ•°çš„ç»„åˆ <span class="orange">[2]</span>ã€‚å¦‚æœæˆ‘ä»¬æœ‰å‡½æ•° $f$ å’Œ å‡½æ•° $g$ï¼Œè¦å¾—åˆ°å‡½æ•°çš„è”ç”¨ $g \circ f$ï¼Œå…¶æ»¡è¶³ï¼š</p><p>$$<br>
(g \circ f)(x) = g(f(x))<br>
$$</p><p>æˆ‘ä»¬èƒ½ä¸èƒ½ç”¨ä¸€ç§éå¸¸ç®€å•çš„æ–¹å¼ï¼Œå†™ä¸åŒ…å«å˜é‡ $x$ çš„è¡¨è¾¾å¼æ¥è¡¨ç¤ºå‡½æ•°ç»„åˆå‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚</p><p>è·Ÿä¸Šé¢ç±»ä¼¼ï¼Œæˆ‘ä»¬éœ€è¦å†™å‡ºé€’å½’çš„ç»ˆç»“æƒ…å†µï¼Œå•ä¸ªå‡½æ•°çš„â€œç»„åˆâ€ï¼š</p><pre><code class="language-c++">template &lt;typename F&gt;
auto compose(F f)
{
  return [f](auto&amp;&amp;... x) {
    return f(x...);
  };
}
</code></pre><p>ä¸Šé¢æˆ‘ä»¬ä»…è¿”å›ä¸€ä¸ªæ³›å‹ lambda è¡¨è¾¾å¼ï¼Œä¿è¯å‚æ•°å¯ä»¥è½¬å‘åˆ° <code>f</code>ã€‚è®°å¾—æˆ‘ä»¬åœ¨ <a href="https://time.geekbang.org/column/article/184018">[ç¬¬ 16 è®²]</a> è®²è¿‡æ³›å‹ lambda è¡¨è¾¾å¼ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œæ‰€ä»¥æˆ‘ä»¬æŒ‰è½¬å‘ç”¨æ³•çš„å¯å˜æ¨¡æ¿æ¥ç†è§£ä¸Šé¢çš„ <code>...</code> éƒ¨åˆ†å°±å¯¹äº†ã€‚</p><p>ä¸‹é¢æ˜¯æ­£å¸¸æœ‰ç»„åˆçš„æƒ…å†µï¼š</p><pre><code class="language-c++">template &lt;typename F,
          typename... Args&gt;
auto compose(F f, Args... args)
{
  return [f, args...](auto&amp;&amp;... x) {
    return f(
      compose(args...)(x...));
  };
}
</code></pre><p>åœ¨è¿™ä¸ªæ¨¡æ¿é‡Œï¼Œæˆ‘ä»¬è¿”å›ä¸€ä¸ª lambda è¡¨è¾¾å¼ï¼Œç„¶åç”¨ <code>f</code> æ•æ‰ç¬¬ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œç”¨ <code>args...</code> æ•æ‰åé¢çš„å‡½æ•°å¯¹è±¡ã€‚æˆ‘ä»¬ç”¨ <code>args...</code> ç»§ç»­ç»„åˆåé¢çš„éƒ¨åˆ†ï¼Œç„¶åæŠŠç»“æœä¼ åˆ° <code>f</code> é‡Œé¢ã€‚</p><p>ä¸Šé¢çš„æ¨¡æ¿å®šä¹‰æˆ‘å®é™…ä¸Šå·²ç»æœ‰æ‰€ç®€åŒ–ï¼Œæ²¡æœ‰ä¿æŒå€¼ç±»åˆ«ã€‚å®Œæ•´çš„åŒ…å«å®Œç¾è½¬å‘çš„ç‰ˆæœ¬ï¼Œè¯·çœ‹å‚è€ƒèµ„æ–™ <span class="orange">[3]</span> ä¸­çš„ functional.h å®ç°ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥è¯•éªŒä¸€ä¸‹ä½¿ç”¨è¿™ä¸ª <code>compose</code> å‡½æ•°ã€‚æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªå¯¹è¾“å…¥èŒƒå›´ä¸­æ¯ä¸€é¡¹éƒ½è¿›è¡Œå¹³æ–¹çš„å‡½æ•°å¯¹è±¡ï¼š</p><pre><code class="language-c++">auto square_list =
  [](auto&amp;&amp; container) {
    return fmap(
      [](int x) { return x * x; },
      container);
  };
</code></pre><p>æˆ‘ä»¬ä½¿ç”¨äº† <a href="https://time.geekbang.org/column/article/181608">[ç¬¬ 13 è®²]</a> ä¸­ç»™å‡ºçš„ <code>fmap</code>ï¼Œè€Œä¸æ˜¯æ ‡å‡†åº“é‡Œçš„ <code>transform</code>ï¼Œæ˜¯å› ä¸ºåè€…æ¥å£éå‡½æ•°å¼ï¼ˆå®ƒè¦æ±‚å‚æ•°ç»™å‡ºè¾“å‡ºä½ç½®çš„è¿­ä»£å™¨ï¼Œä¼šä¿®æ”¹è¿­ä»£å™¨æŒ‡å‘çš„å†…å®¹ï¼Œè¿”å›ç»“æœä¹Ÿåªæ˜¯å•ä¸ªçš„è¿­ä»£å™¨ï¼›å‡½æ•°å¼çš„æ¥å£åˆ™æœŸæœ›ä¸ä¿®æ”¹å‚æ•°çš„å†…å®¹ï¼Œç»“æœå®Œå…¨åœ¨è¿”å›å€¼ä¸­ï¼‰ï¼Œæ— æ³•ç»„åˆã€‚æˆ‘ä»¬ä¹Ÿåªèƒ½ä½¿ç”¨å‡½æ•°å¯¹è±¡ï¼Œè€Œä¸èƒ½å®šä¹‰å‡½æ•°ï¼Œå› ä¸ºåªæœ‰å‡½æ•°å¯¹è±¡æ‰æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç±»å‹ï¼Œèƒ½å¤Ÿç”¨åœ¨ç±»å‹æ¨å¯¼ä¸­ã€‚åæ­£ï¼Œæ³›å‹ lambda è¡¨è¾¾å¼å†™èµ·æ¥æ¯”å‡½æ•°æ¨¡æ¿è¿˜ç®€å•äº›ï¼Œä¸ä¼šæ˜¯ä»€ä¹ˆé—®é¢˜ã€‚</p><p>æˆ‘ä»¬å†å†™ä¸€ä¸ªæ±‚å’Œçš„å‡½æ•°å¯¹è±¡ï¼š</p><pre><code class="language-c++">auto sum_list =
  [](auto&amp;&amp; container) {
    return accumulate(
      container.begin(),
      container.end(), 0);
  };
</code></pre><p>é‚£å…ˆå¹³æ–¹å†æ±‚å’Œï¼Œå°±å¯ä»¥è¿™æ ·ç®€å•å®šä¹‰äº†ï¼š</p><pre><code class="language-c++">auto squared_sum =
  compose(sum_list, square_list);
</code></pre><p>æˆ‘ä»¬å¯ä»¥éªŒè¯è¿™ä¸ªå®šä¹‰æ˜¯å¯ä»¥å·¥ä½œçš„ï¼š</p><pre><code class="language-c++">vector v{1, 2, 3, 4, 5};
cout &lt;&lt; squared_sum(v) &lt;&lt; endl;
</code></pre><p>æˆ‘ä»¬ä¼šå¾—åˆ°ï¼š</p><blockquote>
<p><code>55</code></p>
</blockquote><h2>tuple</h2><p>ä¸Šé¢çš„å†™æ³•è™½ç„¶çœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œä½†å®é™…ä¸Šæœ‰ä¸ªç¼ºé™·ï¼šè¢« compose çš„å‡½æ•°é™¤äº†ç¬¬ä¸€ä¸ªï¼ˆæœ€å³è¾¹çš„ï¼‰ï¼Œå…¶ä»–çš„å‡½æ•°åªèƒ½æ¥æ”¶ä¸€ä¸ªå‚æ•°ã€‚è¦æƒ³è¿›ä¸€æ­¥æ¨è¿›ç±»ä¼¼çš„æŠ€å·§ï¼Œæˆ‘ä»¬å¾—é¦–å…ˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>åœ¨ C++ é‡Œï¼Œè¦é€šç”¨åœ°ç”¨ä¸€ä¸ªå˜é‡æ¥è¡¨è¾¾å¤šä¸ªå€¼ï¼Œé‚£å°±å¾—çœ‹å¤šå…ƒç»„â€”â€”<code>tuple</code> æ¨¡æ¿äº† <span class="orange">[4]</span>ã€‚<code>tuple</code> ç®—æ˜¯ C++98 é‡Œçš„ <code>pair</code> ç±»å‹çš„ä¸€èˆ¬åŒ–ï¼Œå¯ä»¥è¡¨è¾¾ä»»æ„å¤šä¸ªå›ºå®šæ•°é‡ã€å›ºå®šç±»å‹çš„å€¼çš„ç»„åˆã€‚ä¸‹é¢è¿™æ®µä»£ç çº¦ç•¥åœ°å±•ç¤ºäº†å…¶åŸºæœ¬ç”¨æ³•ï¼š</p><pre><code class="language-c++">#include &lt;algorithm&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;tuple&gt;
#include &lt;vector&gt;

using namespace std;

// æ•´æ•°ã€å­—ç¬¦ä¸²ã€å­—ç¬¦ä¸²çš„ä¸‰å…ƒç»„
using num_tuple =
  tuple&lt;int, string, string&gt;;

ostream&amp;
operator&lt;&lt;(ostream&amp; os,
           const num_tuple&amp; value)
{
  os &lt;&lt; get&lt;0&gt;(value) &lt;&lt; ','
     &lt;&lt; get&lt;1&gt;(value) &lt;&lt; ','
     &lt;&lt; get&lt;2&gt;(value);
  return os;
}

int main()
{
  // é˜¿æ‹‰ä¼¯æ•°å­—ã€è‹±æ–‡ã€æ³•æ–‡
  vector&lt;num_tuple&gt; vn{
    {1, "one",   "un"},
    {2, "two",   "deux"},
    {3, "three", "trois"},
    {4, "four",  "quatre"}};
  // ä¿®æ”¹ç¬¬ 0 é¡¹çš„æ³•æ–‡
  get&lt;2&gt;(vn[0]) = "une";
  // æŒ‰æ³•æ–‡è¿›è¡Œæ’åº
  sort(vn.begin(), vn.end(),
       [](auto&amp;&amp; x, auto&amp;&amp; y) {
         return get&lt;2&gt;(x) &lt;
                get&lt;2&gt;(y);
       });
  // è¾“å‡ºå†…å®¹
  for (auto&amp;&amp; value : vn) {
    cout &lt;&lt; value &lt;&lt; endl;
  }
  // è¾“å‡ºå¤šå…ƒç»„é¡¹æ•°
  constexpr auto size = \
    tuple_size_v&lt;num_tuple&gt;;
  cout &lt;&lt; "Tuple size is " &lt;&lt; size &lt;&lt; endl;
}
</code></pre><p>è¾“å‡ºæ˜¯ï¼š</p><blockquote>
<p><code>2,two,deux</code><br>
<code>4,four,quatre</code><br>
<code>3,three,trois</code><br>
<code>1,one,une</code><br>
<code>Tuple size is 3</code></p>
</blockquote><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><ul>
<li><code>tuple</code> çš„æˆå‘˜æ•°é‡ç”±å°–æ‹¬å·é‡Œå†™çš„ç±»å‹æ•°é‡å†³å®šã€‚</li>
<li>å¯ä»¥ä½¿ç”¨ <code>get</code> å‡½æ•°å¯¹ <code>tuple</code> çš„å†…å®¹è¿›è¡Œè¯»å’Œå†™ã€‚ï¼ˆå½“ä¸€ä¸ªç±»å‹åœ¨ <code>tuple</code> ä¸­å‡ºç°æ­£å¥½ä¸€æ¬¡æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¼ ç±»å‹å–å†…å®¹ï¼Œå³ï¼Œå¯¹æˆ‘ä»¬ä¸Šé¢çš„ä¸‰å…ƒç»„ï¼Œ<code>get&lt;int&gt;</code> æ˜¯åˆæ³•çš„ï¼Œ<code>get&lt;string&gt;</code> åˆ™ä¸æ˜¯ã€‚ï¼‰</li>
<li>å¯ä»¥ç”¨ <code>tuple_size_v</code> ï¼ˆåœ¨ç¼–è¯‘æœŸï¼‰å–å¾—å¤šå…ƒç»„é‡Œé¢çš„é¡¹æ•°ã€‚</li>
</ul><p>å¦‚æœæˆ‘ä»¬è¦ç”¨ä¸€ä¸ªä¸‰é¡¹çš„ <code>tuple</code> å»è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å†™ç±»ä¼¼è¿™æ ·çš„ä»£ç ï¼š</p><pre><code class="language-c++">template &lt;class F, class Tuple&gt;
constexpr decltype(auto) apply(
  F&amp;&amp; f, Tuple&amp;&amp; t)
{
  return f(
    get&lt;0&gt;(forward&lt;Tuple&gt;(t)),
    get&lt;1&gt;(forward&lt;Tuple&gt;(t)),
    get&lt;2&gt;(forward&lt;Tuple&gt;(t)));
}
</code></pre><p>è¿™ä¼¼ä¹å·²ç»æŒºæ¥è¿‘æˆ‘ä»¬éœ€è¦çš„å½¢å¼äº†ï¼Œä½†å®é™…è°ƒç”¨å‡½æ•°çš„å‚æ•°é¡¹æ•°ä¼šå˜å•Šâ€¦â€¦</p><p>æˆ‘ä»¬å·²ç»æœ‰äº†å‚æ•°çš„é¡¹æ•°ï¼ˆä½¿ç”¨ <code>tuple_size_v</code>ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸‹é¢è¦åšçš„æ˜¯ç”Ÿæˆä» 0 åˆ°é¡¹æ•°å‡ä¸€ä¹‹é—´çš„æ•´æ•°åºåˆ—ã€‚æ ‡å‡†åº“é‡Œå·²ç»å®šä¹‰äº†ç›¸å…³çš„å·¥å…·ï¼Œæˆ‘ä»¬éœ€è¦çš„å°±æ˜¯å…¶ä¸­çš„ <code>make_index_sequence</code> <span class="orange">[5]</span>ï¼Œå…¶ç®€åŒ–å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="language-c++">template &lt;class T, T... Ints&gt;
struct integer_sequence {};

template &lt;size_t... Ints&gt;
using index_sequence =
  integer_sequence&lt;size_t, Ints...&gt;;

template &lt;size_t N, size_t... Ints&gt;
struct index_sequence_helper {
  typedef
    typename index_sequence_helper&lt;
      N - 1, N - 1, Ints...&gt;::type
      type;
};

template &lt;size_t... Ints&gt;
struct index_sequence_helper&lt;
  0, Ints...&gt; {
  typedef index_sequence&lt;Ints...&gt;
    type;
};

template &lt;size_t N&gt;
using make_index_sequence =
  typename index_sequence_helper&lt;
    N&gt;::type;
</code></pre><p>æ­£å¦‚ä¸€èˆ¬çš„æ¨¡æ¿ä»£ç ï¼Œå®ƒçœ‹èµ·æ¥è¿˜æ˜¯æœ‰ç‚¹ç»•çš„ã€‚å…¶è¦ç‚¹æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ç»™å‡º <code>make_index_sequence&lt;N&gt;</code>ï¼Œåˆ™ç»“æœæ˜¯ <code>integer_sequence&lt;size_t, 0, 1, 2, â€¦, N - 1&gt;</code>ï¼ˆä¸€ä¸‹å­æƒ³ä¸æ¸…æ¥šçš„è¯ï¼Œå¯ä»¥æ‹¿çº¸ç¬”æ¥æ¨¡æ‹Ÿä¸€ä¸‹æ¨¡æ¿çš„å±•å¼€è¿‡ç¨‹ï¼‰ã€‚è€Œæœ‰äº†è¿™æ ·ä¸€ä¸ªæ¨¡æ¿çš„å¸®åŠ©ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºä¸‹é¢è¿™æ ·çš„å‡½æ•°ï¼ˆåŒæ ·ï¼Œè¿™æ˜¯æ ‡å‡†åº“é‡Œçš„ <code>apply</code> å‡½æ•°æ¨¡æ¿ <span class="orange">[6]</span> çš„ç®€åŒ–ç‰ˆæœ¬ï¼‰ï¼š</p><pre><code class="language-c++">template &lt;class F, class Tuple,
          size_t... I&gt;
constexpr decltype(auto)
apply_impl(F&amp;&amp; f, Tuple&amp;&amp; t,
           index_sequence&lt;I...&gt;)
{
  return f(
    get&lt;I&gt;(forward&lt;Tuple&gt;(t))...);
}

template &lt;class F, class Tuple&gt;
constexpr decltype(auto)
apply(F&amp;&amp; f, Tuple&amp;&amp; t)
{
  return apply_impl(
    forward&lt;F&gt;(f),
    forward&lt;Tuple&gt;(t),
    make_index_sequence&lt;
      tuple_size_v&lt;
        remove_reference_t&lt;
          Tuple&gt;&gt;&gt;{});
}
</code></pre><p>æˆ‘ä»¬å¦‚æœæœ‰ä¸€ä¸ªä¸‰å…ƒç»„ <code>t</code>ï¼Œç±»å‹ä¸º <code>tuple&lt;int, string, string&gt;</code>ï¼Œå» <code>apply</code> åˆ°ä¸€ä¸ªå‡½æ•° <code>f</code>ï¼Œå±•å¼€åæˆ‘ä»¬å¾—åˆ° <code>apply_impl(f, t, index_sequence&lt;0, 1, 2&gt;{})</code>ï¼Œå†å±•å¼€åæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸Šé¢é‚£ä¸ªæœ‰ <code>get&lt;0&gt;</code>ã€<code>get&lt;1&gt;</code>ã€<code>get&lt;2&gt;</code> çš„å‡½æ•°è°ƒç”¨å½¢å¼ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åˆ©ç”¨ä¸€ä¸ªè®¡æ•°åºåˆ—çš„ç±»å‹ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶å±•å¼€ <code>tuple</code> é‡Œçš„å„ä¸ªæˆå‘˜ï¼Œå¹¶ç”¨æ¥è°ƒç”¨å‡½æ•°ã€‚</p><h2>æ•°å€¼é¢„ç®—</h2><p>ä¸Šé¢çš„ä»£ç æœ‰ç‚¹å¤æ‚ï¼Œè€Œä¸”ä¼¼ä¹å¹¶æ²¡æœ‰å®Œæˆä»€ä¹ˆå¾ˆé‡è¦çš„åŠŸèƒ½ã€‚æˆ‘ä»¬ä¸‹é¢çœ‹ä¸€ä¸ªæºè‡ªå®é™…é¡¹ç›®çš„ä¾‹å­ã€‚éœ€æ±‚æ˜¯ï¼Œæˆ‘ä»¬å¸Œæœ›å¿«é€Ÿåœ°è®¡ç®—ä¸€ä¸²äºŒè¿›åˆ¶æ•°ä¸­ 1 æ¯”ç‰¹çš„æ•°é‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æœ‰åè¿›åˆ¶çš„ 31 å’Œ 254ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶æ˜¯ 00011111 å’Œ 11111110ï¼Œé‚£æˆ‘ä»¬åº”è¯¥å¾—åˆ° 5 + 7 = 12ã€‚</p><p>æ˜¾ç„¶ï¼Œæ¯ä¸ªæ•°å­—ä¸´æ—¶å»æ•°è‚¯å®šä¼šæ…¢ï¼Œæˆ‘ä»¬åº”è¯¥é¢„å…ˆæŠŠæ¯ä¸ªå­—èŠ‚çš„ 256 ç§æƒ…å†µè®°å½•ä¸‹æ¥ã€‚å› è€Œï¼Œå¦‚ä½•å¾—åˆ°è¿™äº›è®¡æ•°å€¼æ˜¯ä¸ªé—®é¢˜ã€‚åœ¨æ²¡æœ‰ç¼–è¯‘æœŸç¼–ç¨‹æ—¶ï¼Œæˆ‘ä»¬ä¼¼ä¹åªèƒ½ç”¨å¦å¤–ä¸€ä¸ªç¨‹åºå…ˆè¡Œè®¡ç®—ï¼Œç„¶åæŠŠç»“æœå¡«è¿›å»â€”â€”è¿™å°±å¾ˆä¸æ–¹ä¾¿å¾ˆä¸çµæ´»äº†ã€‚æœ‰äº†ç¼–è¯‘æœŸç¼–ç¨‹ï¼Œæˆ‘ä»¬å°±ä¸ç”¨å†™æ­»ï¼Œè€Œè®©ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å¸®æˆ‘ä»¬è®¡ç®—æ•°å€¼ã€‚</p><p>åˆ©ç”¨ constexpr å‡½æ•°ï¼Œæˆ‘ä»¬è®¡ç®—å•ä¸ªæ•°å€¼å®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚å¿«é€Ÿå®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class="language-c++">constexpr int
count_bits(unsigned char value)
{
  if (value == 0) {
    return 0;
  } else {
    return (value &amp; 1) +
           count_bits(value &gt;&gt; 1);
  }
}
</code></pre><p>å¯ 256 ä¸ªï¼Œæ€»ä¸è§å¾—æŠŠè®¡ç®—è¯­å¥å†™ä¸Š 256 éå§ï¼Ÿè¿™å°±éœ€è¦ç”¨åˆ°æˆ‘ä»¬ä¸Šé¢è®²åˆ°çš„ <code>index_sequence</code> äº†ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¨¡æ¿ï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œåœ¨åˆå§‹åŒ–æ—¶è¿™ä¸ªæ¨¡æ¿ä¼šå¯¹å‚æ•°é‡Œçš„æ¯ä¸€é¡¹è®¡ç®—æ¯”ç‰¹æ•°ï¼Œå¹¶æ”¾åˆ°æ•°ç»„æˆå‘˜é‡Œã€‚</p><pre><code class="language-c++">template &lt;size_t... V&gt;
struct bit_count_t {
  unsigned char
    count[sizeof...(V)] = {
      static_cast&lt;unsigned char&gt;(
        count_bits(V))...};
};
</code></pre><p>æ³¨æ„ä¸Šé¢ç”¨ <code>sizeof...(V)</code> å¯ä»¥è·å¾—å‚æ•°çš„ä¸ªæ•°ï¼ˆåœ¨ <code>tuple_size_v</code> çš„å®ç°é‡Œå®é™…ä¹Ÿç”¨åˆ°å®ƒäº†ï¼‰ã€‚å¦‚æœæˆ‘ä»¬æ¨¡æ¿å‚æ•°ä¼  <code>0, 1, 2, 3</code>ï¼Œç»“æœé‡Œé¢å°±ä¼šæœ‰ä¸ªå« 4 é¡¹å…ƒç´ çš„æ•°ç»„ï¼Œæ•°å€¼åˆ†åˆ«æ˜¯å¯¹ 0ã€1ã€2ã€3 çš„æ¯”ç‰¹è®¡æ•°ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å½“ç„¶å°±å¯ä»¥åˆ©ç”¨ <code>make_index_sequence</code> æ¥å±•å¼€è®¡ç®—äº†ï¼Œæƒ³äº§ç”Ÿå‡ é¡¹å°±å¯ä»¥äº§ç”Ÿå‡ é¡¹ã€‚ä¸è¿‡ï¼Œè¦æ³¨æ„åˆ° <code>make_index_sequence</code> çš„ç»“æœæ˜¯ä¸ªç±»å‹ï¼Œä¸èƒ½ç›´æ¥ç”¨åœ¨ <code>bit_count_t</code> çš„æ„é€ ä¸­ã€‚æˆ‘ä»¬éœ€è¦ç”¨æ¨¡æ¿åŒ¹é…æ¥ä¸­è½¬ä¸€ä¸‹ï¼š</p><pre><code class="language-c++">template &lt;size_t... V&gt;
bit_count_t&lt;V...&gt; get_bit_count(
  index_sequence&lt;V...&gt;)
{
  return bit_count_t&lt;V...&gt;();
}

auto bit_count = get_bit_count(
  make_index_sequence&lt;256&gt;());
</code></pre><p>å¾—åˆ° <code>bit_count</code> åï¼Œæˆ‘ä»¬è¦è®¡ç®—ä¸€ä¸ªåºåˆ—é‡Œçš„æ¯”ç‰¹æ•°å°±åªæ˜¯è½»æ¾æŸ¥è¡¨ç›¸åŠ äº†ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p><h2>å†…å®¹å°ç»“</h2><p>ä»Šå¤©æˆ‘ä»¬è®¨è®ºäº†åœ¨ç¼–è¯‘æœŸå¤„ç†ä¸ç¡®å®šæ•°é‡çš„å‚æ•°å’Œç±»å‹çš„åŸºæœ¬è¯­è¨€ç‰¹æ€§ï¼Œå¯å˜æ¨¡æ¿ï¼Œä»¥åŠå¯ä»¥æ“æ§å¯å˜æ¨¡æ¿çš„é‡è¦å·¥å…·â€”â€”<code>tuple</code> å’Œ <code>index_sequence</code>ã€‚ç”¨å¥½è¿™äº›å·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬è½»æ¾åœ°å®Œæˆä¸€äº›ç¼–è¯‘æœŸè®¡ç®—çš„å·¥ä½œã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>è¯·è€ƒè™‘ä¸€ä¸‹ï¼š</p><ol>
<li>æˆ‘å±•ç¤ºäº† <code>compose</code> å¸¦ä¸€ä¸ªæˆ–æ›´å¤šå‚æ•°çš„æƒ…å†µã€‚ä½ è§‰å¾— <code>compose</code> ä¸å¸¦ä»»ä½•å‚æ•°è¯¥å¦‚ä½•å®šä¹‰ï¼Ÿå®ƒæœ‰æ„ä¹‰å—ï¼Ÿ</li>
<li>æœ‰æ²¡æœ‰å¯èƒ½ä¸ç”¨ <code>index_sequence</code> æ¥åˆå§‹åŒ– <code>bit_count</code>ï¼Ÿå¦‚æœè¡Œï¼Œåº”è¯¥å¦‚ä½•å®ç°ï¼Ÿ</li>
<li>ä½œä¸ºä¸€ä¸ªæŒ‘æˆ˜ï¼Œä½ èƒ½è‡ªè¡Œå®ç°å‡º <code>make_integer_sequence</code> å—ï¼Ÿ</li>
</ol><p>æœŸå¾…ä½ çš„ç­”æ¡ˆã€‚</p><h2><span class="reference">å‚è€ƒèµ„æ–™</span></h2><p><span class="reference">[1] cppreference.com, â€œParameter packâ€. <a href="https://en.cppreference.com/w/cpp/language/parameter_pack">https://en.cppreference.com/w/cpp/language/parameter_pack</a> </span></p><p><span class="reference">[1a] cppreference.com, â€œå½¢å‚åŒ…â€. <a href="https://zh.cppreference.com/w/cpp/language/parameter_pack">https://zh.cppreference.com/w/cpp/language/parameter_pack</a> </span></p><p><span class="reference">[2] Wikipedia, â€œFunction compositionâ€. <a href="https://en.wikipedia.org/wiki/Function_composition">https://en.wikipedia.org/wiki/Function_composition</a> </span></p><p><span class="reference">[2a] ç»´åŸºç™¾ç§‘, â€œå¤åˆå‡½æ•°â€. <a href="https://zh.wikipedia.org/zh-cn/%E5%A4%8D%E5%90%88%E5%87%BD%E6%95%B0">https://zh.wikipedia.org/zh-cn/å¤åˆå‡½æ•°</a> </span></p><p><span class="reference">[3] å´å’ç‚œ, nvwa. <a href="https://github.com/adah1972/nvwa">https://github.com/adah1972/nvwa</a> </span></p><p><span class="reference">[4] cppreference.com, â€œstd::tupleâ€. <a href="https://en.cppreference.com/w/cpp/utility/tuple">https://en.cppreference.com/w/cpp/utility/tuple</a> </span></p><p><span class="reference">[4a] cppreference.com, â€œstd::tupleâ€. <a href="https://zh.cppreference.com/w/cpp/utility/tuple">https://zh.cppreference.com/w/cpp/utility/tuple</a> </span></p><p><span class="reference">[5] cppreference.com, â€œstd::integer_sequenceâ€. <a href="https://en.cppreference.com/w/cpp/utility/integer_sequence">https://en.cppreference.com/w/cpp/utility/integer_sequence</a> </span></p><p><span class="reference">[5a] cppreference.com, â€œstd::integer_sequenceâ€. <a href="https://zh.cppreference.com/w/cpp/utility/integer_sequence">https://zh.cppreference.com/w/cpp/utility/integer_sequence</a> </span></p><p><span class="reference">[6] cppreference.com, â€œstd::applyâ€. <a href="https://en.cppreference.com/w/cpp/utility/apply">https://en.cppreference.com/w/cpp/utility/apply</a> </span></p><p><span class="reference">[6a] cppreference.com, â€œstd::applyâ€. <a href="https://zh.cppreference.com/w/cpp/utility/apply">https://zh.cppreference.com/w/cpp/utility/apply</a> </span></p><h2>ç²¾é€‰ç•™è¨€ï¼š</h2>
        <ul>
        
<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ç¦¾æ¡ƒ  2020-01-07 08:05:27
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            #1<br>template &lt;typename F,<br>          typename... Args&gt;<br>auto compose(F f, Args... args)<br>{<br>  return [f, args...]() {<br>    return f(<br>      compose(args...)());<br>  };<br>}<br><br><br>template &lt;typename F&gt;<br>auto compose(F f)<br>{<br>    return fï¼›<br>}<br><br>å¦‚æœè¿™äº›å‡½æ•°éƒ½åœ¨å‡½æ•°ä½“å†…æ“ä½œä¸€ä¸ªå…¬ç”¨çš„æ•°æ®ï¼Œè€Œä¸”è¿™äº›å‡½æ•°ä¾æ¬¡æ‰§è¡Œçš„é¡ºåºååº”äº†ä¸€å®šçš„å·¥ç¨‹éœ€æ±‚ï¼Œé‚£ä¹ˆå°±æ˜¯æœ‰æ„ä¹‰çš„å§ã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            æäº®äº®  2020-01-06 20:57:59
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            N--&gt;(N-1, N-1)--&gt;(N-2, N-2, N-1)--&gt;(1, 1 , 2 ....N-1)--&gt;(0, 0, 1, 2...N-1) 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2020-01-06 23:43:54</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">ğŸ˜ å­¦å¾—æŒºå¿«ã€‚</div>
</div>
            
    </div>
</li>
            </ul>
</div>
</body>
</html>