<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>03-å³å€¼å’Œç§»åŠ¨ç©¶ç«Ÿè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <style>
        html {
            color: #333;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
            font-family: Helvetica Neue, PingFang SC, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif
        }

        html.borderbox *,
        html.borderbox :after,
        html.borderbox :before {
            box-sizing: border-box
        }

        article,
        aside,
        blockquote,
        body,
        button,
        code,
        dd,
        details,
        dl,
        dt,
        fieldset,
        figcaption,
        figure,
        footer,
        form,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        header,
        hr,
        input,
        legend,
        li,
        menu,
        nav,
        ol,
        p,
        pre,
        section,
        td,
        textarea,
        th,
        ul {
            margin: 0;
            padding: 0
        }

        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block
        }

        audio,
        canvas,
        video {
            display: inline-block
        }

        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, Helvetica, sans-serif
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        fieldset,
        img {
            border: 0
        }

        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0
            }
        }

        abbr,
        acronym {
            border-bottom: 1px dotted;
            font-variant: normal
        }

        abbr {
            cursor: help
        }

        del {
            text-decoration: line-through
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400
        }

        ol,
        ul {
            list-style: none
        }

        caption,
        th {
            text-align: left
        }

        q:after,
        q:before {
            content: ""
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative
        }

        :root sub,
        :root sup {
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        a {
            color: #1abc9c
        }

        a:hover {
            text-decoration: underline
        }

        .typo a {
            border-bottom: 1px solid #1abc9c
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555
        }

        .typo a:hover,
        a,
        ins {
            text-decoration: none
        }

        .typo-u,
        u {
            text-decoration: underline
        }

        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px
        }

        code,
        pre,
        pre tt {
            font-family: Courier, Courier New, monospace
        }

        pre {
            background: hsla(0, 0%, 97%, .7);
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch
        }

        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: .8em;
            height: 10px
        }

        .typo-small,
        figcaption,
        small {
            font-size: .9em;
            color: #888
        }

        b,
        strong {
            font-weight: 700;
            color: #000
        }

        [draggable] {
            cursor: move
        }

        .clearfix:after,
        .clearfix:before {
            content: "";
            display: table
        }

        .clearfix:after {
            clear: both
        }

        .clearfix {
            zoom: 1
        }

        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all
        }

        .textwrap-table {
            table-layout: fixed
        }

        .serif {
            font-family: Palatino, Optima, Georgia, serif
        }

        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-ol,
        .typo-p,
        .typo-pre,
        .typo-table,
        .typo-ul,
        .typo dl,
        .typo form,
        .typo hr,
        .typo ol,
        .typo p,
        .typo pre,
        .typo table,
        .typo ul,
        blockquote {
            margin-bottom: 1rem
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Helvetica Neue, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            color: #000;
            line-height: 1.35
        }

        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6,
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6 {
            margin-top: 1.2em;
            margin-bottom: .6em;
            line-height: 1.35
        }

        .typo-h1,
        .typo h1 {
            font-size: 2em
        }

        .typo-h2,
        .typo h2 {
            font-size: 1.8em
        }

        .typo-h3,
        .typo h3 {
            font-size: 1.6em
        }

        .typo-h4,
        .typo h4 {
            font-size: 1.4em
        }

        .typo-h5,
        .typo-h6,
        .typo h5,
        .typo h6 {
            font-size: 1.2em
        }

        .typo-ul,
        .typo ul {
            margin-left: 1.3em;
            list-style: disc
        }

        .typo-ol,
        .typo ol {
            list-style: decimal;
            margin-left: 1.9em
        }

        .typo-ol ol,
        .typo-ol ul,
        .typo-ul ol,
        .typo-ul ul,
        .typo li ol,
        .typo li ul {
            margin-bottom: .8em;
            margin-left: 2em
        }

        .typo-ol ul,
        .typo-ul ul,
        .typo li ul {
            list-style: circle
        }

        .typo-table td,
        .typo-table th,
        .typo table caption,
        .typo table td,
        .typo table th {
            border: 1px solid #ddd;
            padding: .5em 1em;
            color: #666
        }

        .typo-table th,
        .typo table th {
            background: #fbfbfb
        }

        .typo-table thead th,
        .typo table thead th {
            background: hsla(0, 0%, 95%, .7)
        }

        .typo table caption {
            border-bottom: none
        }

        .typo-input,
        .typo-textarea {
            -webkit-appearance: none;
            border-radius: 0
        }

        .typo-em,
        .typo em,
        caption,
        legend {
            color: #000;
            font-weight: inherit
        }

        .typo-em {
            position: relative
        }

        .typo-em:after {
            position: absolute;
            top: .65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"
        }

        .typo img {
            max-width: 100%
        }

        .common-content {
            font-weight: 400;
            color: #353535;
            line-height: 1.75rem;
            white-space: normal;
            word-break: normal;
            font-size: 1rem
        }

        .common-content img {
            display: block;
            max-width: 100%;
            background-color: #eee
        }

        .common-content audio,
        .common-content video {
            width: 100%;
            background-color: #eee
        }

        .common-content center,
        .common-content font {
            margin-top: 1rem;
            display: inline-block
        }

        .common-content center {
            width: 100%
        }

        .common-content pre {
            margin-top: 1rem;
            padding-left: 0;
            padding-right: 0;
            position: relative;
            overflow: hidden
        }

        .common-content pre code {
            font-size: .8rem;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            width: 100%;
            box-sizing: border-box;
            padding-left: 1rem;
            padding-right: 1rem;
            overflow-x: auto
        }

        .common-content hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        .common-content b,
        .common-content h1,
        .common-content h2,
        .common-content h3,
        .common-content h4,
        .common-content h5,
        .common-content strong {
            font-weight: 700
        }

        .common-content h1,
        .common-content h2 {
            font-size: 1.125rem;
            margin-bottom: .45rem
        }

        .common-content h3,
        .common-content h4,
        .common-content h5 {
            font-size: 1rem;
            margin-bottom: .45rem
        }

        .common-content p {
            font-weight: 400;
            color: #353535;
            margin-top: .15rem
        }

        .common-content .orange {
            color: #ff5a05
        }

        .common-content .reference {
            font-size: 1rem;
            color: #888
        }

        .custom-rich-content h1 {
            margin-top: 0;
            font-weight: 400;
            font-size: 15.25px;
            border-bottom: 1px solid #eee;
            line-height: 2.8
        }

        .custom-rich-content li,
        .custom-rich-content p {
            font-size: 14px;
            color: #888;
            line-height: 1.6
        }

        table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        table.hljs-ln,
        table.hljs-ln tbody,
        table.hljs-ln td,
        table.hljs-ln tr {
            box-sizing: border-box
        }

        table.hljs-ln td {
            padding: 0;
            border: 0
        }

        table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            user-select: none
        }

        table.hljs-ln td.hljs-ln-code,
        table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            font-size: 12px;
            line-height: 20px;
            vertical-align: top
        }

        table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            color: #24292e;
            word-wrap: normal;
            white-space: pre
        }

        video::-webkit-media-controls {
            overflow: hidden !important
        }

        video::-webkit-media-controls-enclosure {
            width: calc(100% + 32px);
            margin-left: auto
        }

        ._29HP61GA_0 {
            max-width:800px;
            margin:0 auto;
            margin-bottom: 20px;
            font-weight: 400;
            color: #353535;
            line-height: 1.76;
            white-space: normal;
            word-break: normal;
            font-size: 17px;
            -webkit-transition: background-color .3s ease;
            transition: background-color .3s ease
        }

        ._29HP61GA_0 .MathJax_Display {
            overflow: auto
        }

        ._29HP61GA_0 .poster {
            position: fixed;
            left: -10000px;
            top: -10000px;
            overflow: hidden;
            padding: 1rem;
            background: #ececec
        }

        ._29HP61GA_0 .richcontent-pre-copy {
            font-size: 13px;
            color: #888;
            position: absolute;
            right: 1em;
            top: .5em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 .richcontent-pre-copy .iconfont {
            font-size: 12px;
            margin-right: .2em
        }

        ._29HP61GA_0 a {
            color: #fa8919;
            border-bottom: 1px solid #fa8919
        }

        ._29HP61GA_0 img {
            display: block;
            max-width: 100%;
            position: relative;
            left: 50%;
            -webkit-transform: translateX(-50%);
            transform: translateX(-50%);
            background-color: #eee;
            vertical-align: top;
            border-radius: 0
        }

        ._29HP61GA_0 audio,
        ._29HP61GA_0 video {
            width: 100%;
            background-color: #eee
        }

        ._29HP61GA_0 pre {
            margin-top: 16px;
            padding: 34px 0 0;
            margin-bottom: 30px;
            position: relative;
            border-radius: 6px;
            background: rgba(246, 247, 251, .749);
            border: 0
        }

        ._29HP61GA_0 pre code {
            font-size: 12px;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            margin-left: 16px;
            margin-right: 16px;
            overflow-x: scroll
        }

        ._29HP61GA_0 pre code:after {
            content: "";
            height: 30px;
            width: 100%;
            display: block
        }

        ._29HP61GA_0 hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        ._29HP61GA_0 h1,
        ._29HP61GA_0 h2,
        ._29HP61GA_0 h3,
        ._29HP61GA_0 h4,
        ._29HP61GA_0 h5 {
            margin-bottom: 20px;
            margin-top: 0;
            font-weight: 700
        }

        ._29HP61GA_0 b,
        ._29HP61GA_0 strong {
            font-weight: 700
        }

        ._29HP61GA_0 h1 {
            font-size: 21px
        }

        ._29HP61GA_0 h2 {
            font-size: 20px
        }

        ._29HP61GA_0 h3 {
            font-size: 19px
        }

        ._29HP61GA_0 h4 {
            font-size: 18px
        }

        ._29HP61GA_0 h5 {
            font-size: 17px
        }

        ._29HP61GA_0 center,
        ._29HP61GA_0 p {
            font-weight: 400;
            color: #353535;
            margin-top: 0;
            margin-bottom: 30px;
            word-break: break-word
        }

        ._29HP61GA_0 center {
            text-align: center
        }

        ._29HP61GA_0 blockquote {
            margin-top: 0;
            margin-bottom: 34px;
            border-left: 3px solid #e8e8e8;
            padding-left: 17px;
            color: #353535
        }

        ._29HP61GA_0 blockquote p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol,
        ._29HP61GA_0 ul {
            margin-bottom: 30px
        }

        ._29HP61GA_0 ol p,
        ._29HP61GA_0 ul p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol {
            list-style: decimal;
            margin-left: 20px
        }

        ._29HP61GA_0 ul li {
            padding-left: 17px;
            position: relative;
            margin-bottom: 10px
        }

        ._29HP61GA_0 ul li:after {
            content: "";
            height: 6px;
            width: 6px;
            border-radius: 50%;
            background: #353535;
            position: absolute;
            top: 10px;
            left: 0
        }

        ._29HP61GA_0 .orange {
            color: #fa8919
        }

        ._29HP61GA_0 .reference {
            color: #888
        }

        ._29HP61GA_0 .m-right {
            text-align: right
        }

        ._29HP61GA_0 .m-center {
            text-align: center;
            display: block
        }

        ._29HP61GA_0 .m-gray {
            color: #888
        }

        ._29HP61GA_0 .m-small {
            font-size: 15px
        }

        ._29HP61GA_0 table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        ._29HP61GA_0 table.hljs-ln,
        ._29HP61GA_0 table.hljs-ln tbody,
        ._29HP61GA_0 table.hljs-ln td,
        ._29HP61GA_0 table.hljs-ln tr {
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        ._29HP61GA_0 table.hljs-ln td {
            padding: 0;
            border: 0
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            font-size: 12px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code,
        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            line-height: 20px;
            vertical-align: top
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            font-size: 13px;
            color: #666;
            word-wrap: normal;
            white-space: pre
        }

    </style>
</head>
<body>
<div class="_29HP61GA_0">
<h1>03-å³å€¼å’Œç§»åŠ¨ç©¶ç«Ÿè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h1>
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚</p><p>ä»ä¸Šä¸€è®²æ™ºèƒ½æŒ‡é’ˆå¼€å§‹ï¼Œæˆ‘ä»¬å·²ç»æˆ–å¤šæˆ–å°‘æ¥è§¦äº†ç§»åŠ¨è¯­ä¹‰ã€‚æœ¬è®²æˆ‘ä»¬å°±å®Œæ•´åœ°è®¨è®ºä¸€ä¸‹ç§»åŠ¨è¯­ä¹‰å’Œç›¸å…³çš„æ¦‚å¿µã€‚ç§»åŠ¨è¯­ä¹‰æ˜¯ C++11 é‡Œå¼•å…¥çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼›ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæ˜¯ç†è§£å¾ˆå¤šç°ä»£ C++ é‡Œçš„ä¼˜åŒ–çš„åŸºç¡€ã€‚</p><h2>å€¼åˆ†å·¦å³</h2><p>æˆ‘ä»¬å¸¸å¸¸ä¼šè¯´ï¼ŒC++ é‡Œæœ‰å·¦å€¼å’Œå³å€¼ã€‚è¿™è¯ä¸å®Œå…¨å¯¹ã€‚æ ‡å‡†é‡Œçš„å®šä¹‰å®é™…æ›´å¤æ‚ï¼Œè§„å®šäº†ä¸‹é¢è¿™äº›å€¼ç±»åˆ«ï¼ˆvalue categoriesï¼‰ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/18/3c/18b692072537d4ce179d3857a8a0133c.png" alt=""></p><p>æˆ‘ä»¬å…ˆç†è§£ä¸€ä¸‹è¿™äº›åè¯çš„å­—é¢å«ä¹‰ï¼š</p><ul>
<li>ä¸€ä¸ª lvalue æ˜¯é€šå¸¸å¯ä»¥æ”¾åœ¨ç­‰å·å·¦è¾¹çš„è¡¨è¾¾å¼ï¼Œå·¦å€¼</li>
<li>ä¸€ä¸ª rvalue æ˜¯é€šå¸¸åªèƒ½æ”¾åœ¨ç­‰å·å³è¾¹çš„è¡¨è¾¾å¼ï¼Œå³å€¼</li>
<li>ä¸€ä¸ª glvalue æ˜¯ generalized lvalueï¼Œå¹¿ä¹‰å·¦å€¼</li>
<li>ä¸€ä¸ª xvalue æ˜¯ expiring lvalueï¼Œå°†äº¡å€¼</li>
<li>ä¸€ä¸ª prvalue æ˜¯ pure rvalueï¼Œçº¯å³å€¼</li>
</ul><p>è¿˜æ˜¯æœ‰ç‚¹æ™•ï¼Œæ˜¯å§ï¼Ÿæˆ‘ä»¬æš‚ä¸”æŠ›å¼€è¿™äº›æ¦‚å¿µï¼Œåªçœ‹å…¶ä¸­ä¸¤ä¸ªï¼šlvalue å’Œ prvalueã€‚</p><p>å·¦å€¼ lvalue æ˜¯æœ‰æ ‡è¯†ç¬¦ã€å¯ä»¥å–åœ°å€çš„è¡¨è¾¾å¼ï¼Œæœ€å¸¸è§çš„æƒ…å†µæœ‰ï¼š</p><ul>
<li>å˜é‡ã€å‡½æ•°æˆ–æ•°æ®æˆå‘˜çš„åå­—</li>
<li>è¿”å›å·¦å€¼å¼•ç”¨çš„è¡¨è¾¾å¼ï¼Œå¦‚ <code>++x</code>ã€<code>x = 1</code>ã€<code>cout &lt;&lt; ' '</code></li>
<li>å­—ç¬¦ä¸²å­—é¢é‡å¦‚ <code>"hello world"</code></li>
</ul><p>åœ¨å‡½æ•°è°ƒç”¨æ—¶ï¼Œå·¦å€¼å¯ä»¥ç»‘å®šåˆ°å·¦å€¼å¼•ç”¨çš„å‚æ•°ï¼Œå¦‚ <code>T&amp;</code>ã€‚ä¸€ä¸ªå¸¸é‡åªèƒ½ç»‘å®šåˆ°å¸¸å·¦å€¼å¼•ç”¨ï¼Œå¦‚ <code>const T&amp;</code>ã€‚</p><!-- [[[read_end]]] --><p>åä¹‹ï¼Œçº¯å³å€¼ prvalue æ˜¯æ²¡æœ‰æ ‡è¯†ç¬¦ã€ä¸å¯ä»¥å–åœ°å€çš„è¡¨è¾¾å¼ï¼Œä¸€èˆ¬ä¹Ÿç§°ä¹‹ä¸ºâ€œä¸´æ—¶å¯¹è±¡â€ã€‚æœ€å¸¸è§çš„æƒ…å†µæœ‰ï¼š</p><ul>
<li>è¿”å›éå¼•ç”¨ç±»å‹çš„è¡¨è¾¾å¼ï¼Œå¦‚ <code>x++</code>ã€<code>x + 1</code>ã€<code>make_shared&lt;int&gt;(42)</code></li>
<li>é™¤å­—ç¬¦ä¸²å­—é¢é‡ä¹‹å¤–çš„å­—é¢é‡ï¼Œå¦‚ <code>42</code>ã€<code>true</code></li>
</ul><p>åœ¨ C++11 ä¹‹å‰ï¼Œå³å€¼å¯ä»¥ç»‘å®šåˆ°å¸¸å·¦å€¼å¼•ç”¨ï¼ˆconst lvalue referenceï¼‰çš„å‚æ•°ï¼Œå¦‚ <code>const T&amp;</code>ï¼Œä½†ä¸å¯ä»¥ç»‘å®šåˆ°éå¸¸å·¦å€¼å¼•ç”¨ï¼ˆnon-const lvalue referenceï¼‰ï¼Œå¦‚ <code>T&amp;</code>ã€‚ä» C++11 å¼€å§‹ï¼ŒC++ è¯­è¨€é‡Œå¤šäº†ä¸€ç§å¼•ç”¨ç±»å‹â€”â€”å³å€¼å¼•ç”¨ã€‚å³å€¼å¼•ç”¨çš„å½¢å¼æ˜¯ <code>T&amp;&amp;</code>ï¼Œæ¯”å·¦å€¼å¼•ç”¨å¤šä¸€ä¸ª <code>&amp;</code> ç¬¦å·ã€‚è·Ÿå·¦å€¼å¼•ç”¨ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>const</code> å’Œ <code>volatile</code> æ¥è¿›è¡Œä¿®é¥°ï¼Œä½†æœ€å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œæˆ‘ä»¬ä¸ä¼šç”¨ <code>const</code> å’Œ <code>volatile</code> æ¥ä¿®é¥°å³å€¼ã€‚æœ¬ä¸“æ å°±å±äºè¿™ç§æƒ…å†µã€‚</p><p>å¼•å…¥ä¸€ç§é¢å¤–çš„å¼•ç”¨ç±»å‹å½“ç„¶å¢åŠ äº†è¯­è¨€çš„å¤æ‚æ€§ï¼Œä½†ä¹Ÿå¸¦æ¥äº†å¾ˆå¤šä¼˜åŒ–çš„å¯èƒ½æ€§ã€‚ç”±äº C++ æœ‰é‡è½½ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ä¸åŒçš„å¼•ç”¨ç±»å‹ï¼Œæ¥é€‰æ‹©ä¸åŒçš„é‡è½½å‡½æ•°ï¼Œæ¥å®Œæˆä¸åŒçš„è¡Œä¸ºã€‚å›æƒ³ä¸€ä¸‹ï¼Œåœ¨ä¸Šä¸€è®²ä¸­ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨äº†é‡è½½ï¼Œè®© <code>smart_ptr</code> çš„æ„é€ å‡½æ•°å¯ä»¥æœ‰ä¸åŒçš„è¡Œä¸ºï¼š</p><pre><code class="language-c++">template &lt;typename U&gt;
smart_ptr(const smart_ptr&lt;U&gt;&amp; other) noexcept
{
  ptr_ = other.ptr_;
  if (ptr_) {
    other.shared_count_-&gt;add_count();
    shared_count_ =
      other.shared_count_;
  }
}
template &lt;typename U&gt;
smart_ptr(smart_ptr&lt;U&gt;&amp;&amp; other) noexcept
{
  ptr_ = other.ptr_;
  if (ptr_) {
    shared_count_ =
      other.shared_count_;
    other.ptr_ = nullptr;
  }
}
</code></pre><p>ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼Œä½¿ç”¨å³å€¼å¼•ç”¨çš„ç¬¬äºŒä¸ªé‡è½½å‡½æ•°ä¸­çš„å˜é‡ <code>other</code> ç®—æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼å‘¢ï¼Ÿæ ¹æ®å®šä¹‰ï¼Œ<code>other</code> æ˜¯ä¸ªå˜é‡çš„åå­—ï¼Œå˜é‡æœ‰æ ‡è¯†ç¬¦ã€æœ‰åœ°å€ï¼Œæ‰€ä»¥å®ƒè¿˜æ˜¯ä¸€ä¸ªå·¦å€¼â€”â€”è™½ç„¶å®ƒçš„ç±»å‹æ˜¯å³å€¼å¼•ç”¨ã€‚</p><p>å°¤å…¶é‡è¦çš„æ˜¯ï¼Œæ‹¿è¿™ä¸ª <code>other</code> å»è°ƒç”¨å‡½æ•°æ—¶ï¼Œå®ƒåŒ¹é…çš„ä¹Ÿä¼šæ˜¯å·¦å€¼å¼•ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>ç±»å‹æ˜¯å³å€¼å¼•ç”¨çš„å˜é‡æ˜¯ä¸€ä¸ªå·¦å€¼ï¼</strong>è¿™ç‚¹å¯èƒ½æœ‰ç‚¹åç›´è§‰ï¼Œä½†è·Ÿ C++ çš„å…¶ä»–æ–¹é¢æ˜¯ä¸€è‡´çš„ã€‚æ¯•ç«Ÿå¯¹äºä¸€ä¸ªå³å€¼å¼•ç”¨çš„å˜é‡ï¼Œä½ æ˜¯å¯ä»¥å–åœ°å€çš„ï¼Œè¿™ç‚¹ä¸Šå®ƒå’Œå·¦å€¼å®Œå…¨ä¸€è‡´ã€‚ç¨åæˆ‘ä»¬å†å›åˆ°è¿™ä¸ªè¯é¢˜ä¸Šæ¥ã€‚</p><p>å†çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä»£ç ï¼š</p><pre><code class="language-c++">smart_ptr&lt;shape&gt; ptr1{new circle()};
smart_ptr&lt;shape&gt; ptr2 = std::move(ptr1);
</code></pre><p>ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼é‡Œçš„ <code>new circle()</code> å°±æ˜¯ä¸€ä¸ªçº¯å³å€¼ï¼›ä½†å¯¹äºæŒ‡é’ˆï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨å€¼ä¼ é€’ï¼Œå¹¶ä¸å…³å¿ƒå®ƒæ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ã€‚</p><p>ç¬¬äºŒä¸ªè¡¨è¾¾å¼é‡Œçš„ <code>std::move(ptr)</code> å°±æœ‰è¶£ç‚¹äº†ã€‚å®ƒçš„ä½œç”¨æ˜¯æŠŠä¸€ä¸ªå·¦å€¼å¼•ç”¨å¼ºåˆ¶è½¬æ¢æˆä¸€ä¸ªå³å€¼å¼•ç”¨ï¼Œè€Œå¹¶ä¸æ”¹å˜å…¶å†…å®¹ã€‚ä»å®ç”¨çš„è§’åº¦ï¼Œåœ¨æˆ‘ä»¬è¿™å„¿ <code>std::move(ptr1)</code> ç­‰ä»·äº <code>static_cast&lt;smart_ptr&lt;shape&gt;&amp;&amp;&gt;(ptr1)</code>ã€‚å› æ­¤ï¼Œ<code>std::move(ptr1)</code> çš„ç»“æœæ˜¯æŒ‡å‘ <code>ptr1</code> çš„ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼Œè¿™æ ·æ„é€  <code>ptr2</code> æ—¶å°±ä¼šé€‰æ‹©ä¸Šé¢ç¬¬äºŒä¸ªé‡è½½ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠ <code>std::move(ptr1)</code> çœ‹ä½œæ˜¯ä¸€ä¸ªæœ‰åå­—çš„å³å€¼ã€‚ä¸ºäº†è·Ÿæ— åçš„çº¯å³å€¼ prvalue ç›¸åŒºåˆ«ï¼ŒC++ é‡Œç›®å‰å°±æŠŠè¿™ç§è¡¨è¾¾å¼å«åš xvalueã€‚è·Ÿå·¦å€¼ lvalue ä¸åŒï¼Œxvalue ä»ç„¶æ˜¯ä¸èƒ½å–åœ°å€çš„â€”â€”è¿™ç‚¹ä¸Šï¼Œxvalue å’Œ prvalue ç›¸åŒã€‚æ‰€ä»¥ï¼Œxvalue å’Œ prvalue éƒ½è¢«å½’ä¸ºå³å€¼ rvalueã€‚æˆ‘ä»¬ç”¨ä¸‹é¢çš„å›¾æ¥è¡¨ç¤ºä¼šæ›´æ¸…æ¥šä¸€ç‚¹ï¼š</p><p><img src="https://static001.geekbang.org/resource/image/03/5a/036cc6865a9623a48918b504e408945a.png" alt=""></p><p>å¦å¤–è¯·æ³¨æ„ï¼Œâ€œå€¼ç±»åˆ«â€ï¼ˆvalue categoryï¼‰å’Œâ€œå€¼ç±»å‹â€ï¼ˆvalue typeï¼‰æ˜¯ä¸¤ä¸ªçœ‹ä¼¼ç›¸ä¼¼ã€å´æ¯«ä¸ç›¸å¹²çš„æœ¯è¯­ã€‚å‰è€…æŒ‡çš„æ˜¯ä¸Šé¢è¿™äº›å·¦å€¼ã€å³å€¼ç›¸å…³çš„æ¦‚å¿µï¼Œåè€…åˆ™æ˜¯ä¸å¼•ç”¨ç±»å‹ï¼ˆreference typeï¼‰ç›¸å¯¹è€Œè¨€ï¼Œè¡¨æ˜ä¸€ä¸ªå˜é‡æ˜¯ä»£è¡¨å®é™…æ•°å€¼ï¼Œè¿˜æ˜¯å¼•ç”¨å¦å¤–ä¸€ä¸ªæ•°å€¼ã€‚åœ¨ C++ é‡Œï¼Œæ‰€æœ‰çš„åŸç”Ÿç±»å‹ã€æšä¸¾ã€ç»“æ„ã€è”åˆã€ç±»éƒ½ä»£è¡¨å€¼ç±»å‹ï¼Œåªæœ‰å¼•ç”¨ï¼ˆ<code>&amp;</code>ï¼‰å’ŒæŒ‡é’ˆï¼ˆ<code>*</code>ï¼‰æ‰æ˜¯å¼•ç”¨ç±»å‹ã€‚åœ¨ Java é‡Œï¼Œæ•°å­—ç­‰åŸç”Ÿç±»å‹æ˜¯å€¼ç±»å‹ï¼Œç±»åˆ™å±äºå¼•ç”¨ç±»å‹ã€‚åœ¨ Python é‡Œï¼Œä¸€åˆ‡ç±»å‹éƒ½æ˜¯å¼•ç”¨ç±»å‹ã€‚</p><h2>ç”Ÿå‘½å‘¨æœŸå’Œè¡¨è¾¾å¼ç±»å‹</h2><p>ä¸€ä¸ªå˜é‡çš„ç”Ÿå‘½å‘¨æœŸåœ¨è¶…å‡ºä½œç”¨åŸŸæ—¶ç»“æŸã€‚å¦‚æœä¸€ä¸ªå˜é‡ä»£è¡¨ä¸€ä¸ªå¯¹è±¡ï¼Œå½“ç„¶è¿™ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿåœ¨é‚£æ—¶ç»“æŸã€‚é‚£ä¸´æ—¶å¯¹è±¡ï¼ˆprvalueï¼‰å‘¢ï¼Ÿåœ¨è¿™å„¿ï¼ŒC++ çš„è§„åˆ™æ˜¯ï¼šä¸€ä¸ªä¸´æ—¶å¯¹è±¡ä¼šåœ¨åŒ…å«è¿™ä¸ªä¸´æ—¶å¯¹è±¡çš„å®Œæ•´è¡¨è¾¾å¼ä¼°å€¼å®Œæˆåã€æŒ‰ç”Ÿæˆé¡ºåºçš„é€†åºè¢«é”€æ¯ï¼Œé™¤éæœ‰ç”Ÿå‘½å‘¨æœŸå»¶é•¿å‘ç”Ÿã€‚æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸå»¶é•¿çš„åŸºæœ¬æƒ…å†µï¼š</p><pre><code class="language-c++">process_shape(circle(), triangle());
</code></pre><p>åœ¨è¿™å„¿ï¼Œæˆ‘ä»¬ç”Ÿæˆäº†ä¸´æ—¶å¯¹è±¡ï¼Œä¸€ä¸ªåœ†å’Œä¸€ä¸ªä¸‰è§’å½¢ï¼Œå®ƒä»¬ä¼šåœ¨ <code>process_shape</code> æ‰§è¡Œå®Œæˆå¹¶ç”Ÿæˆç»“æœå¯¹è±¡åè¢«é”€æ¯ã€‚</p><p>æˆ‘ä»¬æ’å…¥ä¸€äº›å®é™…çš„ä»£ç ï¼Œå°±å¯ä»¥æ¼”ç¤ºè¿™ä¸€è¡Œä¸ºï¼š</p><pre><code class="language-c++">#include &lt;stdio.h&gt;

class shape {
public:
  virtual ~shape() {}
};

class circle : public shape {
public:
  circle() { puts("circle()"); }
  ~circle() { puts("~circle()"); }
};

class triangle : public shape {
public:
  triangle() { puts("triangle()"); }
  ~triangle() { puts("~triangle()"); }
};

class result {
public:
  result() { puts("result()"); }
  ~result() { puts("~result()"); }
};

result
process_shape(const shape&amp; shape1,
              const shape&amp; shape2)
{
  puts("process_shape()");
  return result();
}

int main()
{
  puts("main()");
  process_shape(circle(), triangle());
  puts("something else");
}
</code></pre><p>è¾“å‡ºç»“æœå¯èƒ½ä¼šæ˜¯ï¼ˆ<code>circle</code> å’Œ <code>triangle</code> çš„é¡ºåºåœ¨æ ‡å‡†ä¸­æ²¡æœ‰è§„å®šï¼‰ï¼š</p><blockquote>
<p><code>main()</code><br>
<code>circle()</code><br>
<code>triangle()</code><br>
<code>process_shape()</code><br>
<code>result()</code><br>
<code>~result()</code><br>
<code>~triangle()</code><br>
<code>~circle()</code><br>
<code>something else</code></p>
</blockquote><p>ç›®å‰æˆ‘è®© <code>process_shape</code> ä¹Ÿè¿”å›äº†ä¸€ä¸ªç»“æœï¼Œè¿™æ˜¯ä¸ºäº†ä¸‹ä¸€æ­¥æ¼”ç¤ºçš„éœ€è¦ã€‚ä½ å¯ä»¥çœ‹åˆ°ç»“æœçš„ä¸´æ—¶å¯¹è±¡æœ€åç”Ÿæˆã€æœ€å…ˆææ„ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿å¯¹ä¸´æ—¶å¯¹è±¡çš„ä½¿ç”¨ï¼ŒC++ å¯¹ä¸´æ—¶å¯¹è±¡æœ‰ç‰¹æ®Šçš„ç”Ÿå‘½å‘¨æœŸå»¶é•¿è§„åˆ™ã€‚è¿™æ¡è§„åˆ™æ˜¯ï¼š</p><blockquote>
<p>å¦‚æœä¸€ä¸ª prvalue è¢«ç»‘å®šåˆ°ä¸€ä¸ªå¼•ç”¨ä¸Šï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸåˆ™ä¼šå»¶é•¿åˆ°è·Ÿè¿™ä¸ªå¼•ç”¨å˜é‡ä¸€æ ·é•¿ã€‚</p>
</blockquote><p>æˆ‘ä»¬å¯¹ä¸Šé¢çš„ä»£ç åªè¦æ”¹ä¸€è¡Œå°±èƒ½æ¼”ç¤ºè¿™ä¸ªæ•ˆæœã€‚æŠŠ <code>process_shape</code> é‚£è¡Œæ”¹æˆï¼š</p><pre><code class="language-c++">result&amp;&amp; r = process_shape(
  circle(), triangle());
</code></pre><p>æˆ‘ä»¬å°±èƒ½çœ‹åˆ°ä¸åŒçš„ç»“æœäº†ï¼š</p><blockquote>
<p><code>main()</code><br>
<code>circle()</code><br>
<code>triangle()</code><br>
<code>process_shape()</code><br>
<code>result()</code><br>
<code>~triangle()</code><br>
<code>~circle()</code><br>
<code>something else</code><br>
<code>~result()</code></p>
</blockquote><p>ç°åœ¨ <code>result</code> çš„ç”Ÿæˆè¿˜åœ¨åŸæ¥çš„ä½ç½®ï¼Œä½†ææ„è¢«å»¶åˆ°äº† <code>main</code> çš„æœ€åã€‚</p><p>éœ€è¦ä¸‡åˆ†æ³¨æ„çš„æ˜¯ï¼Œè¿™æ¡ç”Ÿå‘½æœŸå»¶é•¿è§„åˆ™åªå¯¹ prvalue æœ‰æ•ˆï¼Œè€Œå¯¹ xvalue æ— æ•ˆã€‚å¦‚æœç”±äºæŸç§åŸå› ï¼Œprvalue åœ¨ç»‘å®šåˆ°å¼•ç”¨ä»¥å‰å·²ç»å˜æˆäº† xvalueï¼Œé‚£ç”Ÿå‘½æœŸå°±ä¸ä¼šå»¶é•¿ã€‚ä¸æ³¨æ„è¿™ç‚¹çš„è¯ï¼Œä»£ç å°±å¯èƒ½ä¼šäº§ç”Ÿéšç§˜çš„ bugã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¦‚æœè¿™æ ·æ”¹ä¸€ä¸‹ä»£ç ï¼Œç»“æœå°±ä¸å¯¹äº†ï¼š</p><pre><code class="language-c++">#include &lt;utility&gt;  // std::move
â€¦
result&amp;&amp; r = std::move(process_shape(
  circle(), triangle()));
</code></pre><p>è¿™æ—¶çš„ä»£ç è¾“å‡ºå°±å›åˆ°äº†å‰ä¸€ç§æƒ…å†µã€‚è™½ç„¶æ‰§è¡Œåˆ° something else é‚£å„¿æˆ‘ä»¬ä»ç„¶æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„å˜é‡ <code>r</code>ï¼Œä½†å®ƒæŒ‡å‘çš„å¯¹è±¡å·²ç»ä¸å­˜åœ¨äº†ï¼Œå¯¹ <code>r</code> çš„è§£å¼•ç”¨æ˜¯ä¸€ä¸ªæœªå®šä¹‰è¡Œä¸ºã€‚ç”±äº <code>r</code> æŒ‡å‘çš„æ˜¯æ ˆç©ºé—´ï¼Œé€šå¸¸ä¸ä¼šç«‹å³å¯¼è‡´ç¨‹åºå´©æºƒï¼Œè€Œä¼šåœ¨æŸäº›å¤æ‚çš„ç»„åˆæ¡ä»¶ä¸‹æ‰ä¼šå¼•è‡´é—®é¢˜â€¦â€¦</p><p>å¯¹ C++ çš„è¿™æ¡ç”Ÿå‘½æœŸå»¶é•¿è§„åˆ™ï¼Œåœ¨åé¢è®²åˆ°è§†å›¾ï¼ˆviewï¼‰çš„æ—¶å€™ä¼šååˆ†æœ‰ç”¨ã€‚é‚£æ—¶æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œæœ‰äº› C++ çš„ç”¨æ³•å®é™…ä¸Šä¼šéšå¼åœ°åˆ©ç”¨è¿™æ¡è§„åˆ™ã€‚</p><p>æ­¤å¤–ï¼Œå‚è€ƒèµ„æ–™ <span class="orange">[5]</span> ä¸­æåˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„äº‹å®ï¼šä½ å¯ä»¥æŠŠä¸€ä¸ªæ²¡æœ‰è™šææ„å‡½æ•°çš„å­ç±»å¯¹è±¡ç»‘å®šåˆ°åŸºç±»çš„å¼•ç”¨å˜é‡ä¸Šï¼Œè¿™ä¸ªå­ç±»å¯¹è±¡çš„ææ„ä»ç„¶æ˜¯å®Œå…¨æ­£å¸¸çš„â€”â€”è¿™æ˜¯å› ä¸ºè¿™æ¡è§„åˆ™åªæ˜¯å»¶åäº†ä¸´æ—¶å¯¹è±¡çš„ææ„è€Œå·²ï¼Œä¸æ˜¯åˆ©ç”¨å¼•ç”¨è®¡æ•°ç­‰å¤æ‚çš„æ–¹æ³•ï¼Œå› è€Œåªè¦å¼•ç”¨ç»‘å®šæˆåŠŸï¼Œå…¶ç±»å‹å¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“ã€‚</p><h2>ç§»åŠ¨çš„æ„ä¹‰</h2><p>ä¸Šé¢æˆ‘ä»¬è°ˆäº†ä¸€äº›è¯­æ³•çŸ¥è¯†ã€‚å°±è·Ÿå­¦å¤–è¯­çš„è¯­æ³•ä¸€æ ·ï¼Œè¿™äº›å†…å®¹æ˜¯æ¯”è¾ƒæ¯ç‡¥çš„ã€‚è™½ç„¶è¿™äº›çŸ¥è¯†æœ‰æ—¶æœ‰ç”¨ï¼Œä½†å¾€å¾€è¦å›è¿‡å¤´æ¥çœ‹çš„æ—¶å€™æ‰è§‰å¾—ã€‚åˆå­¦ä¹‹æ—¶ï¼Œæ›´é‡è¦çš„æ˜¯ç†è§£ä¸ºä»€ä¹ˆï¼Œå’Œç†Ÿç»ƒæŒæ¡åŸºæœ¬çš„ç”¨æ³•ã€‚</p><p>å¯¹äº <code>smart_ptr</code>ï¼Œæˆ‘ä»¬ä½¿ç”¨å³å€¼å¼•ç”¨çš„ç›®çš„æ˜¯å®ç°ç§»åŠ¨ï¼Œè€Œå®ç°ç§»åŠ¨çš„æ„ä¹‰æ˜¯å‡å°‘è¿è¡Œçš„å¼€é”€â€”â€”åœ¨å¼•ç”¨è®¡æ•°æŒ‡é’ˆçš„åœºæ™¯ä¸‹ï¼Œè¿™ä¸ªå¼€é”€å¹¶ä¸å¤§ã€‚ç§»åŠ¨æ„é€ å’Œæ‹·è´æ„é€ çš„å·®å¼‚ä»…åœ¨äºï¼š</p><ul>
<li>å°‘äº†ä¸€æ¬¡ <code>other.shared_count_-&gt;add_count()</code> çš„è°ƒç”¨</li>
<li>è¢«ç§»åŠ¨çš„æŒ‡é’ˆè¢«æ¸…ç©ºï¼Œå› è€Œææ„æ—¶ä¹Ÿå°‘äº†ä¸€æ¬¡ <code>shared_count_-&gt;reduce_count()</code> çš„è°ƒç”¨</li>
</ul><p>åœ¨ä½¿ç”¨å®¹å™¨ç±»çš„æƒ…å†µä¸‹ï¼Œç§»åŠ¨æ›´æœ‰æ„ä¹‰ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•åˆ†æä¸€ä¸‹ä¸‹é¢è¿™ä¸ªå‡æƒ³çš„è¯­å¥ï¼ˆå‡è®¾ <code>name</code> æ˜¯ <code>string</code> ç±»å‹ï¼‰ï¼š</p><pre><code class="language-c++">string result =
  string("Hello, ") + name + ".";
</code></pre><p>åœ¨ C++11 ä¹‹å‰çš„å¹´ä»£é‡Œï¼Œè¿™ç§å†™æ³•æ˜¯ç»å¯¹ä¸æ¨èçš„ã€‚å› ä¸ºå®ƒä¼šå¼•å…¥å¾ˆå¤šé¢å¤–å¼€é”€ï¼Œæ‰§è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><ol>
<li>è°ƒç”¨æ„é€ å‡½æ•° <code>string(const char*)</code>ï¼Œç”Ÿæˆä¸´æ—¶å¯¹è±¡ 1ï¼›<code>"Hello, "</code> å¤åˆ¶ 1 æ¬¡ã€‚</li>
<li>è°ƒç”¨ <code>operator+(const string&amp;, const string&amp;)</code>ï¼Œç”Ÿæˆä¸´æ—¶å¯¹è±¡ 2ï¼›<code>"Hello, "</code> å¤åˆ¶ 2 æ¬¡ï¼Œ<code>name</code> å¤åˆ¶ 1 æ¬¡ã€‚</li>
<li>è°ƒç”¨ <code>operator+(const string&amp;, const char*)</code>ï¼Œç”Ÿæˆå¯¹è±¡ 3ï¼›<code>"Hello, "</code> å¤åˆ¶ 3 æ¬¡ï¼Œ<code>name</code> å¤åˆ¶ 2 æ¬¡ï¼Œ<code>"."</code> å¤åˆ¶ 1 æ¬¡ã€‚</li>
<li>å‡è®¾è¿”å›å€¼ä¼˜åŒ–èƒ½å¤Ÿç”Ÿæ•ˆï¼ˆæœ€ä½³æƒ…å†µï¼‰ï¼Œå¯¹è±¡ 3 å¯ä»¥ç›´æ¥åœ¨ <code>result</code> é‡Œæ„é€ å®Œæˆã€‚</li>
<li>ä¸´æ—¶å¯¹è±¡ 2 ææ„ï¼Œé‡Šæ”¾æŒ‡å‘ <code>string("Hello, ") + name</code> çš„å†…å­˜ã€‚</li>
<li>ä¸´æ—¶å¯¹è±¡ 1 ææ„ï¼Œé‡Šæ”¾æŒ‡å‘ <code>string("Hello, ")</code> çš„å†…å­˜ã€‚</li>
</ol><p>æ—¢ç„¶ C++ æ˜¯ä¸€é—¨è¿½æ±‚æ€§èƒ½çš„è¯­è¨€ï¼Œä¸€ä¸ªåˆæ ¼çš„ C++ ç¨‹åºå‘˜ä¼šå†™ï¼š</p><pre><code class="language-c++">string result = "Hello, ";
result += name;
result += ".";
</code></pre><p>è¿™æ ·çš„è¯ï¼Œåªä¼šè°ƒç”¨æ„é€ å‡½æ•°ä¸€æ¬¡å’Œ <code>string::operator+=</code> ä¸¤æ¬¡ï¼Œæ²¡æœ‰ä»»ä½•ä¸´æ—¶å¯¹è±¡éœ€è¦ç”Ÿæˆå’Œææ„ï¼Œæ‰€æœ‰çš„å­—ç¬¦ä¸²éƒ½åªå¤åˆ¶äº†ä¸€æ¬¡ã€‚ä½†æ˜¾ç„¶ä»£ç å°±å•°å—¦å¤šäº†â€”â€”å°¤å…¶å¦‚æœæ‹¼æ¥çš„æ­¥éª¤æ¯”è¾ƒå¤šçš„è¯ã€‚ä» C++11 å¼€å§‹ï¼Œè¿™ä¸å†æ˜¯å¿…é¡»çš„ã€‚åŒæ ·ä¸Šé¢é‚£ä¸ªå•è¡Œçš„è¯­å¥ï¼Œæ‰§è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><ol>
<li>è°ƒç”¨æ„é€ å‡½æ•° <code>string(const char*)</code>ï¼Œç”Ÿæˆä¸´æ—¶å¯¹è±¡ 1ï¼›<code>"Hello, "</code> å¤åˆ¶ 1 æ¬¡ã€‚</li>
<li>è°ƒç”¨ <code>operator+(string&amp;&amp;, const string&amp;)</code>ï¼Œç›´æ¥åœ¨ä¸´æ—¶å¯¹è±¡ 1 ä¸Šé¢æ‰§è¡Œè¿½åŠ æ“ä½œï¼Œå¹¶æŠŠç»“æœç§»åŠ¨åˆ°ä¸´æ—¶å¯¹è±¡ 2ï¼›<code>name</code> å¤åˆ¶ 1 æ¬¡ã€‚</li>
<li>è°ƒç”¨ <code>operator+(string&amp;&amp;, const char*)</code>ï¼Œç›´æ¥åœ¨ä¸´æ—¶å¯¹è±¡ 2 ä¸Šé¢æ‰§è¡Œè¿½åŠ æ“ä½œï¼Œå¹¶æŠŠç»“æœç§»åŠ¨åˆ° <code>result</code>ï¼›<code>"."</code> å¤åˆ¶ 1 æ¬¡ã€‚</li>
<li>ä¸´æ—¶å¯¹è±¡ 2 ææ„ï¼Œå†…å®¹å·²ç»ä¸ºç©ºï¼Œä¸éœ€è¦é‡Šæ”¾ä»»ä½•å†…å­˜ã€‚</li>
<li>ä¸´æ—¶å¯¹è±¡ 1 ææ„ï¼Œå†…å®¹å·²ç»ä¸ºç©ºï¼Œä¸éœ€è¦é‡Šæ”¾ä»»ä½•å†…å­˜ã€‚</li>
</ol><p>æ€§èƒ½ä¸Šï¼Œæ‰€æœ‰çš„å­—ç¬¦ä¸²åªå¤åˆ¶äº†ä¸€æ¬¡ï¼›è™½ç„¶æ¯”å•°å—¦çš„å†™æ³•ä»ç„¶è¦å¢åŠ ä¸´æ—¶å¯¹è±¡çš„æ„é€ å’Œææ„ï¼Œä½†ç”±äºè¿™äº›æ“ä½œä¸ç‰µæ¶‰åˆ°é¢å¤–çš„å†…å­˜åˆ†é…å’Œé‡Šæ”¾ï¼Œæ˜¯ç›¸å½“å»‰ä»·çš„ã€‚ç¨‹åºå‘˜åªéœ€è¦ç‰ºç‰²ä¸€ç‚¹ç‚¹æ€§èƒ½ï¼Œå°±å¯ä»¥å¤§å¤§å¢åŠ ä»£ç çš„å¯è¯»æ€§ã€‚è€Œä¸”ï¼Œæ‰€è°“çš„æ€§èƒ½ç‰ºç‰²ï¼Œä¹Ÿåªæ˜¯ç›¸å¯¹äºä¼˜åŒ–å¾—å¾ˆå¥½çš„ C æˆ– C++ ä»£ç è€Œè¨€â€”â€”è¿™æ ·çš„ C++ ä»£ç çš„æ€§èƒ½ä»ç„¶å®Œå…¨å¯ä»¥è¶…è¶Š Python ç±»çš„è¯­è¨€çš„ç›¸åº”ä»£ç ã€‚</p><p>æ­¤å¤–å¾ˆå…³é”®çš„ä¸€ç‚¹æ˜¯ï¼ŒC++ é‡Œçš„å¯¹è±¡ç¼ºçœéƒ½æ˜¯å€¼è¯­ä¹‰ã€‚åœ¨ä¸‹é¢è¿™æ ·çš„ä»£ç é‡Œï¼š</p><pre><code class="language-c++">class A {
  B b_;
  C c_;
};
</code></pre><p>ä»å®é™…å†…å­˜å¸ƒå±€çš„è§’åº¦ï¼Œå¾ˆå¤šè¯­è¨€â€”â€”å¦‚ Java å’Œ Pythonâ€”â€”ä¼šåœ¨ <code>A</code> å¯¹è±¡é‡Œæ”¾ <code>B</code> å’Œ <code>C</code> çš„æŒ‡é’ˆï¼ˆè™½ç„¶è¿™äº›è¯­è¨€é‡Œæœ¬èº«æ²¡æœ‰æŒ‡é’ˆçš„æ¦‚å¿µï¼‰ã€‚è€Œ C++ åˆ™ä¼šç›´æ¥æŠŠ <code>B</code> å’Œ <code>C</code> å¯¹è±¡æ”¾åœ¨ <code>A</code> çš„å†…å­˜ç©ºé—´é‡Œã€‚è¿™ç§è¡Œä¸ºæ—¢æ˜¯ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹ã€‚è¯´å®ƒæ˜¯ä¼˜ç‚¹ï¼Œæ˜¯å› ä¸ºå®ƒä¿è¯äº†å†…å­˜è®¿é—®çš„å±€åŸŸæ€§ï¼Œè€Œå±€åŸŸæ€§åœ¨ç°ä»£å¤„ç†å™¨æ¶æ„ä¸Šæ˜¯ç»å¯¹å…·æœ‰æ€§èƒ½ä¼˜åŠ¿çš„ã€‚è¯´å®ƒæ˜¯ç¼ºç‚¹ï¼Œæ˜¯å› ä¸ºå¤åˆ¶å¯¹è±¡çš„å¼€é”€å¤§å¤§å¢åŠ ï¼šåœ¨ Java ç±»è¯­è¨€é‡Œå¤åˆ¶çš„æ˜¯æŒ‡é’ˆï¼Œåœ¨ C++ é‡Œæ˜¯å®Œæ•´çš„å¯¹è±¡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ C++ éœ€è¦ç§»åŠ¨è¯­ä¹‰è¿™ä¸€ä¼˜åŒ–ï¼Œè€Œ Java ç±»è¯­è¨€é‡Œåˆ™æ ¹æœ¬ä¸éœ€è¦è¿™ä¸ªæ¦‚å¿µã€‚</p><p>ä¸€å¥è¯æ€»ç»“ï¼Œç§»åŠ¨è¯­ä¹‰ä½¿å¾—åœ¨ C++ é‡Œè¿”å›å¤§å¯¹è±¡ï¼ˆå¦‚å®¹å™¨ï¼‰çš„å‡½æ•°å’Œè¿ç®—ç¬¦æˆä¸ºç°å®ï¼Œå› è€Œå¯ä»¥æé«˜ä»£ç çš„ç®€æ´æ€§å’Œå¯è¯»æ€§ï¼Œæé«˜ç¨‹åºå‘˜çš„ç”Ÿäº§ç‡ã€‚</p><p>æ‰€æœ‰çš„ç°ä»£ C++ çš„æ ‡å‡†å®¹å™¨éƒ½é’ˆå¯¹ç§»åŠ¨è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p><h2>å¦‚ä½•å®ç°ç§»åŠ¨ï¼Ÿ</h2><p>è¦è®©ä½ è®¾è®¡çš„å¯¹è±¡æ”¯æŒç§»åŠ¨çš„è¯ï¼Œé€šå¸¸éœ€è¦ä¸‹é¢å‡ æ­¥ï¼š</p><ul>
<li>ä½ çš„å¯¹è±¡åº”è¯¥æœ‰åˆ†å¼€çš„æ‹·è´æ„é€ å’Œç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆé™¤éä½ åªæ‰“ç®—æ”¯æŒç§»åŠ¨ï¼Œä¸æ”¯æŒæ‹·è´â€”â€”å¦‚ <code>unique_ptr</code>ï¼‰ã€‚</li>
<li>ä½ çš„å¯¹è±¡åº”è¯¥æœ‰ <code>swap</code> æˆå‘˜å‡½æ•°ï¼Œæ”¯æŒå’Œå¦å¤–ä¸€ä¸ªå¯¹è±¡å¿«é€Ÿäº¤æ¢æˆå‘˜ã€‚</li>
<li>åœ¨ä½ çš„å¯¹è±¡çš„åç©ºé—´ä¸‹ï¼Œåº”å½“æœ‰ä¸€ä¸ªå…¨å±€çš„ <code>swap</code> å‡½æ•°ï¼Œè°ƒç”¨æˆå‘˜å‡½æ•° <code>swap</code> æ¥å®ç°äº¤æ¢ã€‚æ”¯æŒè¿™ç§ç”¨æ³•ä¼šæ–¹ä¾¿åˆ«äººï¼ˆåŒ…æ‹¬ä½ è‡ªå·±åœ¨å°†æ¥ï¼‰åœ¨å…¶ä»–å¯¹è±¡é‡ŒåŒ…å«ä½ çš„å¯¹è±¡ï¼Œå¹¶å¿«é€Ÿå®ç°å®ƒä»¬çš„ <code>swap</code> å‡½æ•°ã€‚</li>
<li>å®ç°é€šç”¨çš„ <code>operator=</code>ã€‚</li>
<li>ä¸Šé¢å„ä¸ªå‡½æ•°å¦‚æœä¸æŠ›å¼‚å¸¸çš„è¯ï¼Œåº”å½“æ ‡ä¸º <code>noexcept</code>ã€‚è¿™å¯¹ç§»åŠ¨æ„é€ å‡½æ•°å°¤ä¸ºé‡è¦ã€‚</li>
</ul><p>å…·ä½“å†™æ³•å¯ä»¥å‚è€ƒæˆ‘ä»¬å½“å‰å·²ç»å®ç°çš„ <code>smart_ptr</code>ï¼š</p><ul>
<li><code>smart_ptr</code> æœ‰æ‹·è´æ„é€ å’Œç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆè™½ç„¶æ­¤å¤„æˆ‘ä»¬çš„æ¨¡æ¿æ„é€ å‡½æ•°ä¸¥æ ¼æ¥è¯´ä¸ç®—æ‹·è´æˆ–ç§»åŠ¨æ„é€ å‡½æ•°ï¼‰ã€‚ç§»åŠ¨æ„é€ å‡½æ•°åº”å½“ä»å¦ä¸€ä¸ªå¯¹è±¡è·å–èµ„æºï¼Œæ¸…ç©ºå…¶èµ„æºï¼Œå¹¶å°†å…¶ç½®ä¸ºä¸€ä¸ªå¯ææ„çš„çŠ¶æ€ã€‚</li>
</ul><pre><code class="language-c++">smart_ptr(const smart_ptr&amp; other) noexcept
{
  ptr_ = other.ptr_;
  if (ptr_) {
    other.shared_count_
      -&gt;add_count();
    shared_count_ =
      other.shared_count_;
  }
}
template &lt;typename U&gt;
smart_ptr(const smart_ptr&lt;U&gt;&amp; other) noexcept
{
  ptr_ = other.ptr_;
  if (ptr_) {
    other.shared_count_
      -&gt;add_count();
    shared_count_ =
      other.shared_count_;
  }
}
template &lt;typename U&gt;
smart_ptr(smart_ptr&lt;U&gt;&amp;&amp; other) noexcept
{
  ptr_ = other.ptr_;
  if (ptr_) {
    shared_count_ =
      other.shared_count_;
    other.ptr_ = nullptr;
  }
}
</code></pre><ul>
<li><code>smart_ptr</code> æœ‰ <code>swap</code> æˆå‘˜å‡½æ•°ã€‚</li>
</ul><pre><code class="language-c++">void swap(smart_ptr&amp; rhs) noexcept
{
  using std::swap;
  swap(ptr_, rhs.ptr_);
  swap(shared_count_,
       rhs.shared_count_);
}
</code></pre><ul>
<li>æœ‰æ”¯æŒ <code>smart_ptr</code> çš„å…¨å±€ <code>swap</code> å‡½æ•°ã€‚</li>
</ul><pre><code class="language-c++">template &lt;typename T&gt;
void swap(smart_ptr&lt;T&gt;&amp; lhs,
          smart_ptr&lt;T&gt;&amp; rhs) noexcept
{
  lhs.swap(rhs);
}
</code></pre><ul>
<li><code>smart_ptr</code> æœ‰é€šç”¨çš„ <code>operator=</code> æˆå‘˜å‡½æ•°ã€‚æ³¨æ„ä¸ºäº†é¿å…è®©äººåƒæƒŠï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦å°†å…¶å®ç°æˆå¯¹ <code>a = a;</code> è¿™æ ·çš„å†™æ³•å®‰å…¨ã€‚ä¸‹é¢çš„å†™æ³•ç®—æ˜¯ä¸ªå°æŠ€å·§ï¼Œå¯¹ä¼ é€’å·¦å€¼å’Œå³å€¼éƒ½æœ‰æ•ˆï¼Œè€Œä¸”è§„é¿äº† <code>if (&amp;rhs != this)</code> è¿™æ ·çš„åˆ¤æ–­ã€‚</li>
</ul><pre><code class="language-c++">  smart_ptr&amp;
  operator=(smart_ptr rhs) noexcept
  {
    rhs.swap(*this);
    return *this;
  }
</code></pre><h2>ä¸è¦è¿”å›æœ¬åœ°å˜é‡çš„å¼•ç”¨</h2><p>æœ‰ä¸€ç§å¸¸è§çš„ C++ ç¼–ç¨‹é”™è¯¯ï¼Œæ˜¯åœ¨å‡½æ•°é‡Œè¿”å›ä¸€ä¸ªæœ¬åœ°å¯¹è±¡çš„å¼•ç”¨ã€‚ç”±äºåœ¨å‡½æ•°ç»“æŸæ—¶æœ¬åœ°å¯¹è±¡å³è¢«é”€æ¯ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘æœ¬åœ°å¯¹è±¡çš„å¼•ç”¨å±äºæœªå®šä¹‰è¡Œä¸ºã€‚ç†è®ºä¸Šæ¥è¯´ï¼Œç¨‹åºå‡ºä»»ä½•å¥‡æ€ªçš„è¡Œä¸ºéƒ½æ˜¯æ­£å¸¸çš„ã€‚</p><p>åœ¨ C++11 ä¹‹å‰ï¼Œè¿”å›ä¸€ä¸ªæœ¬åœ°å¯¹è±¡æ„å‘³ç€è¿™ä¸ªå¯¹è±¡ä¼šè¢«æ‹·è´ï¼Œé™¤éç¼–è¯‘å™¨å‘ç°å¯ä»¥åšè¿”å›å€¼ä¼˜åŒ–ï¼ˆnamed return value optimizationï¼Œæˆ– NRVOï¼‰ï¼Œèƒ½æŠŠå¯¹è±¡ç›´æ¥æ„é€ åˆ°è°ƒç”¨è€…çš„æ ˆä¸Šã€‚ä» C++11 å¼€å§‹ï¼Œè¿”å›å€¼ä¼˜åŒ–ä»å¯ä»¥å‘ç”Ÿï¼Œä½†åœ¨æ²¡æœ‰è¿”å›å€¼ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å°†è¯•å›¾æŠŠæœ¬åœ°å¯¹è±¡ç§»åŠ¨å‡ºå»ï¼Œè€Œä¸æ˜¯æ‹·è´å‡ºå»ã€‚è¿™ä¸€è¡Œä¸ºä¸éœ€è¦ç¨‹åºå‘˜æ‰‹å·¥ç”¨ <code>std::move</code> è¿›è¡Œå¹²é¢„â€”â€”ä½¿ç”¨<code>std::move</code> å¯¹äºç§»åŠ¨è¡Œä¸ºæ²¡æœ‰å¸®åŠ©ï¼Œåè€Œä¼šå½±å“è¿”å›å€¼ä¼˜åŒ–ã€‚</p><p>ä¸‹é¢æ˜¯ä¸ªä¾‹å­ï¼š</p><pre><code class="language-c++">#include &lt;iostream&gt;  // std::cout/endl
#include &lt;utility&gt;   // std::move

using namespace std;

class Obj {
public:
  Obj()
  {
    cout &lt;&lt; "Obj()" &lt;&lt; endl;
  }
  Obj(const Obj&amp;)
  {
    cout &lt;&lt; "Obj(const Obj&amp;)"
       &lt;&lt; endl;
  }
  Obj(Obj&amp;&amp;)
  {
    cout &lt;&lt; "Obj(Obj&amp;&amp;)" &lt;&lt; endl;
  }
};

Obj simple()
{
  Obj obj;
  // ç®€å•è¿”å›å¯¹è±¡ï¼›ä¸€èˆ¬æœ‰ NRVO
  return obj;
}

Obj simple_with_move()
{
  Obj obj;
  // move ä¼šç¦æ­¢ NRVO
  return std::move(obj);
}

Obj complicated(int n)
{
  Obj obj1;
  Obj obj2;
  // æœ‰åˆ†æ”¯ï¼Œä¸€èˆ¬æ—  NRVO
  if (n % 2 == 0) {
    return obj1;
  } else {
    return obj2;
  }
}

int main()
{
  cout &lt;&lt; "*** 1 ***" &lt;&lt; endl;
  auto obj1 = simple();
  cout &lt;&lt; "*** 2 ***" &lt;&lt; endl;
  auto obj2 = simple_with_move();
  cout &lt;&lt; "*** 3 ***" &lt;&lt; endl;
  auto obj3 = complicated(42);
}
</code></pre><p>è¾“å‡ºé€šå¸¸ä¸ºï¼š</p><blockquote>
<p><code>*** 1 ***</code><br>
<code>Obj()</code><br>
<code>*** 2 ***</code><br>
<code>Obj()</code><br>
<code>Obj(Obj&amp;&amp;)</code><br>
<code>*** 3 ***</code><br>
<code>Obj()</code><br>
<code>Obj()</code><br>
<code>Obj(Obj&amp;&amp;)</code></p>
</blockquote><p>ä¹Ÿå°±æ˜¯ï¼Œç”¨äº† <code>std::move</code> åè€Œå¦¨ç¢äº†è¿”å›å€¼ä¼˜åŒ–ã€‚</p><h2>å¼•ç”¨åç¼©å’Œå®Œç¾è½¬å‘</h2><p>æœ€åè®²ä¸€ä¸ªç•¥å¤æ‚ã€ä½†åˆä¸å¾—ä¸è®²çš„è¯é¢˜ï¼Œå¼•ç”¨åç¼©ï¼ˆåˆç§°â€œå¼•ç”¨æŠ˜å â€ï¼‰ã€‚è¿™ä¸ªæ¦‚å¿µåœ¨æ³›å‹ç¼–ç¨‹ä¸­æ˜¯ä¸€å®šä¼šç¢°åˆ°çš„ã€‚æˆ‘ä»¬ä»Šå¤©æ—¢ç„¶è®²äº†å·¦å€¼å’Œå³å€¼å¼•ç”¨ï¼Œä¹Ÿéœ€è¦ä¸€èµ·è®²ä¸€ä¸‹ã€‚</p><p>æˆ‘ä»¬å·²ç»è®²äº†å¯¹äºä¸€ä¸ªå®é™…çš„ç±»å‹ <code>T</code>ï¼Œå®ƒçš„å·¦å€¼å¼•ç”¨æ˜¯ <code>T&amp;</code>ï¼Œå³å€¼å¼•ç”¨æ˜¯ <code>T&amp;&amp;</code>ã€‚é‚£ä¹ˆï¼š</p><ol>
<li>æ˜¯ä¸æ˜¯çœ‹åˆ° <code>T&amp;</code>ï¼Œå°±ä¸€å®šæ˜¯ä¸ªå·¦å€¼å¼•ç”¨ï¼Ÿ</li>
<li>æ˜¯ä¸æ˜¯çœ‹åˆ° <code>T&amp;&amp;</code>ï¼Œå°±ä¸€å®šæ˜¯ä¸ªå³å€¼å¼•ç”¨ï¼Ÿ</li>
</ol><p>å¯¹äºå‰è€…çš„å›ç­”æ˜¯â€œæ˜¯â€ï¼Œå¯¹äºåè€…çš„å›ç­”ä¸ºâ€œå¦â€ã€‚</p><p>å…³é”®åœ¨äºï¼Œåœ¨æœ‰æ¨¡æ¿çš„ä»£ç é‡Œï¼Œå¯¹äºç±»å‹å‚æ•°çš„æ¨å¯¼ç»“æœå¯èƒ½æ˜¯å¼•ç”¨ã€‚æˆ‘ä»¬å¯ä»¥ç•¥è¿‡ä¸€äº›ç¹å¤çš„è¯­æ³•è§„åˆ™ï¼Œè¦ç‚¹æ˜¯ï¼š</p><ul>
<li>å¯¹äº <code>template &lt;typename T&gt; foo(T&amp;&amp;)</code> è¿™æ ·çš„ä»£ç ï¼Œå¦‚æœä¼ é€’è¿‡å»çš„å‚æ•°æ˜¯å·¦å€¼ï¼Œ<code>T</code> çš„æ¨å¯¼ç»“æœæ˜¯å·¦å€¼å¼•ç”¨ï¼›å¦‚æœä¼ é€’è¿‡å»çš„å‚æ•°æ˜¯å³å€¼ï¼Œ<code>T</code> çš„æ¨å¯¼ç»“æœæ˜¯å‚æ•°çš„ç±»å‹æœ¬èº«ã€‚</li>
<li>å¦‚æœ <code>T</code> æ˜¯å·¦å€¼å¼•ç”¨ï¼Œé‚£ <code>T&amp;&amp;</code> çš„ç»“æœä»ç„¶æ˜¯å·¦å€¼å¼•ç”¨â€”â€”å³ <code>type&amp; &amp;&amp;</code> åç¼©æˆäº† <code>type&amp;</code>ã€‚</li>
<li>å¦‚æœ <code>T</code> æ˜¯ä¸€ä¸ªå®é™…ç±»å‹ï¼Œé‚£ <code>T&amp;&amp;</code> çš„ç»“æœè‡ªç„¶å°±æ˜¯ä¸€ä¸ªå³å€¼å¼•ç”¨ã€‚</li>
</ul><p>æˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡ï¼Œå³å€¼å¼•ç”¨å˜é‡ä»ç„¶ä¼šåŒ¹é…åˆ°å·¦å€¼å¼•ç”¨ä¸Šå»ã€‚ä¸‹é¢çš„ä»£ç ä¼šéªŒè¯è¿™ä¸€è¡Œä¸ºï¼š</p><pre><code class="language-c++">void foo(const shape&amp;)
{
  puts("foo(const shape&amp;)");
}

void foo(shape&amp;&amp;)
{
  puts("foo(shape&amp;&amp;)");
}

void bar(const shape&amp; s)
{
  puts("bar(const shape&amp;)");
  foo(s);
}

void bar(shape&amp;&amp; s)
{
  puts("bar(shape&amp;&amp;)");
  foo(s);
}

int main()
{
  bar(circle());
}
</code></pre><p>è¾“å‡ºä¸ºï¼š</p><blockquote>
<p><code>bar(shape&amp;&amp;)</code><br>
<code>foo(const shape&amp;)</code></p>
</blockquote><p>å¦‚æœæˆ‘ä»¬è¦è®© <code>bar</code> è°ƒç”¨å³å€¼å¼•ç”¨çš„é‚£ä¸ª foo çš„é‡è½½ï¼Œæˆ‘ä»¬å¿…é¡»å†™æˆï¼š</p><pre><code class="language-c++">foo(std::move(s));
</code></pre><p>æˆ–ï¼š</p><pre><code class="language-c++">foo(static_cast&lt;shape&amp;&amp;&gt;(s));
</code></pre><p>å¯å¦‚æœä¸¤ä¸ª <code>bar</code> çš„é‡è½½é™¤äº†è°ƒç”¨ <code>foo</code> çš„æ–¹å¼ä¸ä¸€æ ·ï¼Œå…¶ä»–éƒ½å·®ä¸å¤šçš„è¯ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æä¾›ä¸¤ä¸ªä¸åŒçš„ <code>bar</code> å‘¢ï¼Ÿ</p><p>äº‹å®ä¸Šï¼Œå¾ˆå¤šæ ‡å‡†åº“é‡Œçš„å‡½æ•°ï¼Œè¿ç›®æ ‡çš„å‚æ•°ç±»å‹éƒ½ä¸çŸ¥é“ï¼Œä½†æˆ‘ä»¬ä»ç„¶éœ€è¦èƒ½å¤Ÿä¿æŒå‚æ•°çš„å€¼ç±»åˆ«ï¼šå·¦å€¼çš„ä»ç„¶æ˜¯å·¦å€¼ï¼Œå³å€¼çš„ä»ç„¶æ˜¯å³å€¼ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨ C++ æ ‡å‡†åº“ä¸­å·²ç»æä¾›äº†ï¼Œå« <code>std::forward</code>ã€‚å®ƒå’Œ <code>std::move</code> ä¸€æ ·éƒ½æ˜¯åˆ©ç”¨å¼•ç”¨åç¼©æœºåˆ¶æ¥å®ç°ã€‚æ­¤å¤„ï¼Œæˆ‘ä»¬ä¸ä»‹ç»å…¶å®ç°ç»†èŠ‚ï¼Œè€Œæ˜¯é‡ç‚¹å±•ç¤ºå…¶ç”¨æ³•ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬çš„ä¸¤ä¸ª <code>bar</code> å‡½æ•°ç®€åŒ–æˆï¼š</p><pre><code class="language-c++">template &lt;typename T&gt;
void bar(T&amp;&amp; s)
{
  foo(std::forward&lt;T&gt;(s));
}
</code></pre><p>å¯¹äºä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š</p><pre><code class="language-c++">circle temp;
bar(temp);
bar(circle());
</code></pre><p>ç°åœ¨çš„è¾“å‡ºæ˜¯ï¼š</p><blockquote>
<p><code>foo(const shape&amp;)</code><br>
<code>foo(shape&amp;&amp;)</code></p>
</blockquote><p>ä¸€åˆ‡å¦‚é¢„æœŸä¸€æ ·ã€‚</p><p>å› ä¸ºåœ¨ <code>T</code> æ˜¯æ¨¡æ¿å‚æ•°æ—¶ï¼Œ<code>T&amp;&amp;</code> çš„ä½œç”¨ä¸»è¦æ˜¯ä¿æŒå€¼ç±»åˆ«è¿›è¡Œè½¬å‘ï¼Œå®ƒæœ‰ä¸ªåå­—å°±å«â€œè½¬å‘å¼•ç”¨â€ï¼ˆforwarding referenceï¼‰ã€‚å› ä¸ºæ—¢å¯ä»¥æ˜¯å·¦å€¼å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯å³å€¼å¼•ç”¨ï¼Œå®ƒä¹Ÿæ›¾ç»è¢«å«åšâ€œä¸‡èƒ½å¼•ç”¨â€ï¼ˆuniversal referenceï¼‰ã€‚</p><h2>å†…å®¹å°ç»“</h2><p>æœ¬è®²ä»‹ç»äº† C++ é‡Œçš„å€¼ç±»åˆ«ï¼Œé‡ç‚¹ä»‹ç»äº†ä¸´æ—¶å˜é‡ã€å³å€¼å¼•ç”¨ã€ç§»åŠ¨è¯­ä¹‰å’Œå®é™…çš„ç¼–ç¨‹ç”¨æ³•ã€‚ç”±äºè¿™æ˜¯ C++11 é‡Œçš„é‡ç‚¹åŠŸèƒ½ï¼Œä½ å¯¹äºå…¶åŸºæœ¬ç”¨æ³•éœ€è¦ç‰¢ç‰¢æŒæ¡ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>ç•™ç»™ä½ ä¸¤é“æ€è€ƒé¢˜ï¼š</p><ol>
<li>è¯·æŸ¥çœ‹ä¸€ä¸‹æ ‡å‡†å‡½æ•°æ¨¡æ¿ <code>make_shared</code> çš„å£°æ˜ï¼Œç„¶åæƒ³ä¸€æƒ³ï¼Œè¿™ä¸ªå‡½æ•°åº”è¯¥æ˜¯æ€æ ·å®ç°çš„ã€‚</li>
<li>ä¸ºä»€ä¹ˆ <code>smart_ptr::operator=</code> å¯¹å·¦å€¼å’Œå³å€¼éƒ½æœ‰æ•ˆï¼Œè€Œä¸”ä¸éœ€è¦å¯¹ç­‰å·ä¸¤è¾¹æ˜¯å¦å¼•ç”¨åŒä¸€å¯¹è±¡è¿›è¡Œåˆ¤æ–­ï¼Ÿ</li>
</ol><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘äº¤æµä½ çš„çœ‹æ³•ï¼Œå°¤å…¶æ˜¯å¯¹ç¬¬äºŒä¸ªé—®é¢˜ã€‚</p><h2>å‚è€ƒèµ„æ–™</h2><p>[1] cppreference.com, â€œValue categoriesâ€. <a href="https://en.cppreference.com/w/cpp/language/value_category">https://en.cppreference.com/w/cpp/language/value_category</a></p><p>[1a] cppreference.com, â€œå€¼ç±»åˆ«â€. <a href="https://zh.cppreference.com/w/cpp/language/value_category">https://zh.cppreference.com/w/cpp/language/value_category</a></p><p>[2] Anders Schau Knatten, â€œlvalues, rvalues, glvalues, prvalues, xvalues, help!â€. <a href="https://blog.knatten.org/2018/03/09/lvalues-rvalues-glvalues-prvalues-xvalues-help/">https://blog.knatten.org/2018/03/09/lvalues-rvalues-glvalues-prvalues-xvalues-help/</a></p><p>[3] Jeaye, â€œValue category cheat-sheetâ€. <a href="https://blog.jeaye.com/2017/03/19/xvalues/">https://blog.jeaye.com/2017/03/19/xvalues/</a></p><p>[4] Thomas Becker, â€œC++ rvalue references explainedâ€. <a href="http://thbecker.net/articles/rvalue_references/section_01.html">http://thbecker.net/articles/rvalue_references/section_01.html</a></p><p>[5] Herb Sutter, â€œGotW #88: A candidate for the â€˜most important constâ€™â€. <a href="https://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/">https://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/</a></p><h2>ç²¾é€‰ç•™è¨€ï¼š</h2>
        <ul>
        
<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            NEVER SETTLE  2019-12-02 19:51:26
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è¯·æ•™ä¸‹è€å¸ˆï¼Œå­—ç¬¦ä¸²å­—é¢é‡æ˜¯å·¦å€¼ï¼Œæ˜¯ä¸æ˜¯åœ¨C++ä¸­ å­—ç¬¦ä¸²å…¶å®æ˜¯const char[N]ï¼Œå…¶å®æ˜¯ä¸ªå¸¸é‡è¡¨è¾¾å¼ï¼Œåœ¨å†…å­˜ä¸­æœ‰æ˜ç¡®çš„åœ°å€ã€‚ [4èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2019-12-02 20:21:08</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">æ˜¯ã€‚ğŸ‘</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ç³–  2019-12-02 11:28:10
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            åˆæ˜¯çœ‹ä¸æ‡‚çš„ä¸€èŠ‚ã€‚ã€‚ã€‚è€å¸ˆè®²çš„è¯¾ç¨‹å¤ªæ·±åˆ»äº†ã€‚ã€‚ã€‚<br>1. æœ¬æ¥æ„Ÿè§‰è‡ªå·±è¿˜æ¯”è¾ƒäº†è§£å·¦å³å€¼çš„åŒºåˆ«ï¼Œä½†æ˜¯ï¼Œæ–‡ä¸­æåˆ°ï¼šä¸€ä¸ª lvalue æ˜¯é€šå¸¸å¯ä»¥æ”¾åœ¨ç­‰å·å·¦è¾¹çš„è¡¨è¾¾å¼ï¼Œå·¦å€¼ï¼Œç„¶åä¸‹é¢è¯´ï¼šå­—ç¬¦ä¸²å­—é¢é‡å¦‚ &quot;hello world&quot;ï¼Œä½†å­—ç¬¦ä¸²å­—é¢é‡è²Œä¼¼ä¸å¯ä»¥æ”¾åˆ°ç­‰å·å·¦è¾¹ï¼Œææ™•äº†ã€‚<br>2. å†…å­˜è®¿é—®çš„å±€åŸŸæ€§æ˜¯æŒ‡ä»€ä¹ˆå‘¢ï¼Ÿåˆæœ‰ä½•ä¼˜åŠ¿å‘¢ï¼Ÿè€å¸ˆèƒ½æä¾›ä»‹ç»çš„é“¾æ¥å—<br>3. ä¸ºä½•å¯¹äºç§»åŠ¨æ„é€ å‡½æ•°æ¥è®²ä¸æŠ›å‡ºå¼‚å¸¸å°¤å…¶é‡è¦å‘¢ï¼Ÿ<br>å¸Œæœ›è€å¸ˆèƒ½æŒ‡ç‚¹ä¸€ä¸‹ [4èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2019-12-02 20:18:33</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">1. â€œé€šå¸¸â€ã€‚å­—ç¬¦ä¸²å­—é¢é‡æ˜¯ä¸ªç»§æ‰¿è‡ªCçš„ç‰¹æ®Šæƒ…å†µã€‚<br><br>2. è¿™ä¸ªæœç´¢ä¸€ä¸‹å°±è¡Œã€‚è¿™æ˜¯CPUçš„ç¼“å­˜ç»“æ„å†³å®šçš„ã€‚<br><br>3. å…¶ä»–ç±»ï¼Œå°¤å…¶å®¹å™¨ç±»ï¼Œä¼šæœŸå¾…ç§»åŠ¨æ„é€ å‡½æ•°æ— å¼‚å¸¸ï¼Œç”šè‡³ä¼šåœ¨å®ƒæœ‰å¼‚å¸¸æ—¶é€‰æ‹©æ‹·è´æ„é€ å‡½æ•°ï¼Œä»¥ä¿è¯å¼ºå¼‚å¸¸å®‰å…¨æ€§ã€‚</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            hello world  2019-12-02 13:40:44
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            ä¸€ç›´æœ‰ä¸ªé—®é¢˜æƒ³é—®è€å¸ˆï¼Œè€å¸ˆç¬¬ä¸€èŠ‚ä¹Ÿè¯´äº†ä¸€äº›ï¼Œä½†æˆ‘è¿˜æ˜¯æœ‰ä¸€äº›ç–‘æƒ‘å’Œç„¦è™‘å¸Œæœ›è€å¸ˆèƒ½å¤Ÿè§£æƒ‘ã€‚<br>ç°åœ¨C++çš„åº”ç”¨èŒƒå›´è²Œä¼¼è¶Šæ¥è¶Šçª„ï¼Œä»¥å‰å¯èƒ½å¾ˆå¤šåå°ä¼šç”¨åˆ°ï¼Œä½†æ˜¯ç°åœ¨è²Œä¼¼åå°éƒ½æ˜¯goå’Œjavaå¤šä¸€äº›ï¼ŒçœŸæ­£è¿½æ±‚æ€§èƒ½æè‡´çš„è²Œä¼¼ä¸å¤šï¼Œç°åœ¨ä¹Ÿå°±ä¸€äº›äººå·¥æ™ºèƒ½æ–¹é¢å’ŒåµŒå…¥å¼æ–¹é¢ä¼šç”¨åˆ°ï¼Œä½†ä¹Ÿæ˜¯å°‘æ•°ï¼ŒçœŸæ­£è¦åšä¸€ä¸ªæ·±åº¦å­¦ä¹ æ¡†æ¶çš„ä¹Ÿä¸å¤ªå¤šï¼Œå³ä¾¿æ˜¯å¤§ä¼ä¸šä¹Ÿæ˜¯ä¸ªåˆ«å‡ ä¸ªéƒ¨é—¨ï¼Œä½œä¸ºä¸€ä¸ªC++ç¨‹åºå‘˜æ¯”è¾ƒè¿·èŒ«ï¼Œæ„Ÿè§‰è¿™æ¡è·¯æ¯”è¾ƒçª„ï¼Œæœªæ¥çš„è·¯æ€ä¹ˆèµ°å‘¢ï¼Ÿ [2èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2019-12-02 21:29:48</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">æŠŠC++å½“ä½œä¸€ç§å·¥å…·ï¼Œä¹Ÿå½“ä½œä¸€ç§é”»ç‚¼æ€ç»´çš„æ–¹å¼ï¼Œä¸è¦æŠŠå®ƒå½“æˆéç”¨ä¸å¯çš„åœ£å™¨ã€‚æŠŠè‡ªå·±å®šä½æˆâ€œç¨‹åºå‘˜â€ï¼Œè€Œä¸æ˜¯â€œC++ç¨‹åºå‘˜â€ã€‚èŒä¸šçš„å°†æ¥æ–¹å‘å®šä½æˆâ€œè½¯ä»¶æ¶æ„å¸ˆâ€ã€â€œå¼€å‘ä¸»ç®¡â€ã€â€œCTOâ€ä¹‹ç±»çš„è§’è‰²ï¼Œè€Œä¸æ˜¯â€œé«˜çº§C++ç¨‹åºå‘˜â€ã€‚<br><br>è¯¥ç”¨å…¶ä»–è¯­è¨€çš„æ—¶å€™ç”¨å…¶ä»–è¯­è¨€ã€‚è¦çœ‹åˆ°ï¼Œå³ä½¿ä¸ç”¨C++ï¼ŒC++ç¨‹åºå‘˜åœ¨å¯¹ä¼˜åŒ–çš„ç†è§£ã€å¯¹å†…å­˜ç®¡ç†çš„ç†è§£ç­‰æ–¹é¢éƒ½æ˜¯å…·æœ‰å¾ˆå¤§ä¼˜åŠ¿çš„ã€‚</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            NEVER SETTLE  2019-12-02 20:41:45
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            â€œè¿”å›å·¦å€¼å¼•ç”¨çš„è¡¨è¾¾å¼ï¼Œï¼Œå¦‚ x++ã€x + 1 â€ä¸å¤ªæ¸…æ¥šåŸå› ï¼Œåæ¥æˆ‘å°±è¯•äº†ä¸‹ï¼š<br><br>```<br>int x = 0;<br>cout &lt;&lt; &quot;(x).addr = &quot; &lt;&lt; &amp;x &lt;&lt; endl;<br>cout &lt;&lt; &quot;(x = 1).addr = &quot; &lt;&lt; &amp;(x = 1) &lt;&lt; endl;<br>cout &lt;&lt; &quot;(++x).addr = &quot; &lt;&lt; &amp;++x &lt;&lt; endl;<br>&#47;&#47;cout &lt;&lt; &quot;(x++).addr = &quot; &lt;&lt; &amp;x++ &lt;&lt; endl;<br>```<br><br>&gt; è¿è¡Œç»“æœï¼š  <br>(x).addr = 0x22fe4c  <br>(x = 1).addr = 0x22fe4c  <br>(++x).addr = 0x22fe4c  <br>æœ€åä¸€è¡Œæ³¨é‡Šæ‰çš„ä»£ç æŠ¥é”™ï¼šè¡¨è¾¾å¼å¿…é¡»ä¸ºå·¦å€¼æˆ–å‡½æ•°æŒ‡ç¤ºç¬¦ [1èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2019-12-02 21:52:45</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">å¯¹ï¼Œx = 1 å’Œ ++x è¿”å›çš„éƒ½æ˜¯å¯¹ x çš„ int&amp;ã€‚x++ åˆ™è¿”å›çš„æ˜¯ intã€‚</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ç½—ä¹¾æ—  2019-12-02 11:07:23
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            å¹³æ—¶Javaæ˜¯ä¸»è¦ä½¿ç”¨è¯­è¨€ï¼Œä¹Ÿæ¥å›ç­”ä¸€ä¸‹<br>1ã€make_shared åˆ›å»º(new)æ–°å¯¹è±¡æ ¹æ®ä¼ å…¥çš„å€¼ç±»åˆ«è°ƒç”¨æ‹·è´æ„é€ æˆ–ç§»åŠ¨æ„é€ ,ç„¶åå°†æ–°å¯¹è±¡çš„æŒ‡é’ˆç»™shared_ptrï¼Œå…¶ä¸­æˆ‘çœ‹è§äº†_Types&amp;&amp;å’Œforward<br>2ã€smart_ptr::operator= ä¸­å‚æ•°ä¸ºå€¼ä¼ é€’ï¼Œä¼šå…ˆè°ƒç”¨smart_ptrçš„æ‹·è´æ„é€ å‡½æ•°ï¼Œç”Ÿæˆäº†ä¸´æ—¶å¯¹è±¡ï¼Œç„¶åè°ƒç”¨swapï¼Œ<br>å› ä¸ºç”Ÿæˆäº†æ–°å¯¹è±¡æ‰€ä»¥å¯¹ç­‰å·ä¸¤è¾¹æ˜¯å¦å¼•ç”¨åŒä¸€å¯¹è±¡è¿›è¡Œåˆ¤æ–­ï¼Œä¹Ÿæ²¡æ„ä¹‰äº†ï¼Œä½†æ˜¯a=aä¹Ÿä¼šæœ‰ä¸´æ—¶å¯¹è±¡çš„äº§ç”Ÿï¼Œæœ‰æ€§èƒ½å¼€é”€<br><br>æœ‰é”™è¯¯çš„æ–¹ï¼Œæœ›è€å¸ˆæŒ‡æ­£ [1èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2019-12-02 20:08:08</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">2å®Œå…¨æ­£ç¡®ã€‚1å†æƒ³æƒ³ã€‚ğŸ¤“</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ç¦¾æ¡ƒ  2019-12-03 11:45:27
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            &quot;è¯·æŸ¥çœ‹ä¸€ä¸‹æ ‡å‡†å‡½æ•°æ¨¡æ¿ make_shared çš„å£°æ˜ï¼Œç„¶åæƒ³ä¸€æƒ³ï¼Œè¿™ä¸ªå‡½æ•°åº”è¯¥æ˜¯æ€æ ·å®ç°çš„ã€‚&quot;<br><br>template &lt;class T, class... Args&gt;<br>std::shared_ptr&lt;T&gt; make_shared (Args&amp;&amp;... args)<br>{<br>    T* ptr = new T(std::forward&lt;Args...&gt;(args...));<br>    return std::shared_ptr&lt;T&gt;(ptr);<br>}<br><br>æˆ‘çš„è€ƒè™‘æ˜¯ï¼š<br>make_sharedå£°æ˜é‡Œçš„ï¼ˆArgs&amp;&amp;...ï¼‰ æ˜¯universal referenceï¼Œ æ‰€ä»¥åœ¨å‡½æ•°ä½“é‡Œç”¨å®Œç¾è½¬å‘ï¼ˆstd::forwardï¼‰æŠŠå‚æ•°å‡ºå…¥Tçš„æ„é€ å‡½æ•°, ä»¥è°ƒç”¨æ¯ä¸ªå‚æ•°å„è‡ªå¯¹ç”¨çš„æ„é€ å‡½æ•°ï¼ˆcopy or moveï¼‰ã€‚<br><br>è‚¯å®šè¿˜æœ‰åˆ«çš„éœ€è¦è€ƒé‡çš„åœ°æ–¹ï¼Œè¯·æŒ‡æ­£ã€‚<br><br>è°¢è°¢ï¼ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            Alice  2019-12-03 11:28:01
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è€å¸ˆæ‚¨å¥½ è¯·é—®åé¢çš„å­¦ä¹ å†…å®¹ä¼šä¸ä¼šæ¶‰åŠåˆ°é‡è½½å‡½æ•°å’Œé‡è½½è¿ç®—ç¬¦å‘¢ï¼Ÿæ„Ÿè§‰è¿™ä¸¤å—ä¸æ˜¯å¾ˆå¥½ç†è§£å‘€ï¼ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ä¼ è¯´ä¸­çš„æˆå¤§å¤§  2019-12-03 11:05:30
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            åˆšåˆšçœ‹äº†hello worldåŒå­¦çš„æ‹…å¿§å’Œè€ƒè™‘ ç„¶åå†çœ‹è€å¸ˆçš„å›ç­” æˆ‘ä¹Ÿæƒ³èµ·äº†æˆ‘è‡ªå·±çš„ç›®æ ‡æ˜¯é€šè¿‡åŠªåŠ›å­¦ä¹ æ€ä¹ˆå†™ä»£ç  æœ€ååšåˆ°ä¸å†™ä»£ç çš„ç›®æ ‡<br>c++ç¡®å®å­¦ä¹ æˆæœ¬å¤ªé«˜ ä¹Ÿæ¯”è¾ƒå¤æ‚ ä½†æ˜¯æˆ‘è®°å¾—å½“æ—¶çœ‹äº†ä¸ªè§†é¢‘,æœ€åè¯¾ç¨‹ç»“æŸçš„æ—¶å€™ä¹Ÿæ¨èå­¦ä¹ ä¸€ä¸‹c++å¯¹äºåº•å±‚çš„ç†è§£ä¼šå¾ˆæœ‰å¸®åŠ©, è™½ç„¶ç°åœ¨goè¯­è¨€æˆ–è€…æ˜¯luaè¯­è¨€ å­¦ä¹ æˆæœ¬å¾ˆä½ ä¸€ä¸¤å¤©å°±å¯ä»¥å†™ä»£ç äº†,é‚£éƒ½æ˜¯åˆ«äººè¯­è¨€å±‚é¢å·²ç»å¤„ç†å¥½äº†çš„,å°†åº•å±‚ä¸æˆ‘ä»¬éš”ç»äº†<br>æ‰€ä»¥æˆ‘åŠªåŠ›å­¦c++ æ›´å¥½çš„ç†è§£åº•å±‚ ä¹Ÿåœ¨å­¦goè¿™æ ·æ‰æœ‰æ›´å¤šçš„å·¥ä½œæœºä¼š  
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            å®‰é™çš„é›¨  2019-12-03 10:13:48
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            Obj simple_with_move()<br>{ <br>    Obj obj;  <br>    &#47;&#47; move  ä¼šç¦æ­¢  NRVO  <br>    return std::move(obj);<br>}<br><br>moveåä¸æ˜¯ç±»å‹è½¬æ¢åˆ°å³å€¼å¼•ç”¨äº†å—ï¼Ÿ ä¸ºå•¥è¿”å›å€¼ç±»å‹è¿˜æ˜¯objï¼Ÿ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ç¦¾æ¡ƒ  2019-12-03 08:25:45
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            å¼•ç”¨ï¼ˆå·¦å€¼æˆ–è€…å³å€¼ï¼‰ä»…ä»…æ˜¯æä¾›ç»™compilerçš„ä¸€ä¸ªç”Ÿæˆé€‚å½“æœºå™¨ä»£ç çš„â€œæç¤ºç¬¦å·â€ï¼Œåœ¨å†…å­˜å’Œä»£ç çš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸ä¼šæœ‰ä»»ä½•çš„å°è®°ï¼Œå¯¹å—ï¼Ÿ<br><br>åŒºåˆ†å·¦å€¼å¼•ç”¨ï¼Œå³å€¼å¼•ç”¨ï¼Œé™¤äº†ç”¨åœ¨é€‰æ‹©é‡è½½å‡½æ•°ä¸Šï¼Œè¿˜æœ‰ç”¨åœ¨åˆ«çš„åœ°æ–¹å—ï¼Ÿ<br><br>è°¢è°¢ï¼ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2019-12-03 09:40:23</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">ä¸å®Œå…¨å¯¹ã€‚å†…å­˜é‡Œæ€»å¾—æ”¾ä¸ªæŒ‡é’ˆçš„ã€‚<br><br>åŒºåˆ†å€¼ç±»åˆ«ç¡®å®æ˜¯ä¸ºäº†é‡è½½ã€‚æˆ‘ç›®å‰æ²¡æƒ³åˆ°å…¶ä»–ä½œç”¨ã€‚</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ç¦¾æ¡ƒ  2019-12-02 18:31:31
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è¯·å¸®å¿™æŒ‡æ­£ä¸€ä¸‹ï¼š<br><br>â€œä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›çš„æ˜¯å·¦å€¼å¼•ç”¨ï¼Œè¿™ä¸ªè¡¨è¾¾å¼çš„value category æ˜¯å·¦å€¼ã€‚â€<br><br>ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›çš„æ˜¯å³å€¼å¼•ç”¨ï¼ˆè­¬å¦‚ï¼Œstd::move(ptr1) çš„ç»“æœæ˜¯æŒ‡å‘ ptr1 çš„ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼‰ï¼Œè¿™ä¸ªè¡¨è¾¾å¼çš„value category æ˜¯å°†äº¡å€¼ã€‚ &lt;â€”-å¯¹å—ï¼Ÿ<br><br>å¼•ç”¨ç±»åˆ«<br>#1éå¸¸å·¦å€¼å¼•ç”¨<br>#2å¸¸å·¦å€¼å¼•ç”¨ <br>#3éå¸¸å³å€¼å¼•ç”¨ <br>#4å¸¸å³å€¼å¼•ç”¨ï¼ˆä¸çŸ¥é“æ˜¯å¦å­˜åœ¨ï¼‰<br><br>lvalue, xvalue, prvalue,<br>åˆ†åˆ«å¯ä»¥ç»‘å®šä»¥ä¸Šå››ç§å“ªå‡ ä¸ªï¼Ÿï¼ˆä¸çŸ¥é“è¿™ç§åˆ†æ³•æ˜¯å¦åˆç†ï¼‰<br><br>éå¸¸æ„Ÿè°¢ï¼ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2019-12-02 21:50:33</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">â€œä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›çš„æ˜¯å³å€¼å¼•ç”¨ï¼ˆè­¬å¦‚ï¼Œstd::move(ptr1) çš„ç»“æœæ˜¯æŒ‡å‘ ptr1 çš„ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼‰ï¼Œè¿™ä¸ªè¡¨è¾¾å¼çš„value category æ˜¯å°†äº¡å€¼ã€‚â€ æ­£ç¡®ã€‚<br><br>å¼•ç”¨ç±»å‹çš„ç»‘å®šï¼š<br><br>#1éå¸¸å·¦å€¼å¼•ç”¨å¯ä»¥ç»‘å®šéconst lvalue<br>#2å¸¸å·¦å€¼å¼•ç”¨å¯ä»¥ç»‘å®šlvalue, xvalue, prvalue<br>#3éå¸¸å³å€¼å¼•ç”¨å¯ä»¥ç»‘å®šéconst xvalue, prvalue<br>#4å¸¸å³å€¼å¼•ç”¨ï¼ˆä¸çŸ¥é“æ˜¯å¦å­˜åœ¨ï¼‰å¯ä»¥ç»‘å®šxvalue, prvalue ï¼ˆåˆæ³•ï¼Œä½†æˆ‘ä»æ¥æ²¡è§‰å¾—æœ‰å¿…è¦ç”¨è¿™ç§ç±»å‹è¿‡ï¼‰</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            åµ‡æ–Œ  2019-12-02 14:43:58
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            std::moveå’Œå³å€¼å¼•ç”¨æ˜¯å½“æ—¶åˆå­¦C++11æ¯”è¾ƒéš¾ç†è§£çš„ä¸€ä¸ªä¸œè¥¿ã€‚è¿™ç¯‡èƒ½ç»“åˆrvoå’Œstd::moveä¸€èµ·è®²è§£ï¼Œç›¸ä¿¡å¯¹å¤§å®¶æ¥è®²ä¹Ÿæ˜¯æ”¶ç›ŠåŒªæµ…çš„ã€‚è®°å¾—ä»¥å‰å°±å¯¹å°å¯¹è±¡ï¼Œä»¥åŠå·¥å‚æ–¹æ³•è¿”å›çš„æ—¶å€™ç©¶ç«Ÿè¯¥ç”¨std::moveè¿˜æ˜¯ç›´æ¥è¿”å›æœ‰è¿‡ä¸€å°æ®µçš„è®¨è®ºã€‚<br><br>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘å¾ˆæ— è€»åœ°å»çœ‹äº†æ ‡å‡†åº“çš„å®ç°äº†â€¦â€¦<br>å…³äºç¬¬äºŒä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆ smart_ptr::operator= å¯¹å·¦å€¼å’Œå³å€¼éƒ½æœ‰æ•ˆï¼Œè€Œä¸”ä¸éœ€è¦å¯¹ç­‰å·ä¸¤è¾¹æ˜¯å¦å¼•ç”¨åŒä¸€å¯¹è±¡è¿›è¡Œåˆ¤æ–­ï¼Ÿ<br>ä¸ªäººç†è§£æ— è®ºå·¦å€¼å’Œå³å€¼åœ¨ä½¿ç”¨ operator=(smart_prt rhs)ä¹‹å‰éƒ½åšäº†éšå¼çš„è½¬æ¢ï¼Œè°ƒç”¨äº†Copy Constructor æˆ–åˆ™ Move Constructor å¾—åˆ°äº†ä¸€ä¸ªä¸´æ—¶çš„ smart_prt rhsï¼ˆå€¼ç±»å‹ï¼‰ï¼Œè‡³äºæ˜¯å¦åŒä¸€å¯¹è±¡çš„åˆ¤æ–­å¹¶æ²¡æœ‰å…³ç³»ï¼Œå¯¹äºsmart_ptræ¥è¯´å·²ç»æ˜¯ä¸€ä¸ªæ–°çš„äº†ï¼Œè€Œå¯¹äºå†…éƒ¨ä¿å­˜çš„çœŸå®å¯¹è±¡ï¼Œswapçš„å®ç°ä¿è¯äº†è¿™åªä¼šæ˜¯ä¸€æ¬¡æµ…æ‹·è´çš„å®ç°ï¼Œä¸ä¼šæœ‰å¤ªå¤šçš„é¢å¤–å¼€é”€ã€‚æ ‡å‡†åº“å®ç°åº”è¯¥é’ˆå¯¹&amp;å’Œ&amp;&amp;åˆ†åˆ«é‡è½½äº†operator= 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;        line-height:1.2">ä½œè€…å›å¤2019-12-02 20:40:44</div>
    <div style="color:#353535;font-weight:400;white-space:normal;        word-break:break-all;line-height:1.6">ç¬¬äºŒä¸ªé—®é¢˜çš„å›ç­”åŸºæœ¬æ­£ç¡®ã€‚ä¸è¿‡å€¼ç±»å‹åº”å½“æ˜¯å€¼ç±»åˆ«ã€‚</div>
</div>
            
    </div>
</li>
            </ul>
</div>
</body>
</html>